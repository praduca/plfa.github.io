<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Substitution in the untyped lambda calculus | Programming Language Foundations in Agda
</title><!-- Begin Jekyll SEO tag v2.5.0 -->
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Substitution in the untyped lambda calculus" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Programming Language Foundations in Agda" />
<meta property="og:description" content="Programming Language Foundations in Agda" />
<link rel="canonical" href="https://plfa.github.io/Substitution/" />
<meta property="og:url" content="https://plfa.github.io/Substitution/" />
<meta property="og:site_name" content="Programming Language Foundations in Agda" />
<script type="application/ld+json">
{"description":"Programming Language Foundations in Agda","@type":"WebPage","url":"https://plfa.github.io/Substitution/","headline":"Substitution in the untyped lambda calculus","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"></head>
<body><header class="site-header" role="banner">

    <div class="wrapper">

        <a class="site-title" href="/">Programming Language Foundations in Agda
</a>

        <nav class="site-nav">
            <span class="menu-icon">
                <svg viewBox="0 0 18 15" width="18px" height="15px">
                    <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
                    <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
                    <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
                </svg>
            </span>

            <div class="trigger">
                <a class="page-link" href="/">Table of Contents</a>
                <a class="page-link" href="/GettingStarted/">Getting Started</a>
            </div>
        </nav>

    </div>

</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
      <h1 class="post-title">Substitution in the untyped lambda calculus</h1>
  </header>

  <p style="text-align:center;">
    
    <a alt="Previous chapter" href="/Untyped/">Prev</a>
    &bullet;
    
    
    <a alt="Source code" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/Substitution.lagda">Source</a>
    
    
    &bullet;
    <a alt="Next chapter" href="/LambdaReduction/">Next</a>
    
</p>


  <div class="post-content">
    <pre class="Agda"><a id="178" class="Keyword">module</a> <a id="185" href="/Substitution/" class="Module">plfa.Substitution</a> <a id="203" class="Keyword">where</a></pre>

<h2 id="imports">Imports</h2>

<pre class="Agda"><a id="246" class="Keyword">open</a> <a id="251" class="Keyword">import</a> <a id="258" href="/Untyped/" class="Module">plfa.Untyped</a>
  <a id="273" class="Keyword">using</a> <a id="279" class="Symbol">(</a><a id="280" href="/Untyped/#2675" class="Datatype">Type</a><a id="284" class="Symbol">;</a> <a id="286" href="/Untyped/#2980" class="Datatype">Context</a><a id="293" class="Symbol">;</a> <a id="295" href="/Untyped/#4150" class="Datatype Operator">_⊢_</a><a id="298" class="Symbol">;</a> <a id="300" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="301" class="Symbol">;</a> <a id="303" href="/Untyped/#3365" class="Datatype Operator">_∋_</a><a id="306" class="Symbol">;</a> <a id="308" href="/Untyped/#3002" class="InductiveConstructor">∅</a><a id="309" class="Symbol">;</a> <a id="311" href="/Untyped/#3018" class="InductiveConstructor Operator">_,_</a><a id="314" class="Symbol">;</a> <a id="316" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="317" class="Symbol">;</a> <a id="319" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="321" class="Symbol">;</a> <a id="323" href="/Untyped/#4186" class="InductiveConstructor Operator">`_</a><a id="325" class="Symbol">;</a> <a id="327" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a><a id="329" class="Symbol">;</a> <a id="331" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a><a id="334" class="Symbol">;</a>
         <a id="345" href="/Untyped/#6171" class="Function">rename</a><a id="351" class="Symbol">;</a> <a id="353" href="/Untyped/#6931" class="Function">subst</a><a id="358" class="Symbol">;</a> <a id="360" href="/Untyped/#5845" class="Function">ext</a><a id="363" class="Symbol">;</a> <a id="365" href="/Untyped/#6623" class="Function">exts</a><a id="369" class="Symbol">;</a> <a id="371" href="/Untyped/#7475" class="Function Operator">_[_]</a><a id="375" class="Symbol">;</a> <a id="377" href="/Untyped/#7359" class="Function">subst-zero</a><a id="387" class="Symbol">)</a>
<a id="389" class="Keyword">open</a> <a id="394" class="Keyword">import</a> <a id="401" href="/Denotational/" class="Module">plfa.Denotational</a> <a id="419" class="Keyword">using</a> <a id="425" class="Symbol">(</a><a id="426" href="/Denotational/#23035" class="Function">Rename</a><a id="432" class="Symbol">;</a> <a id="434" href="/Denotational/#3265" class="Postulate">extensionality</a><a id="448" class="Symbol">)</a>
<a id="450" class="Keyword">open</a> <a id="455" class="Keyword">import</a> <a id="462" href="/Soundness/" class="Module">plfa.Soundness</a> <a id="477" class="Keyword">using</a> <a id="483" class="Symbol">(</a><a id="484" href="/Soundness/#2673" class="Function">Subst</a><a id="489" class="Symbol">)</a>

<a id="492" class="Keyword">import</a> <a id="499" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="537" class="Symbol">as</a> <a id="540" class="Module">Eq</a>
<a id="543" class="Keyword">open</a> <a id="548" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="551" class="Keyword">using</a> <a id="557" class="Symbol">(</a><a id="558" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="561" class="Symbol">;</a> <a id="563" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="567" class="Symbol">;</a> <a id="569" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a><a id="572" class="Symbol">;</a> <a id="574" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a><a id="578" class="Symbol">;</a> <a id="580" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a><a id="585" class="Symbol">;</a> <a id="587" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a><a id="595" class="Symbol">)</a>
<a id="597" class="Keyword">open</a> <a id="602" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#3975" class="Module">Eq.≡-Reasoning</a> <a id="617" class="Keyword">using</a> <a id="623" class="Symbol">(</a><a id="624" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin_</a><a id="630" class="Symbol">;</a> <a id="632" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">_≡⟨⟩_</a><a id="637" class="Symbol">;</a> <a id="639" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">_≡⟨_⟩_</a><a id="645" class="Symbol">;</a> <a id="647" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">_∎</a><a id="649" class="Symbol">)</a>
<a id="651" class="Keyword">open</a> <a id="656" class="Keyword">import</a> <a id="663" href="https://agda.github.io/agda-stdlib/Function.html" class="Module">Function</a> <a id="672" class="Keyword">using</a> <a id="678" class="Symbol">(</a><a id="679" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">_∘_</a><a id="682" class="Symbol">)</a></pre>

<h2 id="overview">Overview</h2>

<p>The primary purpose of this chapter is to prove that substitution
commutes with itself. Barendgredt (1984) refers to this
as the substitution lemma:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M [x:=N] [y:=L] = M [y:=L] [x:= N[y:=L] ]
</code></pre></div></div>

<p>In our setting, with de Bruijn indices for variables, the statement of
the lemma becomes:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M [ N ] [ L ] ≡  M〔 L 〕[ N [ L ] ]                     (substitution)
</code></pre></div></div>

<p>where the notation <code class="highlighter-rouge">M 〔 L 〕</code> is for subsituting L for index 1 inside
M.  In addition, because we define substitution in terms of parallel
substitution, we have the following generalization, replacing the
substitution of L with an arbitrary parallel substitution σ.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>subst σ (M [ N ]) ≡ (subst (exts σ) M) [ subst σ N ]    (subst-commute)
</code></pre></div></div>

<p>The special case for renamings is also useful.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ (M [ N ]) ≡ (rename (ext ρ) M) [ rename ρ N ]
                                                 (rename-subst-commute)
</code></pre></div></div>

<p>The secondary purpose of this chapter is to define the σ algebra of
parallel substitution due to Abadi, Cardelli, Curien, and Levy
(1991). The equations of this algebra not only help us prove the
substitution lemma, but they are generally useful. Futhermore, when
the equations are applied from left to right, they form a rewrite
system that <em>decides</em> whether any two substitutions are equal.</p>

<p>We use the following more succinct notation the <code class="highlighter-rouge">subst</code> function.</p>

<pre class="Agda"><a id="⟪_⟫"></a><a id="2076" href="/Substitution/#2076" class="Function Operator">⟪_⟫</a> <a id="2080" class="Symbol">:</a> <a id="2082" class="Symbol">∀{</a><a id="2084" href="/Substitution/#2084" class="Bound">Γ</a> <a id="2086" href="/Substitution/#2086" class="Bound">Δ</a> <a id="2088" href="/Substitution/#2088" class="Bound">A</a><a id="2089" class="Symbol">}</a> <a id="2091" class="Symbol">→</a> <a id="2093" href="/Soundness/#2673" class="Function">Subst</a> <a id="2099" href="/Substitution/#2084" class="Bound">Γ</a> <a id="2101" href="/Substitution/#2086" class="Bound">Δ</a> <a id="2103" class="Symbol">→</a> <a id="2105" href="/Substitution/#2084" class="Bound">Γ</a> <a id="2107" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="2109" href="/Substitution/#2088" class="Bound">A</a> <a id="2111" class="Symbol">→</a> <a id="2113" href="/Substitution/#2086" class="Bound">Δ</a> <a id="2115" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="2117" href="/Substitution/#2088" class="Bound">A</a>
<a id="2119" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="2121" href="/Substitution/#2121" class="Bound">σ</a> <a id="2123" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="2125" class="Symbol">=</a> <a id="2127" class="Symbol">λ</a> <a id="2129" href="/Substitution/#2129" class="Bound">M</a> <a id="2131" class="Symbol">→</a> <a id="2133" href="/Untyped/#6931" class="Function">subst</a> <a id="2139" href="/Substitution/#2121" class="Bound">σ</a> <a id="2141" href="/Substitution/#2129" class="Bound">M</a></pre>

<h2 id="the-σ-algebra-of-substitution">The σ algebra of substitution</h2>

<p>Substitutions map de Bruijn indices (natural numbers) to terms, so we
can view a substitution simply as a sequence of terms, or more
precisely, as an infinite sequence of terms. The σ algebra consists of
four operations for building such sequences: identity <code class="highlighter-rouge">ids</code>, shift
<code class="highlighter-rouge">↑</code>, cons <code class="highlighter-rouge">M • σ</code>, and sequencing <code class="highlighter-rouge">σ ⨟ τ</code>.  The sequence <code class="highlighter-rouge">0, 1, 2, ...</code>
is constructed by the identity subsitution.</p>

<pre class="Agda"><a id="ids"></a><a id="2591" href="/Substitution/#2591" class="Function">ids</a> <a id="2595" class="Symbol">:</a> <a id="2597" class="Symbol">∀{</a><a id="2599" href="/Substitution/#2599" class="Bound">Γ</a><a id="2600" class="Symbol">}</a> <a id="2602" class="Symbol">→</a> <a id="2604" href="/Soundness/#2673" class="Function">Subst</a> <a id="2610" href="/Substitution/#2599" class="Bound">Γ</a> <a id="2612" href="/Substitution/#2599" class="Bound">Γ</a>
<a id="2614" href="/Substitution/#2591" class="Function">ids</a> <a id="2618" href="/Substitution/#2618" class="Bound">x</a> <a id="2620" class="Symbol">=</a> <a id="2622" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="2624" href="/Substitution/#2618" class="Bound">x</a></pre>

<p>The shift operation <code class="highlighter-rouge">↑</code> constructs the sequence</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1, 2, 3, ...
</code></pre></div></div>

<p>and is defined as follows.</p>

<pre class="Agda"><a id="↑"></a><a id="2746" href="/Substitution/#2746" class="Function">↑</a> <a id="2748" class="Symbol">:</a> <a id="2750" class="Symbol">∀{</a><a id="2752" href="/Substitution/#2752" class="Bound">Γ</a> <a id="2754" href="/Substitution/#2754" class="Bound">A</a><a id="2755" class="Symbol">}</a> <a id="2757" class="Symbol">→</a> <a id="2759" href="/Soundness/#2673" class="Function">Subst</a> <a id="2765" href="/Substitution/#2752" class="Bound">Γ</a> <a id="2767" class="Symbol">(</a><a id="2768" href="/Substitution/#2752" class="Bound">Γ</a> <a id="2770" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="2772" href="/Substitution/#2754" class="Bound">A</a><a id="2773" class="Symbol">)</a>
<a id="2775" href="/Substitution/#2746" class="Function">↑</a> <a id="2777" href="/Substitution/#2777" class="Bound">x</a> <a id="2779" class="Symbol">=</a> <a id="2781" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="2783" class="Symbol">(</a><a id="2784" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="2786" href="/Substitution/#2777" class="Bound">x</a><a id="2787" class="Symbol">)</a></pre>

<p>Given a term <code class="highlighter-rouge">M</code> and substitution <code class="highlighter-rouge">σ</code>, the operation
<code class="highlighter-rouge">M • σ</code> constructs the sequence</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M , σ 0, σ 1, σ 2, ...
</code></pre></div></div>

<p>This operation is analogous to the <code class="highlighter-rouge">cons</code> operation of Lisp.</p>

<pre class="Agda"><a id="2990" class="Keyword">infixr</a> <a id="2997" class="Number">6</a> <a id="2999" href="/Substitution/#3004" class="Function Operator">_•_</a>

<a id="_•_"></a><a id="3004" href="/Substitution/#3004" class="Function Operator">_•_</a> <a id="3008" class="Symbol">:</a> <a id="3010" class="Symbol">∀{</a><a id="3012" href="/Substitution/#3012" class="Bound">Γ</a> <a id="3014" href="/Substitution/#3014" class="Bound">Δ</a> <a id="3016" href="/Substitution/#3016" class="Bound">A</a><a id="3017" class="Symbol">}</a> <a id="3019" class="Symbol">→</a> <a id="3021" class="Symbol">(</a><a id="3022" href="/Substitution/#3014" class="Bound">Δ</a> <a id="3024" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="3026" href="/Substitution/#3016" class="Bound">A</a><a id="3027" class="Symbol">)</a> <a id="3029" class="Symbol">→</a> <a id="3031" href="/Soundness/#2673" class="Function">Subst</a> <a id="3037" href="/Substitution/#3012" class="Bound">Γ</a> <a id="3039" href="/Substitution/#3014" class="Bound">Δ</a> <a id="3041" class="Symbol">→</a> <a id="3043" href="/Soundness/#2673" class="Function">Subst</a> <a id="3049" class="Symbol">(</a><a id="3050" href="/Substitution/#3012" class="Bound">Γ</a> <a id="3052" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="3054" href="/Substitution/#3016" class="Bound">A</a><a id="3055" class="Symbol">)</a> <a id="3057" href="/Substitution/#3014" class="Bound">Δ</a>
<a id="3059" class="Symbol">(</a><a id="3060" href="/Substitution/#3060" class="Bound">M</a> <a id="3062" href="/Substitution/#3004" class="Function Operator">•</a> <a id="3064" href="/Substitution/#3064" class="Bound">σ</a><a id="3065" class="Symbol">)</a> <a id="3067" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="3069" class="Symbol">=</a> <a id="3071" href="/Substitution/#3060" class="Bound">M</a>
<a id="3073" class="Symbol">(</a><a id="3074" href="/Substitution/#3074" class="Bound">M</a> <a id="3076" href="/Substitution/#3004" class="Function Operator">•</a> <a id="3078" href="/Substitution/#3078" class="Bound">σ</a><a id="3079" class="Symbol">)</a> <a id="3081" class="Symbol">(</a><a id="3082" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="3084" href="/Substitution/#3084" class="Bound">x</a><a id="3085" class="Symbol">)</a> <a id="3087" class="Symbol">=</a> <a id="3089" href="/Substitution/#3078" class="Bound">σ</a> <a id="3091" href="/Substitution/#3084" class="Bound">x</a></pre>

<p>Given two substitutions <code class="highlighter-rouge">σ</code> and <code class="highlighter-rouge">τ</code>, the sequencing operation <code class="highlighter-rouge">σ ⨟ τ</code>
produces the sequence</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪τ⟫(σ 0), ⟪τ⟫(σ 1), ⟪τ⟫(σ 2), ...
</code></pre></div></div>

<p>That is, it composes the two substitutions by first applying
<code class="highlighter-rouge">σ</code> and then applying <code class="highlighter-rouge">τ</code>.</p>

<pre class="Agda"><a id="3343" class="Keyword">infixr</a> <a id="3350" class="Number">5</a> <a id="3352" href="/Substitution/#3357" class="Function Operator">_⨟_</a>

<a id="_⨟_"></a><a id="3357" href="/Substitution/#3357" class="Function Operator">_⨟_</a> <a id="3361" class="Symbol">:</a> <a id="3363" class="Symbol">∀{</a><a id="3365" href="/Substitution/#3365" class="Bound">Γ</a> <a id="3367" href="/Substitution/#3367" class="Bound">Δ</a> <a id="3369" href="/Substitution/#3369" class="Bound">Σ</a><a id="3370" class="Symbol">}</a> <a id="3372" class="Symbol">→</a> <a id="3374" href="/Soundness/#2673" class="Function">Subst</a> <a id="3380" href="/Substitution/#3365" class="Bound">Γ</a> <a id="3382" href="/Substitution/#3367" class="Bound">Δ</a> <a id="3384" class="Symbol">→</a> <a id="3386" href="/Soundness/#2673" class="Function">Subst</a> <a id="3392" href="/Substitution/#3367" class="Bound">Δ</a> <a id="3394" href="/Substitution/#3369" class="Bound">Σ</a> <a id="3396" class="Symbol">→</a> <a id="3398" href="/Soundness/#2673" class="Function">Subst</a> <a id="3404" href="/Substitution/#3365" class="Bound">Γ</a> <a id="3406" href="/Substitution/#3369" class="Bound">Σ</a>
<a id="3408" href="/Substitution/#3408" class="Bound">σ</a> <a id="3410" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="3412" href="/Substitution/#3412" class="Bound">τ</a> <a id="3414" class="Symbol">=</a> <a id="3416" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="3418" href="/Substitution/#3412" class="Bound">τ</a> <a id="3420" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="3422" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="3424" href="/Substitution/#3408" class="Bound">σ</a></pre>

<p>For the sequencing operation, Abadi et al. use the notation of
function composition, writting <code class="highlighter-rouge">σ ∘ τ</code>, but still with <code class="highlighter-rouge">σ</code> applied
before <code class="highlighter-rouge">τ</code>, which is the opposite of standard mathematical
practice. We instead write <code class="highlighter-rouge">σ ⨟ τ</code>, because semicolon is
the standard notation for forward function composition.</p>

<h2 id="the-σ-algebra-equations">The σ algebra equations</h2>

<p>The σ algebra includes the following equations.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(sub-head)  ⟪ M • σ ⟫ (` Z) ≡ M
(sub-tail)  ↑ ⨟ (M • σ)    ≡ σ
(sub-η)     (⟪ σ ⟫ (` Z)) • (↑ ⨟ σ) ≡ σ
(Z-shift)   (` Z) • ↑      ≡ ids

(sub-id)    ⟪ ids ⟫ M      ≡ M
(sub-app)   ⟪ σ ⟫ (L · M)  ≡ (⟪ σ ⟫ L) · (⟪ σ ⟫ M)
(sub-abs)   ⟪ σ ⟫ (ƛ N)    ≡ ƛ ⟪ σ ⟫ N
(sub-sub)   ⟪ τ ⟫ ⟪ σ ⟫ M  ≡ ⟪ σ ⨟ τ ⟫ M

(sub-idL)   ids ⨟ σ        ≡ σ
(sub-idR)   σ ⨟ ids        ≡ σ
(sub-assoc) (σ ⨟ τ) ⨟ θ    ≡ σ ⨟ (τ ⨟ θ)
(sub-dist)  (M • σ) ⨟ τ    ≡ (⟪ τ ⟫ M) • (σ ⨟ τ)
</code></pre></div></div>

<p>The first group of equations describe how the <code class="highlighter-rouge">•</code> operator acts like cons.
The equation <code class="highlighter-rouge">sub-head</code> says that the variable zero <code class="highlighter-rouge">Z</code> returns the
head of the sequence (it acts like the <code class="highlighter-rouge">car</code> of Lisp).  Similarly,
<code class="highlighter-rouge">sub-tail</code> says that sequencing with shift <code class="highlighter-rouge">↑</code> returns the tail of the
sequence (it acts like <code class="highlighter-rouge">cdr</code> of Lisp).  The <code class="highlighter-rouge">sub-η</code> equation is the
η-expansion rule for sequences, saying that taking the head and tail
of a sequence, and then cons’ing them together yields the original
sequence. The <code class="highlighter-rouge">Z-shift</code> equation says that cons’ing zero onto the
shifted sequence produces the identity sequence.</p>

<p>The next four equations involve applying substitutions to terms.  The
equation <code class="highlighter-rouge">sub-id</code> says that the identity substitution returns the term
unchanged. The equations <code class="highlighter-rouge">sub-app</code> and <code class="highlighter-rouge">sub-abs</code> says that
substitution is a congruence for the lambda calculus. The <code class="highlighter-rouge">sub-sub</code>
equation says that the sequence operator <code class="highlighter-rouge">⨟</code> behaves as intended.</p>

<p>The last four equations concern the sequencing of substitutions.
The first two equations, <code class="highlighter-rouge">sub-idL</code> and <code class="highlighter-rouge">sub-idR</code>, say that
<code class="highlighter-rouge">ids</code> is the left and right unit of the sequencing operator.
The <code class="highlighter-rouge">sub-assoc</code> equation says that sequencing is associative.
Finally, <code class="highlighter-rouge">sub-dist</code> says that post-sequencing distributes through cons.</p>

<h2 id="relating-the-σ-algebra-and-subsitution-functions">Relating the σ algebra and subsitution functions</h2>

<p>The definitions of substitution <code class="highlighter-rouge">N [ M ]</code> and parallel subsitution
<code class="highlighter-rouge">subst σ N</code> depend on several auxiliary functions: <code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>,
<code class="highlighter-rouge">ext</code>, and <code class="highlighter-rouge">subst-zero</code>. We shall relate those functions to terms in
the σ algebra.</p>

<p>To begin with, renaming can be expressed in terms of substitution.
We have</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ M ≡ ⟪ ren ρ ⟫ M               (rename-subst-ren)
</code></pre></div></div>

<p>where <code class="highlighter-rouge">ren</code> turns a renaming <code class="highlighter-rouge">ρ</code> into a substitution by post-composing
<code class="highlighter-rouge">ρ</code> with the identity substitution.</p>

<pre class="Agda"><a id="ren"></a><a id="6114" href="/Substitution/#6114" class="Function">ren</a> <a id="6118" class="Symbol">:</a> <a id="6120" class="Symbol">∀{</a><a id="6122" href="/Substitution/#6122" class="Bound">Γ</a> <a id="6124" href="/Substitution/#6124" class="Bound">Δ</a><a id="6125" class="Symbol">}</a> <a id="6127" class="Symbol">→</a> <a id="6129" href="/Denotational/#23035" class="Function">Rename</a> <a id="6136" href="/Substitution/#6122" class="Bound">Γ</a> <a id="6138" href="/Substitution/#6124" class="Bound">Δ</a> <a id="6140" class="Symbol">→</a> <a id="6142" href="/Soundness/#2673" class="Function">Subst</a> <a id="6148" href="/Substitution/#6122" class="Bound">Γ</a> <a id="6150" href="/Substitution/#6124" class="Bound">Δ</a>
<a id="6152" href="/Substitution/#6114" class="Function">ren</a> <a id="6156" href="/Substitution/#6156" class="Bound">ρ</a> <a id="6158" class="Symbol">=</a> <a id="6160" href="/Substitution/#2591" class="Function">ids</a> <a id="6164" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="6166" href="/Substitution/#6156" class="Bound">ρ</a></pre>

<p>When the renaming is the increment function, then it is equivalent to
shift.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ren S_ ≡ ↑                           (ren-shift)

rename S_ M ≡ ⟪ ↑ ⟫ M                 (rename-shift)
</code></pre></div></div>

<p>Next we relate the <code class="highlighter-rouge">exts</code> function to the σ algebra.  Recall that the
<code class="highlighter-rouge">exts</code> function extends a substitution as follows:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts σ = ` Z, rename S_ (σ 0), rename S_ (σ 1), rename S_ (σ 2), ...
</code></pre></div></div>

<p>So <code class="highlighter-rouge">exts</code> is equivalent to cons’ing Z onto the sequence formed
by applying <code class="highlighter-rouge">σ</code> and then shifting.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts σ ≡ ` Z • (σ ⨟ ↑)                (exts-cons-shift)
</code></pre></div></div>

<p>The <code class="highlighter-rouge">ext</code> function does the same job as <code class="highlighter-rouge">exts</code> but for renamings
instead of substitutions. So composing <code class="highlighter-rouge">ext</code> with <code class="highlighter-rouge">ren</code> is the same as
composing <code class="highlighter-rouge">ren</code> with <code class="highlighter-rouge">exts</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ren (ext ρ) ≡ exts (ren ρ)            (ren-ext)
</code></pre></div></div>

<p>Thus, we can recast the <code class="highlighter-rouge">exts-cons-shift</code> equation in terms of
renamings.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ren (ext ρ) ≡ ` Z • (ren ρ ⨟ ↑)       (ext-cons-Z-shift)
</code></pre></div></div>

<p>It is also useful to specialize the <code class="highlighter-rouge">sub-sub</code> equation of the σ
algebra to the situation where the first substitution is a renaming.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ σ ⟫ (rename ρ M) ≡ ⟪ σ ∘ ρ ⟫ M       (rename-subst)
</code></pre></div></div>

<p>The <code class="highlighter-rouge">subst-zero M</code> substitution is equivalent to cons’ing
<code class="highlighter-rouge">M</code> onto the identity substitution.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>subst-zero M ≡ M • ids                (subst-Z-cons-ids)
</code></pre></div></div>

<p>Finally, sequencing <code class="highlighter-rouge">exts σ</code> with <code class="highlighter-rouge">subst-zero M</code> is equivalent to
cons’ing <code class="highlighter-rouge">M</code> onto <code class="highlighter-rouge">σ</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts σ ⨟ subst-zero M ≡ (M • σ)       (subst-zero-exts-cons)
</code></pre></div></div>

<h2 id="proofs-of-sub-head-sub-tail-sub-η-z-shift-sub-idl-sub-dist-and-sub-app">Proofs of sub-head, sub-tail, sub-η, Z-shift, sub-idL, sub-dist, and sub-app</h2>

<p>We start with the proofs that are immediate from the definitions of
the operators.</p>

<pre class="Agda"><a id="sub-head"></a><a id="7772" href="/Substitution/#7772" class="Function">sub-head</a> <a id="7781" class="Symbol">:</a> <a id="7783" class="Symbol">∀</a> <a id="7785" class="Symbol">{</a><a id="7786" href="/Substitution/#7786" class="Bound">Γ</a> <a id="7788" href="/Substitution/#7788" class="Bound">Δ</a><a id="7789" class="Symbol">}</a> <a id="7791" class="Symbol">{</a><a id="7792" href="/Substitution/#7792" class="Bound">A</a><a id="7793" class="Symbol">}</a> <a id="7795" class="Symbol">{</a><a id="7796" href="/Substitution/#7796" class="Bound">M</a> <a id="7798" class="Symbol">:</a> <a id="7800" href="/Substitution/#7788" class="Bound">Δ</a> <a id="7802" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="7804" href="/Substitution/#7792" class="Bound">A</a><a id="7805" class="Symbol">}{</a><a id="7807" href="/Substitution/#7807" class="Bound">σ</a> <a id="7809" class="Symbol">:</a> <a id="7811" href="/Soundness/#2673" class="Function">Subst</a> <a id="7817" href="/Substitution/#7786" class="Bound">Γ</a> <a id="7819" href="/Substitution/#7788" class="Bound">Δ</a><a id="7820" class="Symbol">}</a>
         <a id="7831" class="Symbol">→</a> <a id="7833" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="7835" href="/Substitution/#7796" class="Bound">M</a> <a id="7837" href="/Substitution/#3004" class="Function Operator">•</a> <a id="7839" href="/Substitution/#7807" class="Bound">σ</a> <a id="7841" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="7843" class="Symbol">(</a><a id="7844" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="7846" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="7847" class="Symbol">)</a> <a id="7849" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="7851" href="/Substitution/#7796" class="Bound">M</a>
<a id="7853" href="/Substitution/#7772" class="Function">sub-head</a> <a id="7862" class="Symbol">=</a> <a id="7864" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-tail"></a><a id="7894" href="/Substitution/#7894" class="Function">sub-tail</a> <a id="7903" class="Symbol">:</a> <a id="7905" class="Symbol">∀{</a><a id="7907" href="/Substitution/#7907" class="Bound">Γ</a> <a id="7909" href="/Substitution/#7909" class="Bound">Δ</a><a id="7910" class="Symbol">}</a> <a id="7912" class="Symbol">{</a><a id="7913" href="/Substitution/#7913" class="Bound">A</a> <a id="7915" href="/Substitution/#7915" class="Bound">B</a><a id="7916" class="Symbol">}</a> <a id="7918" class="Symbol">{</a><a id="7919" href="/Substitution/#7919" class="Bound">M</a> <a id="7921" class="Symbol">:</a> <a id="7923" href="/Substitution/#7909" class="Bound">Δ</a> <a id="7925" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="7927" href="/Substitution/#7913" class="Bound">A</a><a id="7928" class="Symbol">}</a> <a id="7930" class="Symbol">{</a><a id="7931" href="/Substitution/#7931" class="Bound">σ</a> <a id="7933" class="Symbol">:</a> <a id="7935" href="/Soundness/#2673" class="Function">Subst</a> <a id="7941" href="/Substitution/#7907" class="Bound">Γ</a> <a id="7943" href="/Substitution/#7909" class="Bound">Δ</a><a id="7944" class="Symbol">}</a>
         <a id="7955" class="Symbol">→</a> <a id="7957" class="Symbol">(</a><a id="7958" href="/Substitution/#2746" class="Function">↑</a> <a id="7960" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="7962" href="/Substitution/#7919" class="Bound">M</a> <a id="7964" href="/Substitution/#3004" class="Function Operator">•</a> <a id="7966" href="/Substitution/#7931" class="Bound">σ</a><a id="7967" class="Symbol">)</a> <a id="7969" class="Symbol">{</a><a id="7970" class="Argument">A</a> <a id="7972" class="Symbol">=</a> <a id="7974" href="/Substitution/#7915" class="Bound">B</a><a id="7975" class="Symbol">}</a> <a id="7977" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="7979" href="/Substitution/#7931" class="Bound">σ</a>
<a id="7981" href="/Substitution/#7894" class="Function">sub-tail</a> <a id="7990" class="Symbol">=</a> <a id="7992" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="8007" class="Symbol">λ</a> <a id="8009" href="/Substitution/#8009" class="Bound">x</a> <a id="8011" class="Symbol">→</a> <a id="8013" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-η"></a><a id="8043" href="/Substitution/#8043" class="Function">sub-η</a> <a id="8049" class="Symbol">:</a> <a id="8051" class="Symbol">∀{</a><a id="8053" href="/Substitution/#8053" class="Bound">Γ</a> <a id="8055" href="/Substitution/#8055" class="Bound">Δ</a><a id="8056" class="Symbol">}</a> <a id="8058" class="Symbol">{</a><a id="8059" href="/Substitution/#8059" class="Bound">A</a> <a id="8061" href="/Substitution/#8061" class="Bound">B</a><a id="8062" class="Symbol">}</a> <a id="8064" class="Symbol">{</a><a id="8065" href="/Substitution/#8065" class="Bound">σ</a> <a id="8067" class="Symbol">:</a> <a id="8069" href="/Soundness/#2673" class="Function">Subst</a> <a id="8075" class="Symbol">(</a><a id="8076" href="/Substitution/#8053" class="Bound">Γ</a> <a id="8078" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="8080" href="/Substitution/#8059" class="Bound">A</a><a id="8081" class="Symbol">)</a> <a id="8083" href="/Substitution/#8055" class="Bound">Δ</a><a id="8084" class="Symbol">}</a> 
      <a id="8093" class="Symbol">→</a> <a id="8095" class="Symbol">(</a><a id="8096" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="8098" href="/Substitution/#8065" class="Bound">σ</a> <a id="8100" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="8102" class="Symbol">(</a><a id="8103" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="8105" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8106" class="Symbol">)</a> <a id="8108" href="/Substitution/#3004" class="Function Operator">•</a> <a id="8110" class="Symbol">(</a><a id="8111" href="/Substitution/#2746" class="Function">↑</a> <a id="8113" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="8115" href="/Substitution/#8065" class="Bound">σ</a><a id="8116" class="Symbol">))</a> <a id="8119" class="Symbol">{</a><a id="8120" class="Argument">A</a> <a id="8122" class="Symbol">=</a> <a id="8124" href="/Substitution/#8061" class="Bound">B</a><a id="8125" class="Symbol">}</a> <a id="8127" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8129" href="/Substitution/#8065" class="Bound">σ</a>
<a id="8131" href="/Substitution/#8043" class="Function">sub-η</a> <a id="8137" class="Symbol">{</a><a id="8138" href="/Substitution/#8138" class="Bound">Γ</a><a id="8139" class="Symbol">}{</a><a id="8141" href="/Substitution/#8141" class="Bound">Δ</a><a id="8142" class="Symbol">}{</a><a id="8144" href="/Substitution/#8144" class="Bound">A</a><a id="8145" class="Symbol">}{</a><a id="8147" href="/Substitution/#8147" class="Bound">B</a><a id="8148" class="Symbol">}{</a><a id="8150" href="/Substitution/#8150" class="Bound">σ</a><a id="8151" class="Symbol">}</a> <a id="8153" class="Symbol">=</a> <a id="8155" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="8170" class="Symbol">λ</a> <a id="8172" href="/Substitution/#8172" class="Bound">x</a> <a id="8174" class="Symbol">→</a> <a id="8176" href="/Substitution/#8195" class="Function">lemma</a>
   <a id="8185" class="Keyword">where</a> 
   <a id="8195" href="/Substitution/#8195" class="Function">lemma</a> <a id="8201" class="Symbol">:</a> <a id="8203" class="Symbol">∀</a> <a id="8205" class="Symbol">{</a><a id="8206" href="/Substitution/#8206" class="Bound">x</a><a id="8207" class="Symbol">}</a> <a id="8209" class="Symbol">→</a> <a id="8211" class="Symbol">((</a><a id="8213" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="8215" href="/Substitution/#8150" class="Bound">σ</a> <a id="8217" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="8219" class="Symbol">(</a><a id="8220" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="8222" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8223" class="Symbol">))</a> <a id="8226" href="/Substitution/#3004" class="Function Operator">•</a> <a id="8228" class="Symbol">(</a><a id="8229" href="/Substitution/#2746" class="Function">↑</a> <a id="8231" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="8233" href="/Substitution/#8150" class="Bound">σ</a><a id="8234" class="Symbol">))</a> <a id="8237" href="/Substitution/#8206" class="Bound">x</a> <a id="8239" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8241" href="/Substitution/#8150" class="Bound">σ</a> <a id="8243" href="/Substitution/#8206" class="Bound">x</a>
   <a id="8248" href="/Substitution/#8195" class="Function">lemma</a> <a id="8254" class="Symbol">{</a><a id="8255" class="Argument">x</a> <a id="8257" class="Symbol">=</a> <a id="8259" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8260" class="Symbol">}</a> <a id="8262" class="Symbol">=</a> <a id="8264" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="8272" href="/Substitution/#8195" class="Function">lemma</a> <a id="8278" class="Symbol">{</a><a id="8279" class="Argument">x</a> <a id="8281" class="Symbol">=</a> <a id="8283" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="8285" href="/Substitution/#8285" class="Bound">x</a><a id="8286" class="Symbol">}</a> <a id="8288" class="Symbol">=</a> <a id="8290" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="Z-shift"></a><a id="8320" href="/Substitution/#8320" class="Function">Z-shift</a> <a id="8328" class="Symbol">:</a> <a id="8330" class="Symbol">∀{</a><a id="8332" href="/Substitution/#8332" class="Bound">Γ</a><a id="8333" class="Symbol">}{</a><a id="8335" href="/Substitution/#8335" class="Bound">A</a> <a id="8337" href="/Substitution/#8337" class="Bound">B</a><a id="8338" class="Symbol">}</a>
        <a id="8348" class="Symbol">→</a> <a id="8350" class="Symbol">((</a><a id="8352" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="8354" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8355" class="Symbol">)</a> <a id="8357" href="/Substitution/#3004" class="Function Operator">•</a> <a id="8359" href="/Substitution/#2746" class="Function">↑</a><a id="8360" class="Symbol">)</a> <a id="8362" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8364" href="/Substitution/#2591" class="Function">ids</a> <a id="8368" class="Symbol">{</a><a id="8369" href="/Substitution/#8332" class="Bound">Γ</a> <a id="8371" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="8373" href="/Substitution/#8335" class="Bound">A</a><a id="8374" class="Symbol">}</a> <a id="8376" class="Symbol">{</a><a id="8377" href="/Substitution/#8337" class="Bound">B</a><a id="8378" class="Symbol">}</a>
<a id="8380" href="/Substitution/#8320" class="Function">Z-shift</a> <a id="8388" class="Symbol">{</a><a id="8389" href="/Substitution/#8389" class="Bound">Γ</a><a id="8390" class="Symbol">}{</a><a id="8392" href="/Substitution/#8392" class="Bound">A</a><a id="8393" class="Symbol">}{</a><a id="8395" href="/Substitution/#8395" class="Bound">B</a><a id="8396" class="Symbol">}</a> <a id="8398" class="Symbol">=</a> <a id="8400" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="8415" href="/Substitution/#8434" class="Function">lemma</a> 
   <a id="8425" class="Keyword">where</a>
   <a id="8434" href="/Substitution/#8434" class="Function">lemma</a> <a id="8440" class="Symbol">:</a> <a id="8442" class="Symbol">(</a><a id="8443" href="/Substitution/#8443" class="Bound">x</a> <a id="8445" class="Symbol">:</a> <a id="8447" href="/Substitution/#8389" class="Bound">Γ</a> <a id="8449" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="8451" href="/Substitution/#8392" class="Bound">A</a> <a id="8453" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="8455" href="/Substitution/#8395" class="Bound">B</a><a id="8456" class="Symbol">)</a> <a id="8458" class="Symbol">→</a> <a id="8460" class="Symbol">((</a><a id="8462" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="8464" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8465" class="Symbol">)</a> <a id="8467" href="/Substitution/#3004" class="Function Operator">•</a> <a id="8469" href="/Substitution/#2746" class="Function">↑</a><a id="8470" class="Symbol">)</a> <a id="8472" href="/Substitution/#8443" class="Bound">x</a> <a id="8474" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8476" href="/Substitution/#2591" class="Function">ids</a> <a id="8480" href="/Substitution/#8443" class="Bound">x</a>
   <a id="8485" href="/Substitution/#8434" class="Function">lemma</a> <a id="8491" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="8493" class="Symbol">=</a> <a id="8495" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="8503" href="/Substitution/#8434" class="Function">lemma</a> <a id="8509" class="Symbol">(</a><a id="8510" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="8512" href="/Substitution/#8512" class="Bound">y</a><a id="8513" class="Symbol">)</a> <a id="8515" class="Symbol">=</a> <a id="8517" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-idL"></a><a id="8547" href="/Substitution/#8547" class="Function">sub-idL</a> <a id="8555" class="Symbol">:</a> <a id="8557" class="Symbol">∀{</a><a id="8559" href="/Substitution/#8559" class="Bound">Γ</a> <a id="8561" href="/Substitution/#8561" class="Bound">Δ</a><a id="8562" class="Symbol">}</a> <a id="8564" class="Symbol">{</a><a id="8565" href="/Substitution/#8565" class="Bound">σ</a> <a id="8567" class="Symbol">:</a> <a id="8569" href="/Soundness/#2673" class="Function">Subst</a> <a id="8575" href="/Substitution/#8559" class="Bound">Γ</a> <a id="8577" href="/Substitution/#8561" class="Bound">Δ</a><a id="8578" class="Symbol">}</a> <a id="8580" class="Symbol">{</a><a id="8581" href="/Substitution/#8581" class="Bound">A</a><a id="8582" class="Symbol">}</a>
       <a id="8591" class="Symbol">→</a> <a id="8593" href="/Substitution/#2591" class="Function">ids</a> <a id="8597" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="8599" href="/Substitution/#8565" class="Bound">σ</a> <a id="8601" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8603" href="/Substitution/#8565" class="Bound">σ</a> <a id="8605" class="Symbol">{</a><a id="8606" href="/Substitution/#8581" class="Bound">A</a><a id="8607" class="Symbol">}</a>
<a id="8609" href="/Substitution/#8547" class="Function">sub-idL</a> <a id="8617" class="Symbol">=</a> <a id="8619" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="8634" class="Symbol">λ</a> <a id="8636" href="/Substitution/#8636" class="Bound">x</a> <a id="8638" class="Symbol">→</a> <a id="8640" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-dist"></a><a id="8670" href="/Substitution/#8670" class="Function">sub-dist</a> <a id="8679" class="Symbol">:</a>  <a id="8682" class="Symbol">∀{</a><a id="8684" href="/Substitution/#8684" class="Bound">Γ</a> <a id="8686" href="/Substitution/#8686" class="Bound">Δ</a> <a id="8688" href="/Substitution/#8688" class="Bound">Σ</a> <a id="8690" class="Symbol">:</a> <a id="8692" href="/Untyped/#2980" class="Datatype">Context</a><a id="8699" class="Symbol">}</a> <a id="8701" class="Symbol">{</a><a id="8702" href="/Substitution/#8702" class="Bound">A</a> <a id="8704" href="/Substitution/#8704" class="Bound">B</a><a id="8705" class="Symbol">}</a> <a id="8707" class="Symbol">{</a><a id="8708" href="/Substitution/#8708" class="Bound">σ</a> <a id="8710" class="Symbol">:</a> <a id="8712" href="/Soundness/#2673" class="Function">Subst</a> <a id="8718" href="/Substitution/#8684" class="Bound">Γ</a> <a id="8720" href="/Substitution/#8686" class="Bound">Δ</a><a id="8721" class="Symbol">}</a> <a id="8723" class="Symbol">{</a><a id="8724" href="/Substitution/#8724" class="Bound">τ</a> <a id="8726" class="Symbol">:</a> <a id="8728" href="/Soundness/#2673" class="Function">Subst</a> <a id="8734" href="/Substitution/#8686" class="Bound">Δ</a> <a id="8736" href="/Substitution/#8688" class="Bound">Σ</a><a id="8737" class="Symbol">}</a>
              <a id="8753" class="Symbol">{</a><a id="8754" href="/Substitution/#8754" class="Bound">M</a> <a id="8756" class="Symbol">:</a> <a id="8758" href="/Substitution/#8686" class="Bound">Δ</a> <a id="8760" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="8762" href="/Substitution/#8702" class="Bound">A</a><a id="8763" class="Symbol">}</a>
         <a id="8774" class="Symbol">→</a> <a id="8776" class="Symbol">((</a><a id="8778" href="/Substitution/#8754" class="Bound">M</a> <a id="8780" href="/Substitution/#3004" class="Function Operator">•</a> <a id="8782" href="/Substitution/#8708" class="Bound">σ</a><a id="8783" class="Symbol">)</a> <a id="8785" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="8787" href="/Substitution/#8724" class="Bound">τ</a><a id="8788" class="Symbol">)</a> <a id="8790" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8792" class="Symbol">((</a><a id="8794" href="/Untyped/#6931" class="Function">subst</a> <a id="8800" href="/Substitution/#8724" class="Bound">τ</a> <a id="8802" href="/Substitution/#8754" class="Bound">M</a><a id="8803" class="Symbol">)</a> <a id="8805" href="/Substitution/#3004" class="Function Operator">•</a> <a id="8807" class="Symbol">(</a><a id="8808" href="/Substitution/#8708" class="Bound">σ</a> <a id="8810" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="8812" href="/Substitution/#8724" class="Bound">τ</a><a id="8813" class="Symbol">))</a> <a id="8816" class="Symbol">{</a><a id="8817" href="/Substitution/#8704" class="Bound">B</a><a id="8818" class="Symbol">}</a>
<a id="8820" href="/Substitution/#8670" class="Function">sub-dist</a> <a id="8829" class="Symbol">{</a><a id="8830" href="/Substitution/#8830" class="Bound">Γ</a><a id="8831" class="Symbol">}{</a><a id="8833" href="/Substitution/#8833" class="Bound">Δ</a><a id="8834" class="Symbol">}{</a><a id="8836" href="/Substitution/#8836" class="Bound">Σ</a><a id="8837" class="Symbol">}{</a><a id="8839" href="/Substitution/#8839" class="Bound">A</a><a id="8840" class="Symbol">}{</a><a id="8842" href="/Substitution/#8842" class="Bound">B</a><a id="8843" class="Symbol">}{</a><a id="8845" href="/Substitution/#8845" class="Bound">σ</a><a id="8846" class="Symbol">}{</a><a id="8848" href="/Substitution/#8848" class="Bound">τ</a><a id="8849" class="Symbol">}{</a><a id="8851" href="/Substitution/#8851" class="Bound">M</a><a id="8852" class="Symbol">}</a> <a id="8854" class="Symbol">=</a> <a id="8856" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="8871" class="Symbol">λ</a> <a id="8873" href="/Substitution/#8873" class="Bound">x</a> <a id="8875" class="Symbol">→</a> <a id="8877" href="/Substitution/#8901" class="Function">lemma</a> <a id="8883" class="Symbol">{</a><a id="8884" class="Argument">x</a> <a id="8886" class="Symbol">=</a> <a id="8888" href="/Substitution/#8873" class="Bound">x</a><a id="8889" class="Symbol">}</a>
  <a id="8893" class="Keyword">where</a>
  <a id="8901" href="/Substitution/#8901" class="Function">lemma</a> <a id="8907" class="Symbol">:</a> <a id="8909" class="Symbol">∀</a> <a id="8911" class="Symbol">{</a><a id="8912" href="/Substitution/#8912" class="Bound">x</a> <a id="8914" class="Symbol">:</a> <a id="8916" href="/Substitution/#8830" class="Bound">Γ</a> <a id="8918" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="8920" href="/Substitution/#8839" class="Bound">A</a> <a id="8922" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="8924" href="/Substitution/#8842" class="Bound">B</a><a id="8925" class="Symbol">}</a> <a id="8927" class="Symbol">→</a> <a id="8929" class="Symbol">((</a><a id="8931" href="/Substitution/#8851" class="Bound">M</a> <a id="8933" href="/Substitution/#3004" class="Function Operator">•</a> <a id="8935" href="/Substitution/#8845" class="Bound">σ</a><a id="8936" class="Symbol">)</a> <a id="8938" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="8940" href="/Substitution/#8848" class="Bound">τ</a><a id="8941" class="Symbol">)</a> <a id="8943" href="/Substitution/#8912" class="Bound">x</a> <a id="8945" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8947" class="Symbol">((</a><a id="8949" href="/Untyped/#6931" class="Function">subst</a> <a id="8955" href="/Substitution/#8848" class="Bound">τ</a> <a id="8957" href="/Substitution/#8851" class="Bound">M</a><a id="8958" class="Symbol">)</a> <a id="8960" href="/Substitution/#3004" class="Function Operator">•</a> <a id="8962" class="Symbol">(</a><a id="8963" href="/Substitution/#8845" class="Bound">σ</a> <a id="8965" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="8967" href="/Substitution/#8848" class="Bound">τ</a><a id="8968" class="Symbol">))</a> <a id="8971" href="/Substitution/#8912" class="Bound">x</a>
  <a id="8975" href="/Substitution/#8901" class="Function">lemma</a> <a id="8981" class="Symbol">{</a><a id="8982" class="Argument">x</a> <a id="8984" class="Symbol">=</a> <a id="8986" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8987" class="Symbol">}</a> <a id="8989" class="Symbol">=</a> <a id="8991" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="8998" href="/Substitution/#8901" class="Function">lemma</a> <a id="9004" class="Symbol">{</a><a id="9005" class="Argument">x</a> <a id="9007" class="Symbol">=</a> <a id="9009" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="9011" href="/Substitution/#9011" class="Bound">x</a><a id="9012" class="Symbol">}</a> <a id="9014" class="Symbol">=</a> <a id="9016" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-app"></a><a id="9046" href="/Substitution/#9046" class="Function">sub-app</a> <a id="9054" class="Symbol">:</a> <a id="9056" class="Symbol">∀{</a><a id="9058" href="/Substitution/#9058" class="Bound">Γ</a> <a id="9060" href="/Substitution/#9060" class="Bound">Δ</a><a id="9061" class="Symbol">}</a> <a id="9063" class="Symbol">{</a><a id="9064" href="/Substitution/#9064" class="Bound">σ</a> <a id="9066" class="Symbol">:</a> <a id="9068" href="/Soundness/#2673" class="Function">Subst</a> <a id="9074" href="/Substitution/#9058" class="Bound">Γ</a> <a id="9076" href="/Substitution/#9060" class="Bound">Δ</a><a id="9077" class="Symbol">}</a> <a id="9079" class="Symbol">{</a><a id="9080" href="/Substitution/#9080" class="Bound">L</a> <a id="9082" class="Symbol">:</a> <a id="9084" href="/Substitution/#9058" class="Bound">Γ</a> <a id="9086" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="9088" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="9089" class="Symbol">}{</a><a id="9091" href="/Substitution/#9091" class="Bound">M</a> <a id="9093" class="Symbol">:</a> <a id="9095" href="/Substitution/#9058" class="Bound">Γ</a> <a id="9097" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="9099" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="9100" class="Symbol">}</a>
        <a id="9110" class="Symbol">→</a> <a id="9112" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="9114" href="/Substitution/#9064" class="Bound">σ</a> <a id="9116" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="9118" class="Symbol">(</a><a id="9119" href="/Substitution/#9080" class="Bound">L</a> <a id="9121" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="9123" href="/Substitution/#9091" class="Bound">M</a><a id="9124" class="Symbol">)</a>  <a id="9127" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9129" class="Symbol">(</a><a id="9130" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="9132" href="/Substitution/#9064" class="Bound">σ</a> <a id="9134" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="9136" href="/Substitution/#9080" class="Bound">L</a><a id="9137" class="Symbol">)</a> <a id="9139" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="9141" class="Symbol">(</a><a id="9142" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="9144" href="/Substitution/#9064" class="Bound">σ</a> <a id="9146" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="9148" href="/Substitution/#9091" class="Bound">M</a><a id="9149" class="Symbol">)</a>
<a id="9151" href="/Substitution/#9046" class="Function">sub-app</a> <a id="9159" class="Symbol">=</a> <a id="9161" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<h2 id="interlude-congruences">Interlude: congruences</h2>

<p>In this section we establish congruence rules for the σ algebra
operators <code class="highlighter-rouge">•</code> and <code class="highlighter-rouge">⨟</code> and for <code class="highlighter-rouge">subst</code> and its helper functions <code class="highlighter-rouge">ext</code>,
<code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>, and <code class="highlighter-rouge">subst-zero</code>. These congruence rules help with
the equational reasoning in the later sections of this chapter.</p>

<p>[JGS: I would have liked to prove all of these via cong and cong₂,
 but I have not yet found a way to make that work. It seems that
 various implicit parameters get in the way.]</p>

<pre class="Agda"><a id="cong-ext"></a><a id="9674" href="/Substitution/#9674" class="Function">cong-ext</a> <a id="9683" class="Symbol">:</a> <a id="9685" class="Symbol">∀{</a><a id="9687" href="/Substitution/#9687" class="Bound">Γ</a> <a id="9689" href="/Substitution/#9689" class="Bound">Δ</a><a id="9690" class="Symbol">}{</a><a id="9692" href="/Substitution/#9692" class="Bound">ρ</a> <a id="9694" href="/Substitution/#9694" class="Bound">ρ′</a> <a id="9697" class="Symbol">:</a> <a id="9699" href="/Denotational/#23035" class="Function">Rename</a> <a id="9706" href="/Substitution/#9687" class="Bound">Γ</a> <a id="9708" href="/Substitution/#9689" class="Bound">Δ</a><a id="9709" class="Symbol">}{</a><a id="9711" href="/Substitution/#9711" class="Bound">B</a><a id="9712" class="Symbol">}</a>
   <a id="9717" class="Symbol">→</a> <a id="9719" class="Symbol">(∀{</a><a id="9722" href="/Substitution/#9722" class="Bound">A</a><a id="9723" class="Symbol">}</a> <a id="9725" class="Symbol">→</a> <a id="9727" href="/Substitution/#9692" class="Bound">ρ</a> <a id="9729" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9731" href="/Substitution/#9694" class="Bound">ρ′</a> <a id="9734" class="Symbol">{</a><a id="9735" href="/Substitution/#9722" class="Bound">A</a><a id="9736" class="Symbol">})</a>
     <a id="9744" class="Comment">---------------------------------</a>
   <a id="9781" class="Symbol">→</a> <a id="9783" class="Symbol">∀{</a><a id="9785" href="/Substitution/#9785" class="Bound">A</a><a id="9786" class="Symbol">}</a> <a id="9788" class="Symbol">→</a> <a id="9790" href="/Untyped/#5845" class="Function">ext</a> <a id="9794" href="/Substitution/#9692" class="Bound">ρ</a> <a id="9796" class="Symbol">{</a><a id="9797" class="Argument">B</a> <a id="9799" class="Symbol">=</a> <a id="9801" href="/Substitution/#9711" class="Bound">B</a><a id="9802" class="Symbol">}</a> <a id="9804" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9806" href="/Untyped/#5845" class="Function">ext</a> <a id="9810" href="/Substitution/#9694" class="Bound">ρ′</a> <a id="9813" class="Symbol">{</a><a id="9814" href="/Substitution/#9785" class="Bound">A</a><a id="9815" class="Symbol">}</a>
<a id="9817" href="/Substitution/#9674" class="Function">cong-ext</a><a id="9825" class="Symbol">{</a><a id="9826" href="/Substitution/#9826" class="Bound">Γ</a><a id="9827" class="Symbol">}{</a><a id="9829" href="/Substitution/#9829" class="Bound">Δ</a><a id="9830" class="Symbol">}{</a><a id="9832" href="/Substitution/#9832" class="Bound">ρ</a><a id="9833" class="Symbol">}{</a><a id="9835" href="/Substitution/#9835" class="Bound">ρ′</a><a id="9837" class="Symbol">}{</a><a id="9839" href="/Substitution/#9839" class="Bound">B</a><a id="9840" class="Symbol">}</a> <a id="9842" href="/Substitution/#9842" class="Bound">rr</a> <a id="9845" class="Symbol">{</a><a id="9846" href="/Substitution/#9846" class="Bound">A</a><a id="9847" class="Symbol">}</a> <a id="9849" class="Symbol">=</a> <a id="9851" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="9866" class="Symbol">λ</a> <a id="9868" href="/Substitution/#9868" class="Bound">x</a> <a id="9870" class="Symbol">→</a> <a id="9872" href="/Substitution/#9892" class="Function">lemma</a> <a id="9878" class="Symbol">{</a><a id="9879" href="/Substitution/#9868" class="Bound">x</a><a id="9880" class="Symbol">}</a>
  <a id="9884" class="Keyword">where</a>
  <a id="9892" href="/Substitution/#9892" class="Function">lemma</a> <a id="9898" class="Symbol">:</a> <a id="9900" class="Symbol">∀{</a><a id="9902" href="/Substitution/#9902" class="Bound">x</a> <a id="9904" class="Symbol">:</a> <a id="9906" href="/Substitution/#9826" class="Bound">Γ</a> <a id="9908" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="9910" href="/Substitution/#9839" class="Bound">B</a> <a id="9912" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="9914" href="/Substitution/#9846" class="Bound">A</a><a id="9915" class="Symbol">}</a> <a id="9917" class="Symbol">→</a> <a id="9919" href="/Untyped/#5845" class="Function">ext</a> <a id="9923" href="/Substitution/#9832" class="Bound">ρ</a> <a id="9925" href="/Substitution/#9902" class="Bound">x</a> <a id="9927" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9929" href="/Untyped/#5845" class="Function">ext</a> <a id="9933" href="/Substitution/#9835" class="Bound">ρ′</a> <a id="9936" href="/Substitution/#9902" class="Bound">x</a>
  <a id="9940" href="/Substitution/#9892" class="Function">lemma</a> <a id="9946" class="Symbol">{</a><a id="9947" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="9948" class="Symbol">}</a> <a id="9950" class="Symbol">=</a> <a id="9952" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="9959" href="/Substitution/#9892" class="Function">lemma</a> <a id="9965" class="Symbol">{</a><a id="9966" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="9968" href="/Substitution/#9968" class="Bound">y</a><a id="9969" class="Symbol">}</a> <a id="9971" class="Symbol">=</a> <a id="9973" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="9978" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="9981" class="Symbol">(</a><a id="9982" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="9991" href="/Substitution/#9842" class="Bound">rr</a> <a id="9994" href="/Substitution/#9968" class="Bound">y</a><a id="9995" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-rename"></a><a id="10022" href="/Substitution/#10022" class="Function">cong-rename</a> <a id="10034" class="Symbol">:</a> <a id="10036" class="Symbol">∀{</a><a id="10038" href="/Substitution/#10038" class="Bound">Γ</a> <a id="10040" href="/Substitution/#10040" class="Bound">Δ</a><a id="10041" class="Symbol">}{</a><a id="10043" href="/Substitution/#10043" class="Bound">ρ</a> <a id="10045" href="/Substitution/#10045" class="Bound">ρ′</a> <a id="10048" class="Symbol">:</a> <a id="10050" href="/Denotational/#23035" class="Function">Rename</a> <a id="10057" href="/Substitution/#10038" class="Bound">Γ</a> <a id="10059" href="/Substitution/#10040" class="Bound">Δ</a><a id="10060" class="Symbol">}{</a><a id="10062" href="/Substitution/#10062" class="Bound">B</a><a id="10063" class="Symbol">}{</a><a id="10065" href="/Substitution/#10065" class="Bound">M</a> <a id="10067" href="/Substitution/#10067" class="Bound">M′</a> <a id="10070" class="Symbol">:</a> <a id="10072" href="/Substitution/#10038" class="Bound">Γ</a> <a id="10074" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="10076" href="/Substitution/#10062" class="Bound">B</a><a id="10077" class="Symbol">}</a>
        <a id="10087" class="Symbol">→</a> <a id="10089" class="Symbol">(∀{</a><a id="10092" href="/Substitution/#10092" class="Bound">A</a><a id="10093" class="Symbol">}</a> <a id="10095" class="Symbol">→</a> <a id="10097" href="/Substitution/#10043" class="Bound">ρ</a> <a id="10099" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10101" href="/Substitution/#10045" class="Bound">ρ′</a> <a id="10104" class="Symbol">{</a><a id="10105" href="/Substitution/#10092" class="Bound">A</a><a id="10106" class="Symbol">})</a>  <a id="10110" class="Symbol">→</a>  <a id="10113" href="/Substitution/#10065" class="Bound">M</a> <a id="10115" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10117" href="/Substitution/#10067" class="Bound">M′</a>
          <a id="10130" class="Comment">------------------------------</a>
        <a id="10169" class="Symbol">→</a> <a id="10171" href="/Untyped/#6171" class="Function">rename</a> <a id="10178" href="/Substitution/#10043" class="Bound">ρ</a> <a id="10180" href="/Substitution/#10065" class="Bound">M</a> <a id="10182" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10184" href="/Untyped/#6171" class="Function">rename</a> <a id="10191" href="/Substitution/#10045" class="Bound">ρ′</a> <a id="10194" href="/Substitution/#10065" class="Bound">M</a>
<a id="10196" href="/Substitution/#10022" class="Function">cong-rename</a> <a id="10208" class="Symbol">{</a><a id="10209" class="Argument">M</a> <a id="10211" class="Symbol">=</a> <a id="10213" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="10215" href="/Substitution/#10215" class="Bound">x</a><a id="10216" class="Symbol">}</a> <a id="10218" href="/Substitution/#10218" class="Bound">rr</a> <a id="10221" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="10226" class="Symbol">=</a> <a id="10228" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="10233" href="/Untyped/#4186" class="InductiveConstructor Operator">`_</a> <a id="10236" class="Symbol">(</a><a id="10237" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="10246" href="/Substitution/#10218" class="Bound">rr</a> <a id="10249" href="/Substitution/#10215" class="Bound">x</a><a id="10250" class="Symbol">)</a>
<a id="10252" href="/Substitution/#10022" class="Function">cong-rename</a> <a id="10264" class="Symbol">{</a><a id="10265" class="Argument">ρ</a> <a id="10267" class="Symbol">=</a> <a id="10269" href="/Substitution/#10269" class="Bound">ρ</a><a id="10270" class="Symbol">}</a> <a id="10272" class="Symbol">{</a><a id="10273" class="Argument">ρ′</a> <a id="10276" class="Symbol">=</a> <a id="10278" href="/Substitution/#10278" class="Bound">ρ′</a><a id="10280" class="Symbol">}</a> <a id="10282" class="Symbol">{</a><a id="10283" class="Argument">M</a> <a id="10285" class="Symbol">=</a> <a id="10287" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="10289" href="/Substitution/#10289" class="Bound">N</a><a id="10290" class="Symbol">}</a> <a id="10292" href="/Substitution/#10292" class="Bound">rr</a> <a id="10295" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="10300" class="Symbol">=</a>
   <a id="10305" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="10310" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="10313" class="Symbol">(</a><a id="10314" href="/Substitution/#10022" class="Function">cong-rename</a> <a id="10326" class="Symbol">{</a><a id="10327" class="Argument">ρ</a> <a id="10329" class="Symbol">=</a> <a id="10331" href="/Untyped/#5845" class="Function">ext</a> <a id="10335" href="/Substitution/#10269" class="Bound">ρ</a><a id="10336" class="Symbol">}{</a><a id="10338" class="Argument">ρ′</a> <a id="10341" class="Symbol">=</a> <a id="10343" href="/Untyped/#5845" class="Function">ext</a> <a id="10347" href="/Substitution/#10278" class="Bound">ρ′</a><a id="10349" class="Symbol">}{</a><a id="10351" class="Argument">M</a> <a id="10353" class="Symbol">=</a> <a id="10355" href="/Substitution/#10289" class="Bound">N</a><a id="10356" class="Symbol">}</a> <a id="10358" class="Symbol">(</a><a id="10359" href="/Substitution/#9674" class="Function">cong-ext</a> <a id="10368" href="/Substitution/#10292" class="Bound">rr</a><a id="10370" class="Symbol">)</a> <a id="10372" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="10376" class="Symbol">)</a>
<a id="10378" href="/Substitution/#10022" class="Function">cong-rename</a> <a id="10390" class="Symbol">{</a><a id="10391" class="Argument">M</a> <a id="10393" class="Symbol">=</a> <a id="10395" href="/Substitution/#10395" class="Bound">L</a> <a id="10397" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="10399" href="/Substitution/#10399" class="Bound">M</a><a id="10400" class="Symbol">}</a> <a id="10402" href="/Substitution/#10402" class="Bound">rr</a> <a id="10405" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="10410" class="Symbol">=</a>
   <a id="10415" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="10421" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="10425" class="Symbol">(</a><a id="10426" href="/Substitution/#10022" class="Function">cong-rename</a> <a id="10438" href="/Substitution/#10402" class="Bound">rr</a> <a id="10441" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="10445" class="Symbol">)</a> <a id="10447" class="Symbol">(</a><a id="10448" href="/Substitution/#10022" class="Function">cong-rename</a> <a id="10460" href="/Substitution/#10402" class="Bound">rr</a> <a id="10463" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="10467" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-exts"></a><a id="10494" href="/Substitution/#10494" class="Function">cong-exts</a> <a id="10504" class="Symbol">:</a> <a id="10506" class="Symbol">∀{</a><a id="10508" href="/Substitution/#10508" class="Bound">Γ</a> <a id="10510" href="/Substitution/#10510" class="Bound">Δ</a><a id="10511" class="Symbol">}{</a><a id="10513" href="/Substitution/#10513" class="Bound">σ</a> <a id="10515" href="/Substitution/#10515" class="Bound">σ′</a> <a id="10518" class="Symbol">:</a> <a id="10520" href="/Soundness/#2673" class="Function">Subst</a> <a id="10526" href="/Substitution/#10508" class="Bound">Γ</a> <a id="10528" href="/Substitution/#10510" class="Bound">Δ</a><a id="10529" class="Symbol">}{</a><a id="10531" href="/Substitution/#10531" class="Bound">B</a><a id="10532" class="Symbol">}</a>
   <a id="10537" class="Symbol">→</a> <a id="10539" class="Symbol">(∀{</a><a id="10542" href="/Substitution/#10542" class="Bound">A</a><a id="10543" class="Symbol">}</a> <a id="10545" class="Symbol">→</a> <a id="10547" href="/Substitution/#10513" class="Bound">σ</a> <a id="10549" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10551" href="/Substitution/#10515" class="Bound">σ′</a> <a id="10554" class="Symbol">{</a><a id="10555" href="/Substitution/#10542" class="Bound">A</a><a id="10556" class="Symbol">})</a>
     <a id="10564" class="Comment">-----------------------------------</a>
   <a id="10603" class="Symbol">→</a> <a id="10605" class="Symbol">∀{</a><a id="10607" href="/Substitution/#10607" class="Bound">A</a><a id="10608" class="Symbol">}</a> <a id="10610" class="Symbol">→</a> <a id="10612" href="/Untyped/#6623" class="Function">exts</a> <a id="10617" href="/Substitution/#10513" class="Bound">σ</a> <a id="10619" class="Symbol">{</a><a id="10620" class="Argument">B</a> <a id="10622" class="Symbol">=</a> <a id="10624" href="/Substitution/#10531" class="Bound">B</a><a id="10625" class="Symbol">}</a> <a id="10627" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10629" href="/Untyped/#6623" class="Function">exts</a> <a id="10634" href="/Substitution/#10515" class="Bound">σ′</a> <a id="10637" class="Symbol">{</a><a id="10638" href="/Substitution/#10607" class="Bound">A</a><a id="10639" class="Symbol">}</a>
<a id="10641" href="/Substitution/#10494" class="Function">cong-exts</a><a id="10650" class="Symbol">{</a><a id="10651" href="/Substitution/#10651" class="Bound">Γ</a><a id="10652" class="Symbol">}{</a><a id="10654" href="/Substitution/#10654" class="Bound">Δ</a><a id="10655" class="Symbol">}{</a><a id="10657" href="/Substitution/#10657" class="Bound">σ</a><a id="10658" class="Symbol">}{</a><a id="10660" href="/Substitution/#10660" class="Bound">σ′</a><a id="10662" class="Symbol">}{</a><a id="10664" href="/Substitution/#10664" class="Bound">B</a><a id="10665" class="Symbol">}</a> <a id="10667" href="/Substitution/#10667" class="Bound">ss</a> <a id="10670" class="Symbol">{</a><a id="10671" href="/Substitution/#10671" class="Bound">A</a><a id="10672" class="Symbol">}</a> <a id="10674" class="Symbol">=</a> <a id="10676" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="10691" class="Symbol">λ</a> <a id="10693" href="/Substitution/#10693" class="Bound">x</a> <a id="10695" class="Symbol">→</a> <a id="10697" href="/Substitution/#10719" class="Function">lemma</a> <a id="10703" class="Symbol">{</a><a id="10704" href="/Substitution/#10693" class="Bound">x</a><a id="10705" class="Symbol">}</a>
   <a id="10710" class="Keyword">where</a>
   <a id="10719" href="/Substitution/#10719" class="Function">lemma</a> <a id="10725" class="Symbol">:</a> <a id="10727" class="Symbol">∀{</a><a id="10729" href="/Substitution/#10729" class="Bound">x</a><a id="10730" class="Symbol">}</a> <a id="10732" class="Symbol">→</a> <a id="10734" href="/Untyped/#6623" class="Function">exts</a> <a id="10739" href="/Substitution/#10657" class="Bound">σ</a> <a id="10741" href="/Substitution/#10729" class="Bound">x</a> <a id="10743" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10745" href="/Untyped/#6623" class="Function">exts</a> <a id="10750" href="/Substitution/#10660" class="Bound">σ′</a> <a id="10753" href="/Substitution/#10729" class="Bound">x</a>
   <a id="10758" href="/Substitution/#10719" class="Function">lemma</a> <a id="10764" class="Symbol">{</a><a id="10765" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="10766" class="Symbol">}</a> <a id="10768" class="Symbol">=</a> <a id="10770" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="10778" href="/Substitution/#10719" class="Function">lemma</a> <a id="10784" class="Symbol">{</a><a id="10785" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="10787" href="/Substitution/#10787" class="Bound">x</a><a id="10788" class="Symbol">}</a> <a id="10790" class="Symbol">=</a> <a id="10792" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="10797" class="Symbol">(</a><a id="10798" href="/Untyped/#6171" class="Function">rename</a> <a id="10805" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="10807" class="Symbol">)</a> <a id="10809" class="Symbol">(</a><a id="10810" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="10819" class="Symbol">(</a><a id="10820" href="/Substitution/#10667" class="Bound">ss</a> <a id="10823" class="Symbol">{</a><a id="10824" href="/Substitution/#10671" class="Bound">A</a><a id="10825" class="Symbol">})</a> <a id="10828" href="/Substitution/#10787" class="Bound">x</a><a id="10829" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-sub"></a><a id="10856" href="/Substitution/#10856" class="Function">cong-sub</a> <a id="10865" class="Symbol">:</a> <a id="10867" class="Symbol">∀{</a><a id="10869" href="/Substitution/#10869" class="Bound">Γ</a> <a id="10871" href="/Substitution/#10871" class="Bound">Δ</a><a id="10872" class="Symbol">}{</a><a id="10874" href="/Substitution/#10874" class="Bound">σ</a> <a id="10876" href="/Substitution/#10876" class="Bound">σ′</a> <a id="10879" class="Symbol">:</a> <a id="10881" href="/Soundness/#2673" class="Function">Subst</a> <a id="10887" href="/Substitution/#10869" class="Bound">Γ</a> <a id="10889" href="/Substitution/#10871" class="Bound">Δ</a><a id="10890" class="Symbol">}{</a><a id="10892" href="/Substitution/#10892" class="Bound">A</a><a id="10893" class="Symbol">}{</a><a id="10895" href="/Substitution/#10895" class="Bound">M</a> <a id="10897" href="/Substitution/#10897" class="Bound">M′</a> <a id="10900" class="Symbol">:</a> <a id="10902" href="/Substitution/#10869" class="Bound">Γ</a> <a id="10904" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="10906" href="/Substitution/#10892" class="Bound">A</a><a id="10907" class="Symbol">}</a>
            <a id="10921" class="Symbol">→</a> <a id="10923" class="Symbol">(∀{</a><a id="10926" href="/Substitution/#10926" class="Bound">A</a><a id="10927" class="Symbol">}</a> <a id="10929" class="Symbol">→</a> <a id="10931" href="/Substitution/#10874" class="Bound">σ</a> <a id="10933" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10935" href="/Substitution/#10876" class="Bound">σ′</a> <a id="10938" class="Symbol">{</a><a id="10939" href="/Substitution/#10926" class="Bound">A</a><a id="10940" class="Symbol">})</a>  <a id="10944" class="Symbol">→</a>  <a id="10947" href="/Substitution/#10895" class="Bound">M</a> <a id="10949" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10951" href="/Substitution/#10897" class="Bound">M′</a>
              <a id="10968" class="Comment">------------------------------</a>
            <a id="11011" class="Symbol">→</a> <a id="11013" href="/Untyped/#6931" class="Function">subst</a> <a id="11019" href="/Substitution/#10874" class="Bound">σ</a> <a id="11021" href="/Substitution/#10895" class="Bound">M</a> <a id="11023" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11025" href="/Untyped/#6931" class="Function">subst</a> <a id="11031" href="/Substitution/#10876" class="Bound">σ′</a> <a id="11034" href="/Substitution/#10897" class="Bound">M′</a>
<a id="11037" href="/Substitution/#10856" class="Function">cong-sub</a> <a id="11046" class="Symbol">{</a><a id="11047" href="/Substitution/#11047" class="Bound">Γ</a><a id="11048" class="Symbol">}</a> <a id="11050" class="Symbol">{</a><a id="11051" href="/Substitution/#11051" class="Bound">Δ</a><a id="11052" class="Symbol">}</a> <a id="11054" class="Symbol">{</a><a id="11055" href="/Substitution/#11055" class="Bound">σ</a><a id="11056" class="Symbol">}</a> <a id="11058" class="Symbol">{</a><a id="11059" href="/Substitution/#11059" class="Bound">σ′</a><a id="11061" class="Symbol">}</a> <a id="11063" class="Symbol">{</a><a id="11064" href="/Substitution/#11064" class="Bound">A</a><a id="11065" class="Symbol">}</a> <a id="11067" class="Symbol">{</a><a id="11068" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="11070" href="/Substitution/#11070" class="Bound">x</a><a id="11071" class="Symbol">}</a> <a id="11073" href="/Substitution/#11073" class="Bound">ss</a> <a id="11076" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="11081" class="Symbol">=</a> <a id="11083" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="11092" href="/Substitution/#11073" class="Bound">ss</a> <a id="11095" href="/Substitution/#11070" class="Bound">x</a>
<a id="11097" href="/Substitution/#10856" class="Function">cong-sub</a> <a id="11106" class="Symbol">{</a><a id="11107" href="/Substitution/#11107" class="Bound">Γ</a><a id="11108" class="Symbol">}</a> <a id="11110" class="Symbol">{</a><a id="11111" href="/Substitution/#11111" class="Bound">Δ</a><a id="11112" class="Symbol">}</a> <a id="11114" class="Symbol">{</a><a id="11115" href="/Substitution/#11115" class="Bound">σ</a><a id="11116" class="Symbol">}</a> <a id="11118" class="Symbol">{</a><a id="11119" href="/Substitution/#11119" class="Bound">σ′</a><a id="11121" class="Symbol">}</a> <a id="11123" class="Symbol">{</a><a id="11124" href="/Substitution/#11124" class="Bound">A</a><a id="11125" class="Symbol">}</a> <a id="11127" class="Symbol">{</a><a id="11128" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="11130" href="/Substitution/#11130" class="Bound">M</a><a id="11131" class="Symbol">}</a> <a id="11133" href="/Substitution/#11133" class="Bound">ss</a> <a id="11136" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="11141" class="Symbol">=</a>
   <a id="11146" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="11151" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="11154" class="Symbol">(</a><a id="11155" href="/Substitution/#10856" class="Function">cong-sub</a> <a id="11164" class="Symbol">{</a><a id="11165" class="Argument">σ</a> <a id="11167" class="Symbol">=</a> <a id="11169" href="/Untyped/#6623" class="Function">exts</a> <a id="11174" href="/Substitution/#11115" class="Bound">σ</a><a id="11175" class="Symbol">}{</a><a id="11177" class="Argument">σ′</a> <a id="11180" class="Symbol">=</a> <a id="11182" href="/Untyped/#6623" class="Function">exts</a> <a id="11187" href="/Substitution/#11119" class="Bound">σ′</a><a id="11189" class="Symbol">}</a> <a id="11191" class="Symbol">{</a><a id="11192" class="Argument">M</a> <a id="11194" class="Symbol">=</a> <a id="11196" href="/Substitution/#11130" class="Bound">M</a><a id="11197" class="Symbol">}</a> <a id="11199" class="Symbol">(</a><a id="11200" href="/Substitution/#10494" class="Function">cong-exts</a> <a id="11210" href="/Substitution/#11133" class="Bound">ss</a><a id="11212" class="Symbol">)</a> <a id="11214" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="11218" class="Symbol">)</a>
<a id="11220" href="/Substitution/#10856" class="Function">cong-sub</a> <a id="11229" class="Symbol">{</a><a id="11230" href="/Substitution/#11230" class="Bound">Γ</a><a id="11231" class="Symbol">}</a> <a id="11233" class="Symbol">{</a><a id="11234" href="/Substitution/#11234" class="Bound">Δ</a><a id="11235" class="Symbol">}</a> <a id="11237" class="Symbol">{</a><a id="11238" href="/Substitution/#11238" class="Bound">σ</a><a id="11239" class="Symbol">}</a> <a id="11241" class="Symbol">{</a><a id="11242" href="/Substitution/#11242" class="Bound">σ′</a><a id="11244" class="Symbol">}</a> <a id="11246" class="Symbol">{</a><a id="11247" href="/Substitution/#11247" class="Bound">A</a><a id="11248" class="Symbol">}</a> <a id="11250" class="Symbol">{</a><a id="11251" href="/Substitution/#11251" class="Bound">L</a> <a id="11253" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="11255" href="/Substitution/#11255" class="Bound">M</a><a id="11256" class="Symbol">}</a> <a id="11258" href="/Substitution/#11258" class="Bound">ss</a> <a id="11261" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="11266" class="Symbol">=</a> 
   <a id="11272" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="11278" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="11282" class="Symbol">(</a><a id="11283" href="/Substitution/#10856" class="Function">cong-sub</a> <a id="11292" class="Symbol">{</a><a id="11293" class="Argument">M</a> <a id="11295" class="Symbol">=</a> <a id="11297" href="/Substitution/#11251" class="Bound">L</a><a id="11298" class="Symbol">}</a> <a id="11300" href="/Substitution/#11258" class="Bound">ss</a> <a id="11303" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="11307" class="Symbol">)</a> <a id="11309" class="Symbol">(</a><a id="11310" href="/Substitution/#10856" class="Function">cong-sub</a> <a id="11319" class="Symbol">{</a><a id="11320" class="Argument">M</a> <a id="11322" class="Symbol">=</a> <a id="11324" href="/Substitution/#11255" class="Bound">M</a><a id="11325" class="Symbol">}</a> <a id="11327" href="/Substitution/#11258" class="Bound">ss</a> <a id="11330" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="11334" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-sub-zero"></a><a id="11361" href="/Substitution/#11361" class="Function">cong-sub-zero</a> <a id="11375" class="Symbol">:</a> <a id="11377" class="Symbol">∀{</a><a id="11379" href="/Substitution/#11379" class="Bound">Γ</a><a id="11380" class="Symbol">}{</a><a id="11382" href="/Substitution/#11382" class="Bound">B</a> <a id="11384" class="Symbol">:</a> <a id="11386" href="/Untyped/#2675" class="Datatype">Type</a><a id="11390" class="Symbol">}{</a><a id="11392" href="/Substitution/#11392" class="Bound">M</a> <a id="11394" href="/Substitution/#11394" class="Bound">M′</a> <a id="11397" class="Symbol">:</a> <a id="11399" href="/Substitution/#11379" class="Bound">Γ</a> <a id="11401" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="11403" href="/Substitution/#11382" class="Bound">B</a><a id="11404" class="Symbol">}</a>
  <a id="11408" class="Symbol">→</a> <a id="11410" href="/Substitution/#11392" class="Bound">M</a> <a id="11412" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11414" href="/Substitution/#11394" class="Bound">M′</a>
    <a id="11421" class="Comment">-----------------------------------------</a>
  <a id="11465" class="Symbol">→</a> <a id="11467" class="Symbol">∀{</a><a id="11469" href="/Substitution/#11469" class="Bound">A</a><a id="11470" class="Symbol">}</a> <a id="11472" class="Symbol">→</a> <a id="11474" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="11485" href="/Substitution/#11392" class="Bound">M</a> <a id="11487" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11489" class="Symbol">(</a><a id="11490" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="11501" href="/Substitution/#11394" class="Bound">M′</a><a id="11503" class="Symbol">)</a> <a id="11505" class="Symbol">{</a><a id="11506" href="/Substitution/#11469" class="Bound">A</a><a id="11507" class="Symbol">}</a>
<a id="11509" href="/Substitution/#11361" class="Function">cong-sub-zero</a> <a id="11523" class="Symbol">{</a><a id="11524" href="/Substitution/#11524" class="Bound">Γ</a><a id="11525" class="Symbol">}{</a><a id="11527" href="/Substitution/#11527" class="Bound">B</a><a id="11528" class="Symbol">}{</a><a id="11530" href="/Substitution/#11530" class="Bound">M</a><a id="11531" class="Symbol">}{</a><a id="11533" href="/Substitution/#11533" class="Bound">M′</a><a id="11535" class="Symbol">}</a> <a id="11537" href="/Substitution/#11537" class="Bound">mm&#39;</a> <a id="11541" class="Symbol">{</a><a id="11542" href="/Substitution/#11542" class="Bound">A</a><a id="11543" class="Symbol">}</a> <a id="11545" class="Symbol">=</a>
   <a id="11550" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="11565" class="Symbol">λ</a> <a id="11567" href="/Substitution/#11567" class="Bound">x</a> <a id="11569" class="Symbol">→</a> <a id="11571" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="11576" class="Symbol">(λ</a> <a id="11579" href="/Substitution/#11579" class="Bound">z</a> <a id="11581" class="Symbol">→</a> <a id="11583" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="11594" href="/Substitution/#11579" class="Bound">z</a> <a id="11596" href="/Substitution/#11567" class="Bound">x</a><a id="11597" class="Symbol">)</a> <a id="11599" href="/Substitution/#11537" class="Bound">mm&#39;</a></pre>

<pre class="Agda"><a id="cong-cons"></a><a id="11628" href="/Substitution/#11628" class="Function">cong-cons</a> <a id="11638" class="Symbol">:</a> <a id="11640" class="Symbol">∀{</a><a id="11642" href="/Substitution/#11642" class="Bound">Γ</a> <a id="11644" href="/Substitution/#11644" class="Bound">Δ</a><a id="11645" class="Symbol">}{</a><a id="11647" href="/Substitution/#11647" class="Bound">A</a><a id="11648" class="Symbol">}{</a><a id="11650" href="/Substitution/#11650" class="Bound">M</a> <a id="11652" href="/Substitution/#11652" class="Bound">N</a> <a id="11654" class="Symbol">:</a> <a id="11656" href="/Substitution/#11644" class="Bound">Δ</a> <a id="11658" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="11660" href="/Substitution/#11647" class="Bound">A</a><a id="11661" class="Symbol">}{</a><a id="11663" href="/Substitution/#11663" class="Bound">σ</a> <a id="11665" href="/Substitution/#11665" class="Bound">τ</a> <a id="11667" class="Symbol">:</a> <a id="11669" href="/Soundness/#2673" class="Function">Subst</a> <a id="11675" href="/Substitution/#11642" class="Bound">Γ</a> <a id="11677" href="/Substitution/#11644" class="Bound">Δ</a><a id="11678" class="Symbol">}</a>
  <a id="11682" class="Symbol">→</a> <a id="11684" href="/Substitution/#11650" class="Bound">M</a> <a id="11686" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11688" href="/Substitution/#11652" class="Bound">N</a>  <a id="11691" class="Symbol">→</a>  <a id="11694" class="Symbol">(∀{</a><a id="11697" href="/Substitution/#11697" class="Bound">A</a><a id="11698" class="Symbol">}</a> <a id="11700" class="Symbol">→</a> <a id="11702" href="/Substitution/#11663" class="Bound">σ</a> <a id="11704" class="Symbol">{</a><a id="11705" href="/Substitution/#11697" class="Bound">A</a><a id="11706" class="Symbol">}</a> <a id="11708" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11710" href="/Substitution/#11665" class="Bound">τ</a> <a id="11712" class="Symbol">{</a><a id="11713" href="/Substitution/#11697" class="Bound">A</a><a id="11714" class="Symbol">})</a>
    <a id="11721" class="Comment">--------------------------------</a>
  <a id="11756" class="Symbol">→</a> <a id="11758" class="Symbol">∀{</a><a id="11760" href="/Substitution/#11760" class="Bound">A</a><a id="11761" class="Symbol">}</a> <a id="11763" class="Symbol">→</a> <a id="11765" class="Symbol">(</a><a id="11766" href="/Substitution/#11650" class="Bound">M</a> <a id="11768" href="/Substitution/#3004" class="Function Operator">•</a> <a id="11770" href="/Substitution/#11663" class="Bound">σ</a><a id="11771" class="Symbol">)</a> <a id="11773" class="Symbol">{</a><a id="11774" href="/Substitution/#11760" class="Bound">A</a><a id="11775" class="Symbol">}</a> <a id="11777" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11779" class="Symbol">(</a><a id="11780" href="/Substitution/#11652" class="Bound">N</a> <a id="11782" href="/Substitution/#3004" class="Function Operator">•</a> <a id="11784" href="/Substitution/#11665" class="Bound">τ</a><a id="11785" class="Symbol">)</a> <a id="11787" class="Symbol">{</a><a id="11788" href="/Substitution/#11760" class="Bound">A</a><a id="11789" class="Symbol">}</a>
<a id="11791" href="/Substitution/#11628" class="Function">cong-cons</a><a id="11800" class="Symbol">{</a><a id="11801" href="/Substitution/#11801" class="Bound">Γ</a><a id="11802" class="Symbol">}{</a><a id="11804" href="/Substitution/#11804" class="Bound">Δ</a><a id="11805" class="Symbol">}{</a><a id="11807" href="/Substitution/#11807" class="Bound">A</a><a id="11808" class="Symbol">}{</a><a id="11810" href="/Substitution/#11810" class="Bound">M</a><a id="11811" class="Symbol">}{</a><a id="11813" href="/Substitution/#11813" class="Bound">N</a><a id="11814" class="Symbol">}{</a><a id="11816" href="/Substitution/#11816" class="Bound">σ</a><a id="11817" class="Symbol">}{</a><a id="11819" href="/Substitution/#11819" class="Bound">τ</a><a id="11820" class="Symbol">}</a> <a id="11822" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="11827" href="/Substitution/#11827" class="Bound">st</a> <a id="11830" class="Symbol">{</a><a id="11831" href="/Substitution/#11831" class="Bound">A′</a><a id="11833" class="Symbol">}</a> <a id="11835" class="Symbol">=</a> <a id="11837" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="11852" href="/Substitution/#11868" class="Function">lemma</a>
  <a id="11860" class="Keyword">where</a>
  <a id="11868" href="/Substitution/#11868" class="Function">lemma</a> <a id="11874" class="Symbol">:</a> <a id="11876" class="Symbol">(</a><a id="11877" href="/Substitution/#11877" class="Bound">x</a> <a id="11879" class="Symbol">:</a> <a id="11881" href="/Substitution/#11801" class="Bound">Γ</a> <a id="11883" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="11885" href="/Substitution/#11807" class="Bound">A</a> <a id="11887" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="11889" href="/Substitution/#11831" class="Bound">A′</a><a id="11891" class="Symbol">)</a> <a id="11893" class="Symbol">→</a> <a id="11895" class="Symbol">(</a><a id="11896" href="/Substitution/#11810" class="Bound">M</a> <a id="11898" href="/Substitution/#3004" class="Function Operator">•</a> <a id="11900" href="/Substitution/#11816" class="Bound">σ</a><a id="11901" class="Symbol">)</a> <a id="11903" href="/Substitution/#11877" class="Bound">x</a> <a id="11905" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11907" class="Symbol">(</a><a id="11908" href="/Substitution/#11810" class="Bound">M</a> <a id="11910" href="/Substitution/#3004" class="Function Operator">•</a> <a id="11912" href="/Substitution/#11819" class="Bound">τ</a><a id="11913" class="Symbol">)</a> <a id="11915" href="/Substitution/#11877" class="Bound">x</a>
  <a id="11919" href="/Substitution/#11868" class="Function">lemma</a> <a id="11925" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="11927" class="Symbol">=</a> <a id="11929" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="11936" href="/Substitution/#11868" class="Function">lemma</a> <a id="11942" class="Symbol">(</a><a id="11943" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="11945" href="/Substitution/#11945" class="Bound">x</a><a id="11946" class="Symbol">)</a> <a id="11948" class="Symbol">=</a> <a id="11950" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="11959" href="/Substitution/#11827" class="Bound">st</a> <a id="11962" href="/Substitution/#11945" class="Bound">x</a></pre>

<pre class="Agda"><a id="cong-seq"></a><a id="11989" href="/Substitution/#11989" class="Function">cong-seq</a> <a id="11998" class="Symbol">:</a> <a id="12000" class="Symbol">∀{</a><a id="12002" href="/Substitution/#12002" class="Bound">Γ</a> <a id="12004" href="/Substitution/#12004" class="Bound">Δ</a> <a id="12006" href="/Substitution/#12006" class="Bound">Σ</a><a id="12007" class="Symbol">}{</a><a id="12009" href="/Substitution/#12009" class="Bound">σ</a> <a id="12011" href="/Substitution/#12011" class="Bound">σ′</a> <a id="12014" class="Symbol">:</a> <a id="12016" href="/Soundness/#2673" class="Function">Subst</a> <a id="12022" href="/Substitution/#12002" class="Bound">Γ</a> <a id="12024" href="/Substitution/#12004" class="Bound">Δ</a><a id="12025" class="Symbol">}{</a><a id="12027" href="/Substitution/#12027" class="Bound">τ</a> <a id="12029" href="/Substitution/#12029" class="Bound">τ′</a> <a id="12032" class="Symbol">:</a> <a id="12034" href="/Soundness/#2673" class="Function">Subst</a> <a id="12040" href="/Substitution/#12004" class="Bound">Δ</a> <a id="12042" href="/Substitution/#12006" class="Bound">Σ</a><a id="12043" class="Symbol">}</a>
  <a id="12047" class="Symbol">→</a> <a id="12049" class="Symbol">(∀{</a><a id="12052" href="/Substitution/#12052" class="Bound">A</a><a id="12053" class="Symbol">}</a> <a id="12055" class="Symbol">→</a> <a id="12057" href="/Substitution/#12009" class="Bound">σ</a> <a id="12059" class="Symbol">{</a><a id="12060" href="/Substitution/#12052" class="Bound">A</a><a id="12061" class="Symbol">}</a> <a id="12063" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12065" href="/Substitution/#12011" class="Bound">σ′</a> <a id="12068" class="Symbol">{</a><a id="12069" href="/Substitution/#12052" class="Bound">A</a><a id="12070" class="Symbol">})</a> <a id="12073" class="Symbol">→</a> <a id="12075" class="Symbol">(∀{</a><a id="12078" href="/Substitution/#12078" class="Bound">A</a><a id="12079" class="Symbol">}</a> <a id="12081" class="Symbol">→</a> <a id="12083" href="/Substitution/#12027" class="Bound">τ</a> <a id="12085" class="Symbol">{</a><a id="12086" href="/Substitution/#12078" class="Bound">A</a><a id="12087" class="Symbol">}</a> <a id="12089" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12091" href="/Substitution/#12029" class="Bound">τ′</a> <a id="12094" class="Symbol">{</a><a id="12095" href="/Substitution/#12078" class="Bound">A</a><a id="12096" class="Symbol">})</a>
  <a id="12101" class="Symbol">→</a> <a id="12103" class="Symbol">∀{</a><a id="12105" href="/Substitution/#12105" class="Bound">A</a><a id="12106" class="Symbol">}</a> <a id="12108" class="Symbol">→</a> <a id="12110" class="Symbol">(</a><a id="12111" href="/Substitution/#12009" class="Bound">σ</a> <a id="12113" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="12115" href="/Substitution/#12027" class="Bound">τ</a><a id="12116" class="Symbol">)</a> <a id="12118" class="Symbol">{</a><a id="12119" href="/Substitution/#12105" class="Bound">A</a><a id="12120" class="Symbol">}</a> <a id="12122" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12124" class="Symbol">(</a><a id="12125" href="/Substitution/#12011" class="Bound">σ′</a> <a id="12128" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="12130" href="/Substitution/#12029" class="Bound">τ′</a><a id="12132" class="Symbol">)</a> <a id="12134" class="Symbol">{</a><a id="12135" href="/Substitution/#12105" class="Bound">A</a><a id="12136" class="Symbol">}</a>
<a id="12138" href="/Substitution/#11989" class="Function">cong-seq</a> <a id="12147" class="Symbol">{</a><a id="12148" href="/Substitution/#12148" class="Bound">Γ</a><a id="12149" class="Symbol">}{</a><a id="12151" href="/Substitution/#12151" class="Bound">Δ</a><a id="12152" class="Symbol">}{</a><a id="12154" href="/Substitution/#12154" class="Bound">Σ</a><a id="12155" class="Symbol">}{</a><a id="12157" href="/Substitution/#12157" class="Bound">σ</a><a id="12158" class="Symbol">}{</a><a id="12160" href="/Substitution/#12160" class="Bound">σ′</a><a id="12162" class="Symbol">}{</a><a id="12164" href="/Substitution/#12164" class="Bound">τ</a><a id="12165" class="Symbol">}{</a><a id="12167" href="/Substitution/#12167" class="Bound">τ′</a><a id="12169" class="Symbol">}</a> <a id="12171" href="/Substitution/#12171" class="Bound">ss&#39;</a> <a id="12175" href="/Substitution/#12175" class="Bound">tt&#39;</a> <a id="12179" class="Symbol">{</a><a id="12180" href="/Substitution/#12180" class="Bound">A</a><a id="12181" class="Symbol">}</a> <a id="12183" class="Symbol">=</a> <a id="12185" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="12200" href="/Substitution/#12216" class="Function">lemma</a>
  <a id="12208" class="Keyword">where</a>
  <a id="12216" href="/Substitution/#12216" class="Function">lemma</a> <a id="12222" class="Symbol">:</a> <a id="12224" class="Symbol">(</a><a id="12225" href="/Substitution/#12225" class="Bound">x</a> <a id="12227" class="Symbol">:</a> <a id="12229" href="/Substitution/#12148" class="Bound">Γ</a> <a id="12231" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="12233" href="/Substitution/#12180" class="Bound">A</a><a id="12234" class="Symbol">)</a> <a id="12236" class="Symbol">→</a> <a id="12238" class="Symbol">(</a><a id="12239" href="/Substitution/#12157" class="Bound">σ</a> <a id="12241" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="12243" href="/Substitution/#12164" class="Bound">τ</a><a id="12244" class="Symbol">)</a> <a id="12246" href="/Substitution/#12225" class="Bound">x</a> <a id="12248" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12250" class="Symbol">(</a><a id="12251" href="/Substitution/#12160" class="Bound">σ′</a> <a id="12254" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="12256" href="/Substitution/#12167" class="Bound">τ′</a><a id="12258" class="Symbol">)</a> <a id="12260" href="/Substitution/#12225" class="Bound">x</a>
  <a id="12264" href="/Substitution/#12216" class="Function">lemma</a> <a id="12270" href="/Substitution/#12270" class="Bound">x</a> <a id="12272" class="Symbol">=</a>
     <a id="12279" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="12292" class="Symbol">(</a><a id="12293" href="/Substitution/#12157" class="Bound">σ</a> <a id="12295" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="12297" href="/Substitution/#12164" class="Bound">τ</a><a id="12298" class="Symbol">)</a> <a id="12300" href="/Substitution/#12270" class="Bound">x</a> 
     <a id="12308" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="12319" href="/Untyped/#6931" class="Function">subst</a> <a id="12325" href="/Substitution/#12164" class="Bound">τ</a> <a id="12327" class="Symbol">(</a><a id="12328" href="/Substitution/#12157" class="Bound">σ</a> <a id="12330" href="/Substitution/#12270" class="Bound">x</a><a id="12331" class="Symbol">)</a>
     <a id="12338" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="12341" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="12346" class="Symbol">(</a><a id="12347" href="/Untyped/#6931" class="Function">subst</a> <a id="12353" href="/Substitution/#12164" class="Bound">τ</a><a id="12354" class="Symbol">)</a> <a id="12356" class="Symbol">(</a><a id="12357" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="12366" href="/Substitution/#12171" class="Bound">ss&#39;</a> <a id="12370" href="/Substitution/#12270" class="Bound">x</a><a id="12371" class="Symbol">)</a> <a id="12373" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="12382" href="/Untyped/#6931" class="Function">subst</a> <a id="12388" href="/Substitution/#12164" class="Bound">τ</a> <a id="12390" class="Symbol">(</a><a id="12391" href="/Substitution/#12160" class="Bound">σ′</a> <a id="12394" href="/Substitution/#12270" class="Bound">x</a><a id="12395" class="Symbol">)</a>
     <a id="12402" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="12405" href="/Substitution/#10856" class="Function">cong-sub</a><a id="12413" class="Symbol">{</a><a id="12414" class="Argument">M</a> <a id="12416" class="Symbol">=</a> <a id="12418" href="/Substitution/#12160" class="Bound">σ′</a> <a id="12421" href="/Substitution/#12270" class="Bound">x</a><a id="12422" class="Symbol">}</a> <a id="12424" href="/Substitution/#12175" class="Bound">tt&#39;</a> <a id="12428" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="12433" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="12442" href="/Untyped/#6931" class="Function">subst</a> <a id="12448" href="/Substitution/#12167" class="Bound">τ′</a> <a id="12451" class="Symbol">(</a><a id="12452" href="/Substitution/#12160" class="Bound">σ′</a> <a id="12455" href="/Substitution/#12270" class="Bound">x</a><a id="12456" class="Symbol">)</a>
     <a id="12463" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="12474" class="Symbol">(</a><a id="12475" href="/Substitution/#12160" class="Bound">σ′</a> <a id="12478" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="12480" href="/Substitution/#12167" class="Bound">τ′</a><a id="12482" class="Symbol">)</a> <a id="12484" href="/Substitution/#12270" class="Bound">x</a>  
     <a id="12493" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="relating-rename-exts-ext-and-subst-zero-to-the-σ-algebra">Relating <code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>, <code class="highlighter-rouge">ext</code>, and <code class="highlighter-rouge">subst-zero</code> to the σ algebra</h2>

<p>In this section we establish equations that relate <code class="highlighter-rouge">subst</code> and its
helper functions (<code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>, <code class="highlighter-rouge">ext</code>, and <code class="highlighter-rouge">subst-zero</code>) to terms
in the σ algebra.</p>

<p>The first equation we prove is</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ M ≡ ⟪ ren ρ ⟫ M              (rename-subst-ren)
</code></pre></div></div>

<p>Because <code class="highlighter-rouge">subst</code> uses the <code class="highlighter-rouge">exts</code> function, we need the following lemma
which says that <code class="highlighter-rouge">exts</code> and <code class="highlighter-rouge">ext</code> do the same thing except that <code class="highlighter-rouge">ext</code>
works on renamings and <code class="highlighter-rouge">exts</code> works on substitutions.</p>

<pre class="Agda"><a id="ren-ext"></a><a id="13052" href="/Substitution/#13052" class="Function">ren-ext</a> <a id="13060" class="Symbol">:</a> <a id="13062" class="Symbol">∀</a> <a id="13064" class="Symbol">{</a><a id="13065" href="/Substitution/#13065" class="Bound">Γ</a> <a id="13067" href="/Substitution/#13067" class="Bound">Δ</a><a id="13068" class="Symbol">}{</a><a id="13070" href="/Substitution/#13070" class="Bound">B</a> <a id="13072" href="/Substitution/#13072" class="Bound">C</a> <a id="13074" class="Symbol">:</a> <a id="13076" href="/Untyped/#2675" class="Datatype">Type</a><a id="13080" class="Symbol">}</a> <a id="13082" class="Symbol">{</a><a id="13083" href="/Substitution/#13083" class="Bound">ρ</a> <a id="13085" class="Symbol">:</a> <a id="13087" href="/Denotational/#23035" class="Function">Rename</a> <a id="13094" href="/Substitution/#13065" class="Bound">Γ</a> <a id="13096" href="/Substitution/#13067" class="Bound">Δ</a><a id="13097" class="Symbol">}</a>
        <a id="13107" class="Symbol">→</a> <a id="13109" href="/Substitution/#6114" class="Function">ren</a> <a id="13113" class="Symbol">(</a><a id="13114" href="/Untyped/#5845" class="Function">ext</a> <a id="13118" href="/Substitution/#13083" class="Bound">ρ</a> <a id="13120" class="Symbol">{</a><a id="13121" class="Argument">B</a> <a id="13123" class="Symbol">=</a> <a id="13125" href="/Substitution/#13070" class="Bound">B</a><a id="13126" class="Symbol">})</a> <a id="13129" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="13131" href="/Untyped/#6623" class="Function">exts</a> <a id="13136" class="Symbol">(</a><a id="13137" href="/Substitution/#6114" class="Function">ren</a> <a id="13141" href="/Substitution/#13083" class="Bound">ρ</a><a id="13142" class="Symbol">)</a> <a id="13144" class="Symbol">{</a><a id="13145" href="/Substitution/#13072" class="Bound">C</a><a id="13146" class="Symbol">}</a>
<a id="13148" href="/Substitution/#13052" class="Function">ren-ext</a> <a id="13156" class="Symbol">{</a><a id="13157" href="/Substitution/#13157" class="Bound">Γ</a><a id="13158" class="Symbol">}{</a><a id="13160" href="/Substitution/#13160" class="Bound">Δ</a><a id="13161" class="Symbol">}{</a><a id="13163" href="/Substitution/#13163" class="Bound">B</a><a id="13164" class="Symbol">}{</a><a id="13166" href="/Substitution/#13166" class="Bound">C</a><a id="13167" class="Symbol">}{</a><a id="13169" href="/Substitution/#13169" class="Bound">ρ</a><a id="13170" class="Symbol">}</a> <a id="13172" class="Symbol">=</a> <a id="13174" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="13189" class="Symbol">λ</a> <a id="13191" href="/Substitution/#13191" class="Bound">x</a> <a id="13193" class="Symbol">→</a> <a id="13195" href="/Substitution/#13219" class="Function">lemma</a> <a id="13201" class="Symbol">{</a><a id="13202" class="Argument">x</a> <a id="13204" class="Symbol">=</a> <a id="13206" href="/Substitution/#13191" class="Bound">x</a><a id="13207" class="Symbol">}</a>
  <a id="13211" class="Keyword">where</a>
  <a id="13219" href="/Substitution/#13219" class="Function">lemma</a> <a id="13225" class="Symbol">:</a> <a id="13227" class="Symbol">∀</a> <a id="13229" class="Symbol">{</a><a id="13230" href="/Substitution/#13230" class="Bound">x</a> <a id="13232" class="Symbol">:</a> <a id="13234" href="/Substitution/#13157" class="Bound">Γ</a> <a id="13236" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="13238" href="/Substitution/#13163" class="Bound">B</a> <a id="13240" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="13242" href="/Substitution/#13166" class="Bound">C</a><a id="13243" class="Symbol">}</a> <a id="13245" class="Symbol">→</a> <a id="13247" class="Symbol">(</a><a id="13248" href="/Substitution/#6114" class="Function">ren</a> <a id="13252" class="Symbol">(</a><a id="13253" href="/Untyped/#5845" class="Function">ext</a> <a id="13257" href="/Substitution/#13169" class="Bound">ρ</a><a id="13258" class="Symbol">))</a> <a id="13261" href="/Substitution/#13230" class="Bound">x</a> <a id="13263" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="13265" href="/Untyped/#6623" class="Function">exts</a> <a id="13270" class="Symbol">(</a><a id="13271" href="/Substitution/#6114" class="Function">ren</a> <a id="13275" href="/Substitution/#13169" class="Bound">ρ</a><a id="13276" class="Symbol">)</a> <a id="13278" href="/Substitution/#13230" class="Bound">x</a>
  <a id="13282" href="/Substitution/#13219" class="Function">lemma</a> <a id="13288" class="Symbol">{</a><a id="13289" class="Argument">x</a> <a id="13291" class="Symbol">=</a> <a id="13293" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="13294" class="Symbol">}</a> <a id="13296" class="Symbol">=</a> <a id="13298" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="13305" href="/Substitution/#13219" class="Function">lemma</a> <a id="13311" class="Symbol">{</a><a id="13312" class="Argument">x</a> <a id="13314" class="Symbol">=</a> <a id="13316" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="13318" href="/Substitution/#13318" class="Bound">x</a><a id="13319" class="Symbol">}</a> <a id="13321" class="Symbol">=</a> <a id="13323" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>With this lemma in hand, the proof is a straightforward induction on
the term <code class="highlighter-rouge">M</code>.</p>

<pre class="Agda"><a id="rename-subst-ren"></a><a id="13437" href="/Substitution/#13437" class="Function">rename-subst-ren</a> <a id="13454" class="Symbol">:</a> <a id="13456" class="Symbol">∀</a> <a id="13458" class="Symbol">{</a><a id="13459" href="/Substitution/#13459" class="Bound">Γ</a> <a id="13461" href="/Substitution/#13461" class="Bound">Δ</a><a id="13462" class="Symbol">}{</a><a id="13464" href="/Substitution/#13464" class="Bound">A</a><a id="13465" class="Symbol">}</a> <a id="13467" class="Symbol">{</a><a id="13468" href="/Substitution/#13468" class="Bound">ρ</a> <a id="13470" class="Symbol">:</a> <a id="13472" href="/Denotational/#23035" class="Function">Rename</a> <a id="13479" href="/Substitution/#13459" class="Bound">Γ</a> <a id="13481" href="/Substitution/#13461" class="Bound">Δ</a><a id="13482" class="Symbol">}{</a><a id="13484" href="/Substitution/#13484" class="Bound">M</a> <a id="13486" class="Symbol">:</a> <a id="13488" href="/Substitution/#13459" class="Bound">Γ</a> <a id="13490" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="13492" href="/Substitution/#13464" class="Bound">A</a><a id="13493" class="Symbol">}</a>
                 <a id="13512" class="Symbol">→</a> <a id="13514" href="/Untyped/#6171" class="Function">rename</a> <a id="13521" href="/Substitution/#13468" class="Bound">ρ</a> <a id="13523" href="/Substitution/#13484" class="Bound">M</a> <a id="13525" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="13527" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="13529" href="/Substitution/#6114" class="Function">ren</a> <a id="13533" href="/Substitution/#13468" class="Bound">ρ</a> <a id="13535" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="13537" href="/Substitution/#13484" class="Bound">M</a>
<a id="13539" href="/Substitution/#13437" class="Function">rename-subst-ren</a> <a id="13556" class="Symbol">{</a><a id="13557" class="Argument">M</a> <a id="13559" class="Symbol">=</a> <a id="13561" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="13563" href="/Substitution/#13563" class="Bound">x</a><a id="13564" class="Symbol">}</a> <a id="13566" class="Symbol">=</a> <a id="13568" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="13573" href="/Substitution/#13437" class="Function">rename-subst-ren</a> <a id="13590" class="Symbol">{</a><a id="13591" class="Argument">ρ</a> <a id="13593" class="Symbol">=</a> <a id="13595" href="/Substitution/#13595" class="Bound">ρ</a><a id="13596" class="Symbol">}{</a><a id="13598" class="Argument">M</a> <a id="13600" class="Symbol">=</a> <a id="13602" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="13604" href="/Substitution/#13604" class="Bound">N</a><a id="13605" class="Symbol">}</a> <a id="13607" class="Symbol">=</a>
  <a id="13611" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
      <a id="13623" href="/Untyped/#6171" class="Function">rename</a> <a id="13630" href="/Substitution/#13595" class="Bound">ρ</a> <a id="13632" class="Symbol">(</a><a id="13633" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="13635" href="/Substitution/#13604" class="Bound">N</a><a id="13636" class="Symbol">)</a>
    <a id="13642" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
      <a id="13652" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="13654" href="/Untyped/#6171" class="Function">rename</a> <a id="13661" class="Symbol">(</a><a id="13662" href="/Untyped/#5845" class="Function">ext</a> <a id="13666" href="/Substitution/#13595" class="Bound">ρ</a><a id="13667" class="Symbol">)</a> <a id="13669" href="/Substitution/#13604" class="Bound">N</a>
    <a id="13675" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="13678" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="13683" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="13686" class="Symbol">(</a><a id="13687" href="/Substitution/#13437" class="Function">rename-subst-ren</a> <a id="13704" class="Symbol">{</a><a id="13705" class="Argument">ρ</a> <a id="13707" class="Symbol">=</a> <a id="13709" href="/Untyped/#5845" class="Function">ext</a> <a id="13713" href="/Substitution/#13595" class="Bound">ρ</a><a id="13714" class="Symbol">}{</a><a id="13716" class="Argument">M</a> <a id="13718" class="Symbol">=</a> <a id="13720" href="/Substitution/#13604" class="Bound">N</a><a id="13721" class="Symbol">})</a> <a id="13724" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="13732" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="13734" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="13736" href="/Substitution/#6114" class="Function">ren</a> <a id="13740" class="Symbol">(</a><a id="13741" href="/Untyped/#5845" class="Function">ext</a> <a id="13745" href="/Substitution/#13595" class="Bound">ρ</a><a id="13746" class="Symbol">)</a> <a id="13748" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="13750" href="/Substitution/#13604" class="Bound">N</a>
    <a id="13756" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="13759" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="13764" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="13767" class="Symbol">(</a><a id="13768" href="/Substitution/#10856" class="Function">cong-sub</a> <a id="13777" class="Symbol">{</a><a id="13778" class="Argument">M</a> <a id="13780" class="Symbol">=</a> <a id="13782" href="/Substitution/#13604" class="Bound">N</a><a id="13783" class="Symbol">}</a> <a id="13785" href="/Substitution/#13052" class="Function">ren-ext</a> <a id="13793" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="13797" class="Symbol">)</a> <a id="13799" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="13807" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="13809" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="13811" href="/Untyped/#6623" class="Function">exts</a> <a id="13816" class="Symbol">(</a><a id="13817" href="/Substitution/#6114" class="Function">ren</a> <a id="13821" href="/Substitution/#13595" class="Bound">ρ</a><a id="13822" class="Symbol">)</a> <a id="13824" href="/Substitution/#2076" class="Function Operator">⟫</a>  <a id="13827" href="/Substitution/#13604" class="Bound">N</a>
    <a id="13833" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
      <a id="13843" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="13845" href="/Substitution/#6114" class="Function">ren</a> <a id="13849" href="/Substitution/#13595" class="Bound">ρ</a> <a id="13851" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="13853" class="Symbol">(</a><a id="13854" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="13856" href="/Substitution/#13604" class="Bound">N</a><a id="13857" class="Symbol">)</a>
  <a id="13861" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="13863" href="/Substitution/#13437" class="Function">rename-subst-ren</a> <a id="13880" class="Symbol">{</a><a id="13881" class="Argument">M</a> <a id="13883" class="Symbol">=</a> <a id="13885" href="/Substitution/#13885" class="Bound">L</a> <a id="13887" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="13889" href="/Substitution/#13889" class="Bound">M</a><a id="13890" class="Symbol">}</a> <a id="13892" class="Symbol">=</a> <a id="13894" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="13900" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="13904" href="/Substitution/#13437" class="Function">rename-subst-ren</a> <a id="13921" href="/Substitution/#13437" class="Function">rename-subst-ren</a></pre>

<p>The substitution <code class="highlighter-rouge">ren S_</code> is equivalent to <code class="highlighter-rouge">↑</code>.</p>

<pre class="Agda"><a id="ren-shift"></a><a id="14012" href="/Substitution/#14012" class="Function">ren-shift</a> <a id="14022" class="Symbol">:</a> <a id="14024" class="Symbol">∀{</a><a id="14026" href="/Substitution/#14026" class="Bound">Γ</a><a id="14027" class="Symbol">}{</a><a id="14029" href="/Substitution/#14029" class="Bound">A</a><a id="14030" class="Symbol">}{</a><a id="14032" href="/Substitution/#14032" class="Bound">B</a><a id="14033" class="Symbol">}</a>
          <a id="14045" class="Symbol">→</a> <a id="14047" href="/Substitution/#6114" class="Function">ren</a> <a id="14051" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="14054" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="14056" href="/Substitution/#2746" class="Function">↑</a> <a id="14058" class="Symbol">{</a><a id="14059" class="Argument">A</a> <a id="14061" class="Symbol">=</a> <a id="14063" href="/Substitution/#14032" class="Bound">B</a><a id="14064" class="Symbol">}</a> <a id="14066" class="Symbol">{</a><a id="14067" href="/Substitution/#14029" class="Bound">A</a><a id="14068" class="Symbol">}</a>
<a id="14070" href="/Substitution/#14012" class="Function">ren-shift</a> <a id="14080" class="Symbol">{</a><a id="14081" href="/Substitution/#14081" class="Bound">Γ</a><a id="14082" class="Symbol">}{</a><a id="14084" href="/Substitution/#14084" class="Bound">A</a><a id="14085" class="Symbol">}{</a><a id="14087" href="/Substitution/#14087" class="Bound">B</a><a id="14088" class="Symbol">}</a> <a id="14090" class="Symbol">=</a> <a id="14092" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="14107" class="Symbol">λ</a> <a id="14109" href="/Substitution/#14109" class="Bound">x</a> <a id="14111" class="Symbol">→</a> <a id="14113" href="/Substitution/#14137" class="Function">lemma</a> <a id="14119" class="Symbol">{</a><a id="14120" class="Argument">x</a> <a id="14122" class="Symbol">=</a> <a id="14124" href="/Substitution/#14109" class="Bound">x</a><a id="14125" class="Symbol">}</a>
  <a id="14129" class="Keyword">where</a>
  <a id="14137" href="/Substitution/#14137" class="Function">lemma</a> <a id="14143" class="Symbol">:</a> <a id="14145" class="Symbol">∀</a> <a id="14147" class="Symbol">{</a><a id="14148" href="/Substitution/#14148" class="Bound">x</a> <a id="14150" class="Symbol">:</a> <a id="14152" href="/Substitution/#14081" class="Bound">Γ</a> <a id="14154" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="14156" href="/Substitution/#14084" class="Bound">A</a><a id="14157" class="Symbol">}</a> <a id="14159" class="Symbol">→</a> <a id="14161" href="/Substitution/#6114" class="Function">ren</a> <a id="14165" class="Symbol">(</a><a id="14166" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="14168" class="Symbol">{</a><a id="14169" class="Argument">B</a> <a id="14171" class="Symbol">=</a> <a id="14173" href="/Substitution/#14087" class="Bound">B</a><a id="14174" class="Symbol">})</a> <a id="14177" href="/Substitution/#14148" class="Bound">x</a> <a id="14179" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="14181" href="/Substitution/#2746" class="Function">↑</a> <a id="14183" class="Symbol">{</a><a id="14184" class="Argument">A</a> <a id="14186" class="Symbol">=</a> <a id="14188" href="/Substitution/#14087" class="Bound">B</a><a id="14189" class="Symbol">}</a> <a id="14191" href="/Substitution/#14148" class="Bound">x</a>
  <a id="14195" href="/Substitution/#14137" class="Function">lemma</a> <a id="14201" class="Symbol">{</a><a id="14202" class="Argument">x</a> <a id="14204" class="Symbol">=</a> <a id="14206" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="14207" class="Symbol">}</a> <a id="14209" class="Symbol">=</a> <a id="14211" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="14218" href="/Substitution/#14137" class="Function">lemma</a> <a id="14224" class="Symbol">{</a><a id="14225" class="Argument">x</a> <a id="14227" class="Symbol">=</a> <a id="14229" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="14231" href="/Substitution/#14231" class="Bound">x</a><a id="14232" class="Symbol">}</a> <a id="14234" class="Symbol">=</a> <a id="14236" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>The substitution <code class="highlighter-rouge">rename S_ M</code> is equivalent to shifting: <code class="highlighter-rouge">⟪ ↑ ⟫ M</code>.</p>

<pre class="Agda"><a id="rename-shift"></a><a id="14336" href="/Substitution/#14336" class="Function">rename-shift</a> <a id="14349" class="Symbol">:</a> <a id="14351" class="Symbol">∀{</a><a id="14353" href="/Substitution/#14353" class="Bound">Γ</a><a id="14354" class="Symbol">}</a> <a id="14356" class="Symbol">{</a><a id="14357" href="/Substitution/#14357" class="Bound">A</a><a id="14358" class="Symbol">}</a> <a id="14360" class="Symbol">{</a><a id="14361" href="/Substitution/#14361" class="Bound">B</a><a id="14362" class="Symbol">}</a> <a id="14364" class="Symbol">{</a><a id="14365" href="/Substitution/#14365" class="Bound">M</a> <a id="14367" class="Symbol">:</a> <a id="14369" href="/Substitution/#14353" class="Bound">Γ</a> <a id="14371" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="14373" href="/Substitution/#14357" class="Bound">A</a><a id="14374" class="Symbol">}</a>
             <a id="14389" class="Symbol">→</a> <a id="14391" href="/Untyped/#6171" class="Function">rename</a> <a id="14398" class="Symbol">(</a><a id="14399" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="14401" class="Symbol">{</a><a id="14402" class="Argument">B</a> <a id="14404" class="Symbol">=</a> <a id="14406" href="/Substitution/#14361" class="Bound">B</a><a id="14407" class="Symbol">})</a> <a id="14410" href="/Substitution/#14365" class="Bound">M</a> <a id="14412" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="14414" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="14416" href="/Substitution/#2746" class="Function">↑</a> <a id="14418" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="14420" href="/Substitution/#14365" class="Bound">M</a>
<a id="14422" href="/Substitution/#14336" class="Function">rename-shift</a><a id="14434" class="Symbol">{</a><a id="14435" href="/Substitution/#14435" class="Bound">Γ</a><a id="14436" class="Symbol">}{</a><a id="14438" href="/Substitution/#14438" class="Bound">A</a><a id="14439" class="Symbol">}{</a><a id="14441" href="/Substitution/#14441" class="Bound">B</a><a id="14442" class="Symbol">}{</a><a id="14444" href="/Substitution/#14444" class="Bound">M</a><a id="14445" class="Symbol">}</a> <a id="14447" class="Symbol">=</a>
  <a id="14451" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
    <a id="14461" href="/Untyped/#6171" class="Function">rename</a> <a id="14468" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="14471" href="/Substitution/#14444" class="Bound">M</a>
  <a id="14475" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="14478" href="/Substitution/#13437" class="Function">rename-subst-ren</a> <a id="14495" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
    <a id="14501" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="14503" href="/Substitution/#6114" class="Function">ren</a> <a id="14507" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="14510" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="14512" href="/Substitution/#14444" class="Bound">M</a>
  <a id="14516" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="14519" href="/Substitution/#10856" class="Function">cong-sub</a><a id="14527" class="Symbol">{</a><a id="14528" class="Argument">M</a> <a id="14530" class="Symbol">=</a> <a id="14532" href="/Substitution/#14444" class="Bound">M</a><a id="14533" class="Symbol">}</a> <a id="14535" href="/Substitution/#14012" class="Function">ren-shift</a> <a id="14545" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="14550" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
    <a id="14556" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="14558" href="/Substitution/#2746" class="Function">↑</a> <a id="14560" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="14562" href="/Substitution/#14444" class="Bound">M</a>
  <a id="14566" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>Next we prove the equation <code class="highlighter-rouge">exts-cons-shift</code>, which states that <code class="highlighter-rouge">exts</code>
is equivalent to cons’ing Z onto the sequence formed by applying <code class="highlighter-rouge">σ</code>
and then shifting. The proof is by case analysis on the variable <code class="highlighter-rouge">x</code>,
using <code class="highlighter-rouge">rename-subst-ren</code> for when <code class="highlighter-rouge">x = S y</code>.</p>

<pre class="Agda"><a id="exts-cons-shift"></a><a id="14849" href="/Substitution/#14849" class="Function">exts-cons-shift</a> <a id="14865" class="Symbol">:</a> <a id="14867" class="Symbol">∀{</a><a id="14869" href="/Substitution/#14869" class="Bound">Γ</a> <a id="14871" href="/Substitution/#14871" class="Bound">Δ</a><a id="14872" class="Symbol">}</a> <a id="14874" class="Symbol">{</a><a id="14875" href="/Substitution/#14875" class="Bound">A</a> <a id="14877" href="/Substitution/#14877" class="Bound">B</a><a id="14878" class="Symbol">}</a> <a id="14880" class="Symbol">{</a><a id="14881" href="/Substitution/#14881" class="Bound">σ</a> <a id="14883" class="Symbol">:</a> <a id="14885" href="/Soundness/#2673" class="Function">Subst</a> <a id="14891" href="/Substitution/#14869" class="Bound">Γ</a> <a id="14893" href="/Substitution/#14871" class="Bound">Δ</a><a id="14894" class="Symbol">}</a>
                <a id="14912" class="Symbol">→</a> <a id="14914" href="/Untyped/#6623" class="Function">exts</a> <a id="14919" href="/Substitution/#14881" class="Bound">σ</a> <a id="14921" class="Symbol">{</a><a id="14922" href="/Substitution/#14875" class="Bound">A</a><a id="14923" class="Symbol">}</a> <a id="14925" class="Symbol">{</a><a id="14926" href="/Substitution/#14877" class="Bound">B</a><a id="14927" class="Symbol">}</a> <a id="14929" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="14931" class="Symbol">(</a><a id="14932" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="14934" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="14936" href="/Substitution/#3004" class="Function Operator">•</a> <a id="14938" class="Symbol">(</a><a id="14939" href="/Substitution/#14881" class="Bound">σ</a> <a id="14941" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="14943" href="/Substitution/#2746" class="Function">↑</a><a id="14944" class="Symbol">))</a>
<a id="14947" href="/Substitution/#14849" class="Function">exts-cons-shift</a> <a id="14963" class="Symbol">=</a> <a id="14965" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="14980" class="Symbol">λ</a> <a id="14982" href="/Substitution/#14982" class="Bound">x</a> <a id="14984" class="Symbol">→</a> <a id="14986" href="/Substitution/#15009" class="Function">lemma</a><a id="14991" class="Symbol">{</a><a id="14992" class="Argument">x</a> <a id="14994" class="Symbol">=</a> <a id="14996" href="/Substitution/#14982" class="Bound">x</a><a id="14997" class="Symbol">}</a>
  <a id="15001" class="Keyword">where</a>
  <a id="15009" href="/Substitution/#15009" class="Function">lemma</a> <a id="15015" class="Symbol">:</a> <a id="15017" class="Symbol">∀{</a><a id="15019" href="/Substitution/#15019" class="Bound">Γ</a> <a id="15021" href="/Substitution/#15021" class="Bound">Δ</a><a id="15022" class="Symbol">}</a> <a id="15024" class="Symbol">{</a><a id="15025" href="/Substitution/#15025" class="Bound">A</a> <a id="15027" href="/Substitution/#15027" class="Bound">B</a><a id="15028" class="Symbol">}</a> <a id="15030" class="Symbol">{</a><a id="15031" href="/Substitution/#15031" class="Bound">σ</a> <a id="15033" class="Symbol">:</a> <a id="15035" href="/Soundness/#2673" class="Function">Subst</a> <a id="15041" href="/Substitution/#15019" class="Bound">Γ</a> <a id="15043" href="/Substitution/#15021" class="Bound">Δ</a><a id="15044" class="Symbol">}</a> <a id="15046" class="Symbol">{</a><a id="15047" href="/Substitution/#15047" class="Bound">x</a> <a id="15049" class="Symbol">:</a> <a id="15051" href="/Substitution/#15019" class="Bound">Γ</a> <a id="15053" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="15055" href="/Substitution/#15027" class="Bound">B</a> <a id="15057" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="15059" href="/Substitution/#15025" class="Bound">A</a><a id="15060" class="Symbol">}</a>
                  <a id="15080" class="Symbol">→</a> <a id="15082" href="/Untyped/#6623" class="Function">exts</a> <a id="15087" href="/Substitution/#15031" class="Bound">σ</a> <a id="15089" href="/Substitution/#15047" class="Bound">x</a> <a id="15091" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="15093" class="Symbol">(</a><a id="15094" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="15096" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="15098" href="/Substitution/#3004" class="Function Operator">•</a> <a id="15100" class="Symbol">(</a><a id="15101" href="/Substitution/#15031" class="Bound">σ</a> <a id="15103" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="15105" href="/Substitution/#2746" class="Function">↑</a><a id="15106" class="Symbol">))</a> <a id="15109" href="/Substitution/#15047" class="Bound">x</a>
  <a id="15113" href="/Substitution/#15009" class="Function">lemma</a> <a id="15119" class="Symbol">{</a><a id="15120" class="Argument">x</a> <a id="15122" class="Symbol">=</a> <a id="15124" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="15125" class="Symbol">}</a> <a id="15127" class="Symbol">=</a> <a id="15129" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="15136" href="/Substitution/#15009" class="Function">lemma</a> <a id="15142" class="Symbol">{</a><a id="15143" class="Argument">x</a> <a id="15145" class="Symbol">=</a> <a id="15147" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="15149" href="/Substitution/#15149" class="Bound">y</a><a id="15150" class="Symbol">}</a> <a id="15152" class="Symbol">=</a> <a id="15154" href="/Substitution/#13437" class="Function">rename-subst-ren</a></pre>

<p>As a corollary, we have a similar correspondence for <code class="highlighter-rouge">ren (ext ρ)</code>.</p>

<pre class="Agda"><a id="ext-cons-Z-shift"></a><a id="15265" href="/Substitution/#15265" class="Function">ext-cons-Z-shift</a> <a id="15282" class="Symbol">:</a> <a id="15284" class="Symbol">∀{</a><a id="15286" href="/Substitution/#15286" class="Bound">Γ</a> <a id="15288" href="/Substitution/#15288" class="Bound">Δ</a><a id="15289" class="Symbol">}</a> <a id="15291" class="Symbol">{</a><a id="15292" href="/Substitution/#15292" class="Bound">ρ</a> <a id="15294" class="Symbol">:</a> <a id="15296" href="/Denotational/#23035" class="Function">Rename</a> <a id="15303" href="/Substitution/#15286" class="Bound">Γ</a> <a id="15305" href="/Substitution/#15288" class="Bound">Δ</a><a id="15306" class="Symbol">}{</a><a id="15308" href="/Substitution/#15308" class="Bound">A</a><a id="15309" class="Symbol">}{</a><a id="15311" href="/Substitution/#15311" class="Bound">B</a><a id="15312" class="Symbol">}</a> 
                 <a id="15332" class="Symbol">→</a> <a id="15334" href="/Substitution/#6114" class="Function">ren</a> <a id="15338" class="Symbol">(</a><a id="15339" href="/Untyped/#5845" class="Function">ext</a> <a id="15343" href="/Substitution/#15292" class="Bound">ρ</a> <a id="15345" class="Symbol">{</a><a id="15346" class="Argument">B</a> <a id="15348" class="Symbol">=</a> <a id="15350" href="/Substitution/#15311" class="Bound">B</a><a id="15351" class="Symbol">})</a> <a id="15354" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="15356" class="Symbol">(</a><a id="15357" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="15359" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="15361" href="/Substitution/#3004" class="Function Operator">•</a> <a id="15363" class="Symbol">(</a><a id="15364" href="/Substitution/#6114" class="Function">ren</a> <a id="15368" href="/Substitution/#15292" class="Bound">ρ</a> <a id="15370" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="15372" href="/Substitution/#2746" class="Function">↑</a><a id="15373" class="Symbol">))</a> <a id="15376" class="Symbol">{</a><a id="15377" href="/Substitution/#15308" class="Bound">A</a><a id="15378" class="Symbol">}</a>
<a id="15380" href="/Substitution/#15265" class="Function">ext-cons-Z-shift</a> <a id="15397" class="Symbol">{</a><a id="15398" href="/Substitution/#15398" class="Bound">Γ</a><a id="15399" class="Symbol">}{</a><a id="15401" href="/Substitution/#15401" class="Bound">Δ</a><a id="15402" class="Symbol">}{</a><a id="15404" href="/Substitution/#15404" class="Bound">ρ</a><a id="15405" class="Symbol">}{</a><a id="15407" href="/Substitution/#15407" class="Bound">A</a><a id="15408" class="Symbol">}{</a><a id="15410" href="/Substitution/#15410" class="Bound">B</a><a id="15411" class="Symbol">}</a> <a id="15413" class="Symbol">=</a>
  <a id="15417" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
    <a id="15427" href="/Substitution/#6114" class="Function">ren</a> <a id="15431" class="Symbol">(</a><a id="15432" href="/Untyped/#5845" class="Function">ext</a> <a id="15436" href="/Substitution/#15404" class="Bound">ρ</a><a id="15437" class="Symbol">)</a>
  <a id="15441" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="15444" href="/Substitution/#13052" class="Function">ren-ext</a> <a id="15452" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
    <a id="15458" href="/Untyped/#6623" class="Function">exts</a> <a id="15463" class="Symbol">(</a><a id="15464" href="/Substitution/#6114" class="Function">ren</a> <a id="15468" href="/Substitution/#15404" class="Bound">ρ</a><a id="15469" class="Symbol">)</a>
  <a id="15473" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="15476" href="/Substitution/#14849" class="Function">exts-cons-shift</a><a id="15491" class="Symbol">{</a><a id="15492" class="Argument">σ</a> <a id="15494" class="Symbol">=</a> <a id="15496" href="/Substitution/#6114" class="Function">ren</a> <a id="15500" href="/Substitution/#15404" class="Bound">ρ</a><a id="15501" class="Symbol">}</a> <a id="15503" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
   <a id="15508" class="Symbol">((</a><a id="15510" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="15512" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="15513" class="Symbol">)</a> <a id="15515" href="/Substitution/#3004" class="Function Operator">•</a> <a id="15517" class="Symbol">(</a><a id="15518" href="/Substitution/#6114" class="Function">ren</a> <a id="15522" href="/Substitution/#15404" class="Bound">ρ</a> <a id="15524" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="15526" href="/Substitution/#2746" class="Function">↑</a><a id="15527" class="Symbol">))</a>
  <a id="15532" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>Finally, the <code class="highlighter-rouge">subst-zero M</code> substitution is equivalent to cons’ing <code class="highlighter-rouge">M</code>
onto the identity substitution.</p>

<pre class="Agda"><a id="subst-Z-cons-ids"></a><a id="15663" href="/Substitution/#15663" class="Function">subst-Z-cons-ids</a> <a id="15680" class="Symbol">:</a> <a id="15682" class="Symbol">∀{</a><a id="15684" href="/Substitution/#15684" class="Bound">Γ</a><a id="15685" class="Symbol">}{</a><a id="15687" href="/Substitution/#15687" class="Bound">A</a> <a id="15689" href="/Substitution/#15689" class="Bound">B</a> <a id="15691" class="Symbol">:</a> <a id="15693" href="/Untyped/#2675" class="Datatype">Type</a><a id="15697" class="Symbol">}{</a><a id="15699" href="/Substitution/#15699" class="Bound">M</a> <a id="15701" class="Symbol">:</a> <a id="15703" href="/Substitution/#15684" class="Bound">Γ</a> <a id="15705" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="15707" href="/Substitution/#15689" class="Bound">B</a><a id="15708" class="Symbol">}</a>
                 <a id="15727" class="Symbol">→</a> <a id="15729" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="15740" href="/Substitution/#15699" class="Bound">M</a> <a id="15742" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="15744" class="Symbol">(</a><a id="15745" href="/Substitution/#15699" class="Bound">M</a> <a id="15747" href="/Substitution/#3004" class="Function Operator">•</a> <a id="15749" href="/Substitution/#2591" class="Function">ids</a><a id="15752" class="Symbol">)</a> <a id="15754" class="Symbol">{</a><a id="15755" href="/Substitution/#15687" class="Bound">A</a><a id="15756" class="Symbol">}</a>
<a id="15758" href="/Substitution/#15663" class="Function">subst-Z-cons-ids</a> <a id="15775" class="Symbol">=</a> <a id="15777" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="15792" class="Symbol">λ</a> <a id="15794" href="/Substitution/#15794" class="Bound">x</a> <a id="15796" class="Symbol">→</a> <a id="15798" href="/Substitution/#15822" class="Function">lemma</a> <a id="15804" class="Symbol">{</a><a id="15805" class="Argument">x</a> <a id="15807" class="Symbol">=</a> <a id="15809" href="/Substitution/#15794" class="Bound">x</a><a id="15810" class="Symbol">}</a>
  <a id="15814" class="Keyword">where</a>
  <a id="15822" href="/Substitution/#15822" class="Function">lemma</a> <a id="15828" class="Symbol">:</a> <a id="15830" class="Symbol">∀{</a><a id="15832" href="/Substitution/#15832" class="Bound">Γ</a><a id="15833" class="Symbol">}{</a><a id="15835" href="/Substitution/#15835" class="Bound">A</a> <a id="15837" href="/Substitution/#15837" class="Bound">B</a> <a id="15839" class="Symbol">:</a> <a id="15841" href="/Untyped/#2675" class="Datatype">Type</a><a id="15845" class="Symbol">}{</a><a id="15847" href="/Substitution/#15847" class="Bound">M</a> <a id="15849" class="Symbol">:</a> <a id="15851" href="/Substitution/#15832" class="Bound">Γ</a> <a id="15853" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="15855" href="/Substitution/#15837" class="Bound">B</a><a id="15856" class="Symbol">}{</a><a id="15858" href="/Substitution/#15858" class="Bound">x</a> <a id="15860" class="Symbol">:</a> <a id="15862" href="/Substitution/#15832" class="Bound">Γ</a> <a id="15864" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="15866" href="/Substitution/#15837" class="Bound">B</a> <a id="15868" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="15870" href="/Substitution/#15835" class="Bound">A</a><a id="15871" class="Symbol">}</a>
                      <a id="15895" class="Symbol">→</a> <a id="15897" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="15908" href="/Substitution/#15847" class="Bound">M</a> <a id="15910" href="/Substitution/#15858" class="Bound">x</a> <a id="15912" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="15914" class="Symbol">(</a><a id="15915" href="/Substitution/#15847" class="Bound">M</a> <a id="15917" href="/Substitution/#3004" class="Function Operator">•</a> <a id="15919" href="/Substitution/#2591" class="Function">ids</a><a id="15922" class="Symbol">)</a> <a id="15924" href="/Substitution/#15858" class="Bound">x</a>
  <a id="15928" href="/Substitution/#15822" class="Function">lemma</a> <a id="15934" class="Symbol">{</a><a id="15935" class="Argument">x</a> <a id="15937" class="Symbol">=</a> <a id="15939" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="15940" class="Symbol">}</a> <a id="15942" class="Symbol">=</a> <a id="15944" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="15951" href="/Substitution/#15822" class="Function">lemma</a> <a id="15957" class="Symbol">{</a><a id="15958" class="Argument">x</a> <a id="15960" class="Symbol">=</a> <a id="15962" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="15964" href="/Substitution/#15964" class="Bound">x</a><a id="15965" class="Symbol">}</a> <a id="15967" class="Symbol">=</a> <a id="15969" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<h2 id="proofs-of-sub-abs-and-sub-id">Proofs of sub-abs and sub-id</h2>

<p>The equation <code class="highlighter-rouge">sub-abs</code> follows immediately from the equation
<code class="highlighter-rouge">exts-cons-shift</code>.</p>

<pre class="Agda"><a id="sub-abs"></a><a id="16114" href="/Substitution/#16114" class="Function">sub-abs</a> <a id="16122" class="Symbol">:</a> <a id="16124" class="Symbol">∀{</a><a id="16126" href="/Substitution/#16126" class="Bound">Γ</a> <a id="16128" href="/Substitution/#16128" class="Bound">Δ</a><a id="16129" class="Symbol">}</a> <a id="16131" class="Symbol">{</a><a id="16132" href="/Substitution/#16132" class="Bound">σ</a> <a id="16134" class="Symbol">:</a> <a id="16136" href="/Soundness/#2673" class="Function">Subst</a> <a id="16142" href="/Substitution/#16126" class="Bound">Γ</a> <a id="16144" href="/Substitution/#16128" class="Bound">Δ</a><a id="16145" class="Symbol">}</a> <a id="16147" class="Symbol">{</a><a id="16148" href="/Substitution/#16148" class="Bound">N</a> <a id="16150" class="Symbol">:</a> <a id="16152" href="/Substitution/#16126" class="Bound">Γ</a> <a id="16154" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="16156" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="16158" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="16160" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="16161" class="Symbol">}</a>
        <a id="16171" class="Symbol">→</a> <a id="16173" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="16175" href="/Substitution/#16132" class="Bound">σ</a> <a id="16177" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="16179" class="Symbol">(</a><a id="16180" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16182" href="/Substitution/#16148" class="Bound">N</a><a id="16183" class="Symbol">)</a> <a id="16185" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16187" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16189" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="16191" class="Symbol">(</a><a id="16192" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="16194" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="16195" class="Symbol">)</a> <a id="16197" href="/Substitution/#3004" class="Function Operator">•</a> <a id="16199" class="Symbol">(</a><a id="16200" href="/Substitution/#16132" class="Bound">σ</a> <a id="16202" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="16204" href="/Substitution/#2746" class="Function">↑</a><a id="16205" class="Symbol">)</a> <a id="16207" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="16209" href="/Substitution/#16148" class="Bound">N</a>
<a id="16211" href="/Substitution/#16114" class="Function">sub-abs</a> <a id="16219" class="Symbol">{</a><a id="16220" class="Argument">σ</a> <a id="16222" class="Symbol">=</a> <a id="16224" href="/Substitution/#16224" class="Bound">σ</a><a id="16225" class="Symbol">}{</a><a id="16227" class="Argument">N</a> <a id="16229" class="Symbol">=</a> <a id="16231" href="/Substitution/#16231" class="Bound">N</a><a id="16232" class="Symbol">}</a> <a id="16234" class="Symbol">=</a>
   <a id="16239" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="16250" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="16252" href="/Substitution/#16224" class="Bound">σ</a> <a id="16254" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="16256" class="Symbol">(</a><a id="16257" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16259" href="/Substitution/#16231" class="Bound">N</a><a id="16260" class="Symbol">)</a>
   <a id="16265" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="16274" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16276" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="16278" href="/Untyped/#6623" class="Function">exts</a> <a id="16283" href="/Substitution/#16224" class="Bound">σ</a> <a id="16285" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="16287" href="/Substitution/#16231" class="Bound">N</a>
   <a id="16292" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="16295" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="16300" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="16303" class="Symbol">(</a><a id="16304" href="/Substitution/#10856" class="Function">cong-sub</a><a id="16312" class="Symbol">{</a><a id="16313" class="Argument">M</a> <a id="16315" class="Symbol">=</a> <a id="16317" href="/Substitution/#16231" class="Bound">N</a><a id="16318" class="Symbol">}</a> <a id="16320" href="/Substitution/#14849" class="Function">exts-cons-shift</a> <a id="16336" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="16340" class="Symbol">)</a> <a id="16342" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="16349" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16351" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="16353" class="Symbol">(</a><a id="16354" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="16356" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="16357" class="Symbol">)</a> <a id="16359" href="/Substitution/#3004" class="Function Operator">•</a> <a id="16361" class="Symbol">(</a><a id="16362" href="/Substitution/#16224" class="Bound">σ</a> <a id="16364" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="16366" href="/Substitution/#2746" class="Function">↑</a><a id="16367" class="Symbol">)</a> <a id="16369" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="16371" href="/Substitution/#16231" class="Bound">N</a>
   <a id="16376" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>The proof of <code class="highlighter-rouge">sub-id</code> requires the following lemma which says that
extending the identity substitution produces the identity
substitution.</p>

<pre class="Agda"><a id="exts-ids"></a><a id="16543" href="/Substitution/#16543" class="Function">exts-ids</a> <a id="16552" class="Symbol">:</a> <a id="16554" class="Symbol">∀{</a><a id="16556" href="/Substitution/#16556" class="Bound">Γ</a><a id="16557" class="Symbol">}{</a><a id="16559" href="/Substitution/#16559" class="Bound">A</a> <a id="16561" href="/Substitution/#16561" class="Bound">B</a><a id="16562" class="Symbol">}</a>
         <a id="16573" class="Symbol">→</a> <a id="16575" href="/Untyped/#6623" class="Function">exts</a> <a id="16580" href="/Substitution/#2591" class="Function">ids</a> <a id="16584" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16586" href="/Substitution/#2591" class="Function">ids</a> <a id="16590" class="Symbol">{</a><a id="16591" href="/Substitution/#16556" class="Bound">Γ</a> <a id="16593" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="16595" href="/Substitution/#16561" class="Bound">B</a><a id="16596" class="Symbol">}</a> <a id="16598" class="Symbol">{</a><a id="16599" href="/Substitution/#16559" class="Bound">A</a><a id="16600" class="Symbol">}</a>
<a id="16602" href="/Substitution/#16543" class="Function">exts-ids</a> <a id="16611" class="Symbol">{</a><a id="16612" href="/Substitution/#16612" class="Bound">Γ</a><a id="16613" class="Symbol">}{</a><a id="16615" href="/Substitution/#16615" class="Bound">A</a><a id="16616" class="Symbol">}{</a><a id="16618" href="/Substitution/#16618" class="Bound">B</a><a id="16619" class="Symbol">}</a> <a id="16621" class="Symbol">=</a> <a id="16623" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="16638" href="/Substitution/#16652" class="Function">lemma</a>
  <a id="16646" class="Keyword">where</a> <a id="16652" href="/Substitution/#16652" class="Function">lemma</a> <a id="16658" class="Symbol">:</a> <a id="16660" class="Symbol">(</a><a id="16661" href="/Substitution/#16661" class="Bound">x</a> <a id="16663" class="Symbol">:</a> <a id="16665" href="/Substitution/#16612" class="Bound">Γ</a> <a id="16667" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="16669" href="/Substitution/#16618" class="Bound">B</a> <a id="16671" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="16673" href="/Substitution/#16615" class="Bound">A</a><a id="16674" class="Symbol">)</a> <a id="16676" class="Symbol">→</a> <a id="16678" href="/Untyped/#6623" class="Function">exts</a> <a id="16683" href="/Substitution/#2591" class="Function">ids</a> <a id="16687" href="/Substitution/#16661" class="Bound">x</a> <a id="16689" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16691" href="/Substitution/#2591" class="Function">ids</a> <a id="16695" href="/Substitution/#16661" class="Bound">x</a>
        <a id="16705" href="/Substitution/#16652" class="Function">lemma</a> <a id="16711" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="16713" class="Symbol">=</a> <a id="16715" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
        <a id="16728" href="/Substitution/#16652" class="Function">lemma</a> <a id="16734" class="Symbol">(</a><a id="16735" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="16737" href="/Substitution/#16737" class="Bound">x</a><a id="16738" class="Symbol">)</a> <a id="16740" class="Symbol">=</a> <a id="16742" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>The proof of <code class="highlighter-rouge">⟪ ids ⟫ M ≡ M</code> now follows easily by induction on <code class="highlighter-rouge">M</code>,
using <code class="highlighter-rouge">exts-ids</code> in the case for <code class="highlighter-rouge">M ≡ ƛ N</code>.</p>

<pre class="Agda"><a id="sub-id"></a><a id="16886" href="/Substitution/#16886" class="Function">sub-id</a> <a id="16893" class="Symbol">:</a> <a id="16895" class="Symbol">∀{</a><a id="16897" href="/Substitution/#16897" class="Bound">Γ</a><a id="16898" class="Symbol">}</a> <a id="16900" class="Symbol">{</a><a id="16901" href="/Substitution/#16901" class="Bound">A</a><a id="16902" class="Symbol">}</a> <a id="16904" class="Symbol">{</a><a id="16905" href="/Substitution/#16905" class="Bound">M</a> <a id="16907" class="Symbol">:</a> <a id="16909" href="/Substitution/#16897" class="Bound">Γ</a> <a id="16911" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="16913" href="/Substitution/#16901" class="Bound">A</a><a id="16914" class="Symbol">}</a>
         <a id="16925" class="Symbol">→</a> <a id="16927" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="16929" href="/Substitution/#2591" class="Function">ids</a> <a id="16933" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="16935" href="/Substitution/#16905" class="Bound">M</a> <a id="16937" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16939" href="/Substitution/#16905" class="Bound">M</a>
<a id="16941" href="/Substitution/#16886" class="Function">sub-id</a> <a id="16948" class="Symbol">{</a><a id="16949" class="Argument">M</a> <a id="16951" class="Symbol">=</a> <a id="16953" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="16955" href="/Substitution/#16955" class="Bound">x</a><a id="16956" class="Symbol">}</a> <a id="16958" class="Symbol">=</a> <a id="16960" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="16965" href="/Substitution/#16886" class="Function">sub-id</a> <a id="16972" class="Symbol">{</a><a id="16973" class="Argument">M</a> <a id="16975" class="Symbol">=</a> <a id="16977" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16979" href="/Substitution/#16979" class="Bound">N</a><a id="16980" class="Symbol">}</a> <a id="16982" class="Symbol">=</a> 
   <a id="16988" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="16999" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="17001" href="/Substitution/#2591" class="Function">ids</a> <a id="17005" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="17007" class="Symbol">(</a><a id="17008" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17010" href="/Substitution/#16979" class="Bound">N</a><a id="17011" class="Symbol">)</a>
   <a id="17016" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="17025" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17027" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="17029" href="/Untyped/#6623" class="Function">exts</a> <a id="17034" href="/Substitution/#2591" class="Function">ids</a> <a id="17038" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="17040" href="/Substitution/#16979" class="Bound">N</a>
   <a id="17045" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="17048" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="17053" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="17056" class="Symbol">(</a><a id="17057" href="/Substitution/#10856" class="Function">cong-sub</a><a id="17065" class="Symbol">{</a><a id="17066" class="Argument">M</a> <a id="17068" class="Symbol">=</a> <a id="17070" href="/Substitution/#16979" class="Bound">N</a><a id="17071" class="Symbol">}</a> <a id="17073" href="/Substitution/#16543" class="Function">exts-ids</a> <a id="17082" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="17086" class="Symbol">)</a>  <a id="17089" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="17096" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17098" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="17100" href="/Substitution/#2591" class="Function">ids</a> <a id="17104" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="17106" href="/Substitution/#16979" class="Bound">N</a>
   <a id="17111" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="17114" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="17119" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="17122" href="/Substitution/#16886" class="Function">sub-id</a> <a id="17129" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="17136" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17138" href="/Substitution/#16979" class="Bound">N</a>
   <a id="17143" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="17145" href="/Substitution/#16886" class="Function">sub-id</a> <a id="17152" class="Symbol">{</a><a id="17153" class="Argument">M</a> <a id="17155" class="Symbol">=</a> <a id="17157" href="/Substitution/#17157" class="Bound">L</a> <a id="17159" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="17161" href="/Substitution/#17161" class="Bound">M</a><a id="17162" class="Symbol">}</a> <a id="17164" class="Symbol">=</a> <a id="17166" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="17172" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="17176" href="/Substitution/#16886" class="Function">sub-id</a> <a id="17183" href="/Substitution/#16886" class="Function">sub-id</a></pre>

<h2 id="proof-of-sub-idr">Proof of sub-idR</h2>

<p>The proof of <code class="highlighter-rouge">sub-idR</code> follows directly from <code class="highlighter-rouge">sub-id</code>.</p>

<pre class="Agda"><a id="sub-idR"></a><a id="17293" href="/Substitution/#17293" class="Function">sub-idR</a> <a id="17301" class="Symbol">:</a> <a id="17303" class="Symbol">∀{</a><a id="17305" href="/Substitution/#17305" class="Bound">Γ</a> <a id="17307" href="/Substitution/#17307" class="Bound">Δ</a><a id="17308" class="Symbol">}</a> <a id="17310" class="Symbol">{</a><a id="17311" href="/Substitution/#17311" class="Bound">σ</a> <a id="17313" class="Symbol">:</a> <a id="17315" href="/Soundness/#2673" class="Function">Subst</a> <a id="17321" href="/Substitution/#17305" class="Bound">Γ</a> <a id="17323" href="/Substitution/#17307" class="Bound">Δ</a><a id="17324" class="Symbol">}</a> <a id="17326" class="Symbol">{</a><a id="17327" href="/Substitution/#17327" class="Bound">A</a><a id="17328" class="Symbol">}</a>
       <a id="17337" class="Symbol">→</a> <a id="17339" class="Symbol">(</a><a id="17340" href="/Substitution/#17311" class="Bound">σ</a> <a id="17342" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="17344" href="/Substitution/#2591" class="Function">ids</a><a id="17347" class="Symbol">)</a> <a id="17349" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="17351" href="/Substitution/#17311" class="Bound">σ</a> <a id="17353" class="Symbol">{</a><a id="17354" href="/Substitution/#17327" class="Bound">A</a><a id="17355" class="Symbol">}</a>
<a id="17357" href="/Substitution/#17293" class="Function">sub-idR</a> <a id="17365" class="Symbol">{</a><a id="17366" href="/Substitution/#17366" class="Bound">Γ</a><a id="17367" class="Symbol">}{</a><a id="17369" class="Argument">σ</a> <a id="17371" class="Symbol">=</a> <a id="17373" href="/Substitution/#17373" class="Bound">σ</a><a id="17374" class="Symbol">}{</a><a id="17376" href="/Substitution/#17376" class="Bound">A</a><a id="17377" class="Symbol">}</a> <a id="17379" class="Symbol">=</a>
          <a id="17391" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
            <a id="17409" href="/Substitution/#17373" class="Bound">σ</a> <a id="17411" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="17413" href="/Substitution/#2591" class="Function">ids</a>
          <a id="17427" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
            <a id="17443" class="Symbol">(</a><a id="17444" href="/Untyped/#6931" class="Function">subst</a> <a id="17450" href="/Substitution/#2591" class="Function">ids</a><a id="17453" class="Symbol">)</a> <a id="17455" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="17457" href="/Substitution/#17373" class="Bound">σ</a>
          <a id="17469" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="17472" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="17487" class="Symbol">(λ</a> <a id="17490" href="/Substitution/#17490" class="Bound">x</a> <a id="17492" class="Symbol">→</a> <a id="17494" href="/Substitution/#16886" class="Function">sub-id</a><a id="17500" class="Symbol">)</a> <a id="17502" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
            <a id="17516" href="/Substitution/#17373" class="Bound">σ</a>
          <a id="17528" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-sub-sub">Proof of sub-sub</h2>

<p>The <code class="highlighter-rouge">sub-sub</code> equation states that sequenced substitutions <code class="highlighter-rouge">σ ⨟ τ</code>
are equivalent to first applying <code class="highlighter-rouge">σ</code> then applying <code class="highlighter-rouge">τ</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ τ ⟫ ⟪ σ ⟫ M  ≡ ⟪ σ ⨟ τ ⟫ M
</code></pre></div></div>

<p>The proof requires several lemmas. First, we need to prove the
specialization for renaming.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ (rename ρ′ M) ≡ rename (ρ ∘ ρ′) M
</code></pre></div></div>

<p>This in turn requires the following lemma about <code class="highlighter-rouge">ext</code>.</p>

<pre class="Agda"><a id="compose-ext"></a><a id="17932" href="/Substitution/#17932" class="Function">compose-ext</a> <a id="17944" class="Symbol">:</a> <a id="17946" class="Symbol">∀{</a><a id="17948" href="/Substitution/#17948" class="Bound">Γ</a> <a id="17950" href="/Substitution/#17950" class="Bound">Δ</a> <a id="17952" href="/Substitution/#17952" class="Bound">Σ</a><a id="17953" class="Symbol">}{</a><a id="17955" href="/Substitution/#17955" class="Bound">ρ</a> <a id="17957" class="Symbol">:</a> <a id="17959" href="/Denotational/#23035" class="Function">Rename</a> <a id="17966" href="/Substitution/#17950" class="Bound">Δ</a> <a id="17968" href="/Substitution/#17952" class="Bound">Σ</a><a id="17969" class="Symbol">}</a> <a id="17971" class="Symbol">{</a><a id="17972" href="/Substitution/#17972" class="Bound">ρ′</a> <a id="17975" class="Symbol">:</a> <a id="17977" href="/Denotational/#23035" class="Function">Rename</a> <a id="17984" href="/Substitution/#17948" class="Bound">Γ</a> <a id="17986" href="/Substitution/#17950" class="Bound">Δ</a><a id="17987" class="Symbol">}</a> <a id="17989" class="Symbol">{</a><a id="17990" href="/Substitution/#17990" class="Bound">A</a> <a id="17992" href="/Substitution/#17992" class="Bound">B</a><a id="17993" class="Symbol">}</a>
            <a id="18007" class="Symbol">→</a> <a id="18009" class="Symbol">((</a><a id="18011" href="/Untyped/#5845" class="Function">ext</a> <a id="18015" href="/Substitution/#17955" class="Bound">ρ</a><a id="18016" class="Symbol">)</a> <a id="18018" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="18020" class="Symbol">(</a><a id="18021" href="/Untyped/#5845" class="Function">ext</a> <a id="18025" href="/Substitution/#17972" class="Bound">ρ′</a><a id="18027" class="Symbol">))</a> <a id="18030" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="18032" href="/Untyped/#5845" class="Function">ext</a> <a id="18036" class="Symbol">(</a><a id="18037" href="/Substitution/#17955" class="Bound">ρ</a> <a id="18039" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="18041" href="/Substitution/#17972" class="Bound">ρ′</a><a id="18043" class="Symbol">)</a> <a id="18045" class="Symbol">{</a><a id="18046" href="/Substitution/#17992" class="Bound">B</a><a id="18047" class="Symbol">}</a> <a id="18049" class="Symbol">{</a><a id="18050" href="/Substitution/#17990" class="Bound">A</a><a id="18051" class="Symbol">}</a>
<a id="18053" href="/Substitution/#17932" class="Function">compose-ext</a> <a id="18065" class="Symbol">=</a> <a id="18067" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="18082" class="Symbol">λ</a> <a id="18084" href="/Substitution/#18084" class="Bound">x</a> <a id="18086" class="Symbol">→</a> <a id="18088" href="/Substitution/#18112" class="Function">lemma</a> <a id="18094" class="Symbol">{</a><a id="18095" class="Argument">x</a> <a id="18097" class="Symbol">=</a> <a id="18099" href="/Substitution/#18084" class="Bound">x</a><a id="18100" class="Symbol">}</a>
  <a id="18104" class="Keyword">where</a>
  <a id="18112" href="/Substitution/#18112" class="Function">lemma</a> <a id="18118" class="Symbol">:</a> <a id="18120" class="Symbol">∀{</a><a id="18122" href="/Substitution/#18122" class="Bound">Γ</a> <a id="18124" href="/Substitution/#18124" class="Bound">Δ</a> <a id="18126" href="/Substitution/#18126" class="Bound">Σ</a><a id="18127" class="Symbol">}{</a><a id="18129" href="/Substitution/#18129" class="Bound">ρ</a> <a id="18131" class="Symbol">:</a> <a id="18133" href="/Denotational/#23035" class="Function">Rename</a> <a id="18140" href="/Substitution/#18124" class="Bound">Δ</a> <a id="18142" href="/Substitution/#18126" class="Bound">Σ</a><a id="18143" class="Symbol">}</a> <a id="18145" class="Symbol">{</a><a id="18146" href="/Substitution/#18146" class="Bound">ρ′</a> <a id="18149" class="Symbol">:</a> <a id="18151" href="/Denotational/#23035" class="Function">Rename</a> <a id="18158" href="/Substitution/#18122" class="Bound">Γ</a> <a id="18160" href="/Substitution/#18124" class="Bound">Δ</a><a id="18161" class="Symbol">}</a> <a id="18163" class="Symbol">{</a><a id="18164" href="/Substitution/#18164" class="Bound">A</a> <a id="18166" href="/Substitution/#18166" class="Bound">B</a><a id="18167" class="Symbol">}</a> <a id="18169" class="Symbol">{</a><a id="18170" href="/Substitution/#18170" class="Bound">x</a> <a id="18172" class="Symbol">:</a> <a id="18174" href="/Substitution/#18122" class="Bound">Γ</a> <a id="18176" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="18178" href="/Substitution/#18166" class="Bound">B</a> <a id="18180" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="18182" href="/Substitution/#18164" class="Bound">A</a><a id="18183" class="Symbol">}</a>
              <a id="18199" class="Symbol">→</a> <a id="18201" class="Symbol">((</a><a id="18203" href="/Untyped/#5845" class="Function">ext</a> <a id="18207" href="/Substitution/#18129" class="Bound">ρ</a><a id="18208" class="Symbol">)</a> <a id="18210" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="18212" class="Symbol">(</a><a id="18213" href="/Untyped/#5845" class="Function">ext</a> <a id="18217" href="/Substitution/#18146" class="Bound">ρ′</a><a id="18219" class="Symbol">))</a> <a id="18222" href="/Substitution/#18170" class="Bound">x</a> <a id="18224" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="18226" href="/Untyped/#5845" class="Function">ext</a> <a id="18230" class="Symbol">(</a><a id="18231" href="/Substitution/#18129" class="Bound">ρ</a> <a id="18233" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="18235" href="/Substitution/#18146" class="Bound">ρ′</a><a id="18237" class="Symbol">)</a> <a id="18239" href="/Substitution/#18170" class="Bound">x</a>
  <a id="18243" href="/Substitution/#18112" class="Function">lemma</a> <a id="18249" class="Symbol">{</a><a id="18250" class="Argument">x</a> <a id="18252" class="Symbol">=</a> <a id="18254" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="18255" class="Symbol">}</a> <a id="18257" class="Symbol">=</a> <a id="18259" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="18266" href="/Substitution/#18112" class="Function">lemma</a> <a id="18272" class="Symbol">{</a><a id="18273" class="Argument">x</a> <a id="18275" class="Symbol">=</a> <a id="18277" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="18279" href="/Substitution/#18279" class="Bound">x</a><a id="18280" class="Symbol">}</a> <a id="18282" class="Symbol">=</a> <a id="18284" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>To prove that composing renamings is equivalent to appying one after
the other using <code class="highlighter-rouge">rename</code>, we proceed by induction on the term <code class="highlighter-rouge">M</code>,
using the <code class="highlighter-rouge">compose-ext</code> lemma in the case for <code class="highlighter-rouge">M ≡ ƛ N</code>.</p>

<pre class="Agda"><a id="compose-rename"></a><a id="18508" href="/Substitution/#18508" class="Function">compose-rename</a> <a id="18523" class="Symbol">:</a> <a id="18525" class="Symbol">∀{</a><a id="18527" href="/Substitution/#18527" class="Bound">Γ</a> <a id="18529" href="/Substitution/#18529" class="Bound">Δ</a> <a id="18531" href="/Substitution/#18531" class="Bound">Σ</a><a id="18532" class="Symbol">}{</a><a id="18534" href="/Substitution/#18534" class="Bound">A</a><a id="18535" class="Symbol">}{</a><a id="18537" href="/Substitution/#18537" class="Bound">M</a> <a id="18539" class="Symbol">:</a> <a id="18541" href="/Substitution/#18527" class="Bound">Γ</a> <a id="18543" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="18545" href="/Substitution/#18534" class="Bound">A</a><a id="18546" class="Symbol">}{</a><a id="18548" href="/Substitution/#18548" class="Bound">ρ</a> <a id="18550" class="Symbol">:</a> <a id="18552" href="/Denotational/#23035" class="Function">Rename</a> <a id="18559" href="/Substitution/#18529" class="Bound">Δ</a> <a id="18561" href="/Substitution/#18531" class="Bound">Σ</a><a id="18562" class="Symbol">}{</a><a id="18564" href="/Substitution/#18564" class="Bound">ρ′</a> <a id="18567" class="Symbol">:</a> <a id="18569" href="/Denotational/#23035" class="Function">Rename</a> <a id="18576" href="/Substitution/#18527" class="Bound">Γ</a> <a id="18578" href="/Substitution/#18529" class="Bound">Δ</a><a id="18579" class="Symbol">}</a> 
  <a id="18584" class="Symbol">→</a> <a id="18586" href="/Untyped/#6171" class="Function">rename</a> <a id="18593" href="/Substitution/#18548" class="Bound">ρ</a> <a id="18595" class="Symbol">(</a><a id="18596" href="/Untyped/#6171" class="Function">rename</a> <a id="18603" href="/Substitution/#18564" class="Bound">ρ′</a> <a id="18606" href="/Substitution/#18537" class="Bound">M</a><a id="18607" class="Symbol">)</a> <a id="18609" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="18611" href="/Untyped/#6171" class="Function">rename</a> <a id="18618" class="Symbol">(</a><a id="18619" href="/Substitution/#18548" class="Bound">ρ</a> <a id="18621" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="18623" href="/Substitution/#18564" class="Bound">ρ′</a><a id="18625" class="Symbol">)</a> <a id="18627" href="/Substitution/#18537" class="Bound">M</a>
<a id="18629" href="/Substitution/#18508" class="Function">compose-rename</a> <a id="18644" class="Symbol">{</a><a id="18645" class="Argument">M</a> <a id="18647" class="Symbol">=</a> <a id="18649" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="18651" href="/Substitution/#18651" class="Bound">x</a><a id="18652" class="Symbol">}</a> <a id="18654" class="Symbol">=</a> <a id="18656" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="18661" href="/Substitution/#18508" class="Function">compose-rename</a> <a id="18676" class="Symbol">{</a><a id="18677" href="/Substitution/#18677" class="Bound">Γ</a><a id="18678" class="Symbol">}{</a><a id="18680" href="/Substitution/#18680" class="Bound">Δ</a><a id="18681" class="Symbol">}{</a><a id="18683" href="/Substitution/#18683" class="Bound">Σ</a><a id="18684" class="Symbol">}{</a><a id="18686" href="/Substitution/#18686" class="Bound">A</a><a id="18687" class="Symbol">}{</a><a id="18689" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="18691" href="/Substitution/#18691" class="Bound">N</a><a id="18692" class="Symbol">}{</a><a id="18694" href="/Substitution/#18694" class="Bound">ρ</a><a id="18695" class="Symbol">}{</a><a id="18697" href="/Substitution/#18697" class="Bound">ρ′</a><a id="18699" class="Symbol">}</a> <a id="18701" class="Symbol">=</a> <a id="18703" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="18708" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="18711" href="/Substitution/#18723" class="Function">G</a>
  <a id="18715" class="Keyword">where</a>
  <a id="18723" href="/Substitution/#18723" class="Function">G</a> <a id="18725" class="Symbol">:</a> <a id="18727" href="/Untyped/#6171" class="Function">rename</a> <a id="18734" class="Symbol">(</a><a id="18735" href="/Untyped/#5845" class="Function">ext</a> <a id="18739" href="/Substitution/#18694" class="Bound">ρ</a><a id="18740" class="Symbol">)</a> <a id="18742" class="Symbol">(</a><a id="18743" href="/Untyped/#6171" class="Function">rename</a> <a id="18750" class="Symbol">(</a><a id="18751" href="/Untyped/#5845" class="Function">ext</a> <a id="18755" href="/Substitution/#18697" class="Bound">ρ′</a><a id="18757" class="Symbol">)</a> <a id="18759" href="/Substitution/#18691" class="Bound">N</a><a id="18760" class="Symbol">)</a> <a id="18762" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="18764" href="/Untyped/#6171" class="Function">rename</a> <a id="18771" class="Symbol">(</a><a id="18772" href="/Untyped/#5845" class="Function">ext</a> <a id="18776" class="Symbol">(</a><a id="18777" href="/Substitution/#18694" class="Bound">ρ</a> <a id="18779" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="18781" href="/Substitution/#18697" class="Bound">ρ′</a><a id="18783" class="Symbol">))</a> <a id="18786" href="/Substitution/#18691" class="Bound">N</a>
  <a id="18790" href="/Substitution/#18723" class="Function">G</a> <a id="18792" class="Symbol">=</a>
      <a id="18800" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
        <a id="18814" href="/Untyped/#6171" class="Function">rename</a> <a id="18821" class="Symbol">(</a><a id="18822" href="/Untyped/#5845" class="Function">ext</a> <a id="18826" href="/Substitution/#18694" class="Bound">ρ</a><a id="18827" class="Symbol">)</a> <a id="18829" class="Symbol">(</a><a id="18830" href="/Untyped/#6171" class="Function">rename</a> <a id="18837" class="Symbol">(</a><a id="18838" href="/Untyped/#5845" class="Function">ext</a> <a id="18842" href="/Substitution/#18697" class="Bound">ρ′</a><a id="18844" class="Symbol">)</a> <a id="18846" href="/Substitution/#18691" class="Bound">N</a><a id="18847" class="Symbol">)</a>
      <a id="18855" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="18858" href="/Substitution/#18508" class="Function">compose-rename</a><a id="18872" class="Symbol">{</a><a id="18873" class="Argument">ρ</a> <a id="18875" class="Symbol">=</a> <a id="18877" href="/Untyped/#5845" class="Function">ext</a> <a id="18881" href="/Substitution/#18694" class="Bound">ρ</a><a id="18882" class="Symbol">}{</a><a id="18884" class="Argument">ρ′</a> <a id="18887" class="Symbol">=</a> <a id="18889" href="/Untyped/#5845" class="Function">ext</a> <a id="18893" href="/Substitution/#18697" class="Bound">ρ′</a><a id="18895" class="Symbol">}</a> <a id="18897" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
        <a id="18907" href="/Untyped/#6171" class="Function">rename</a> <a id="18914" class="Symbol">((</a><a id="18916" href="/Untyped/#5845" class="Function">ext</a> <a id="18920" href="/Substitution/#18694" class="Bound">ρ</a><a id="18921" class="Symbol">)</a> <a id="18923" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="18925" class="Symbol">(</a><a id="18926" href="/Untyped/#5845" class="Function">ext</a> <a id="18930" href="/Substitution/#18697" class="Bound">ρ′</a><a id="18932" class="Symbol">))</a> <a id="18935" href="/Substitution/#18691" class="Bound">N</a>
      <a id="18943" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="18946" href="/Substitution/#10022" class="Function">cong-rename</a> <a id="18958" href="/Substitution/#17932" class="Function">compose-ext</a> <a id="18970" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="18975" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
        <a id="18985" href="/Untyped/#6171" class="Function">rename</a> <a id="18992" class="Symbol">(</a><a id="18993" href="/Untyped/#5845" class="Function">ext</a> <a id="18997" class="Symbol">(</a><a id="18998" href="/Substitution/#18694" class="Bound">ρ</a> <a id="19000" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="19002" href="/Substitution/#18697" class="Bound">ρ′</a><a id="19004" class="Symbol">))</a> <a id="19007" href="/Substitution/#18691" class="Bound">N</a>
      <a id="19015" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>        
<a id="19025" href="/Substitution/#18508" class="Function">compose-rename</a> <a id="19040" class="Symbol">{</a><a id="19041" class="Argument">M</a> <a id="19043" class="Symbol">=</a> <a id="19045" href="/Substitution/#19045" class="Bound">L</a> <a id="19047" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="19049" href="/Substitution/#19049" class="Bound">M</a><a id="19050" class="Symbol">}</a> <a id="19052" class="Symbol">=</a> <a id="19054" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="19060" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="19064" href="/Substitution/#18508" class="Function">compose-rename</a> <a id="19079" href="/Substitution/#18508" class="Function">compose-rename</a></pre>

<p>The next lemma states that if a renaming and subtitution commute on
variables, then they also commute on terms. We explain the proof in
detail below.</p>

<pre class="Agda"><a id="commute-subst-rename"></a><a id="19270" href="/Substitution/#19270" class="Function">commute-subst-rename</a> <a id="19291" class="Symbol">:</a> <a id="19293" class="Symbol">∀{</a><a id="19295" href="/Substitution/#19295" class="Bound">Γ</a> <a id="19297" href="/Substitution/#19297" class="Bound">Δ</a><a id="19298" class="Symbol">}{</a><a id="19300" href="/Substitution/#19300" class="Bound">M</a> <a id="19302" class="Symbol">:</a> <a id="19304" href="/Substitution/#19295" class="Bound">Γ</a> <a id="19306" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="19308" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19309" class="Symbol">}{</a><a id="19311" href="/Substitution/#19311" class="Bound">σ</a> <a id="19313" class="Symbol">:</a> <a id="19315" href="/Soundness/#2673" class="Function">Subst</a> <a id="19321" href="/Substitution/#19295" class="Bound">Γ</a> <a id="19323" href="/Substitution/#19297" class="Bound">Δ</a><a id="19324" class="Symbol">}</a>
                        <a id="19350" class="Symbol">{</a><a id="19351" href="/Substitution/#19351" class="Bound">ρ</a> <a id="19353" class="Symbol">:</a> <a id="19355" class="Symbol">∀{</a><a id="19357" href="/Substitution/#19357" class="Bound">Γ</a><a id="19358" class="Symbol">}</a> <a id="19360" class="Symbol">→</a> <a id="19362" href="/Denotational/#23035" class="Function">Rename</a> <a id="19369" href="/Substitution/#19357" class="Bound">Γ</a> <a id="19371" class="Symbol">(</a><a id="19372" href="/Substitution/#19357" class="Bound">Γ</a> <a id="19374" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="19376" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19377" class="Symbol">)}</a>
     <a id="19385" class="Symbol">→</a> <a id="19387" class="Symbol">(∀{</a><a id="19390" href="/Substitution/#19390" class="Bound">x</a> <a id="19392" class="Symbol">:</a> <a id="19394" href="/Substitution/#19295" class="Bound">Γ</a> <a id="19396" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="19398" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19399" class="Symbol">}</a> <a id="19401" class="Symbol">→</a> <a id="19403" href="/Untyped/#6623" class="Function">exts</a> <a id="19408" href="/Substitution/#19311" class="Bound">σ</a> <a id="19410" class="Symbol">{</a><a id="19411" class="Argument">B</a> <a id="19413" class="Symbol">=</a> <a id="19415" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19416" class="Symbol">}</a> <a id="19418" class="Symbol">(</a><a id="19419" href="/Substitution/#19351" class="Bound">ρ</a> <a id="19421" href="/Substitution/#19390" class="Bound">x</a><a id="19422" class="Symbol">)</a> <a id="19424" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="19426" href="/Untyped/#6171" class="Function">rename</a> <a id="19433" href="/Substitution/#19351" class="Bound">ρ</a> <a id="19435" class="Symbol">(</a><a id="19436" href="/Substitution/#19311" class="Bound">σ</a> <a id="19438" href="/Substitution/#19390" class="Bound">x</a><a id="19439" class="Symbol">))</a>
     <a id="19447" class="Symbol">→</a> <a id="19449" href="/Untyped/#6931" class="Function">subst</a> <a id="19455" class="Symbol">(</a><a id="19456" href="/Untyped/#6623" class="Function">exts</a> <a id="19461" href="/Substitution/#19311" class="Bound">σ</a> <a id="19463" class="Symbol">{</a><a id="19464" class="Argument">B</a> <a id="19466" class="Symbol">=</a> <a id="19468" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19469" class="Symbol">})</a> <a id="19472" class="Symbol">(</a><a id="19473" href="/Untyped/#6171" class="Function">rename</a> <a id="19480" href="/Substitution/#19351" class="Bound">ρ</a> <a id="19482" href="/Substitution/#19300" class="Bound">M</a><a id="19483" class="Symbol">)</a> <a id="19485" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="19487" href="/Untyped/#6171" class="Function">rename</a> <a id="19494" href="/Substitution/#19351" class="Bound">ρ</a> <a id="19496" class="Symbol">(</a><a id="19497" href="/Untyped/#6931" class="Function">subst</a> <a id="19503" href="/Substitution/#19311" class="Bound">σ</a> <a id="19505" href="/Substitution/#19300" class="Bound">M</a><a id="19506" class="Symbol">)</a>
<a id="19508" href="/Substitution/#19270" class="Function">commute-subst-rename</a> <a id="19529" class="Symbol">{</a><a id="19530" class="Argument">M</a> <a id="19532" class="Symbol">=</a> <a id="19534" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="19536" href="/Substitution/#19536" class="Bound">x</a><a id="19537" class="Symbol">}</a> <a id="19539" href="/Substitution/#19539" class="Bound">r</a> <a id="19541" class="Symbol">=</a> <a id="19543" href="/Substitution/#19539" class="Bound">r</a>
<a id="19545" href="/Substitution/#19270" class="Function">commute-subst-rename</a><a id="19565" class="Symbol">{</a><a id="19566" href="/Substitution/#19566" class="Bound">Γ</a><a id="19567" class="Symbol">}{</a><a id="19569" href="/Substitution/#19569" class="Bound">Δ</a><a id="19570" class="Symbol">}{</a><a id="19572" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="19574" href="/Substitution/#19574" class="Bound">N</a><a id="19575" class="Symbol">}{</a><a id="19577" href="/Substitution/#19577" class="Bound">σ</a><a id="19578" class="Symbol">}{</a><a id="19580" href="/Substitution/#19580" class="Bound">ρ</a><a id="19581" class="Symbol">}</a> <a id="19583" href="/Substitution/#19583" class="Bound">r</a> <a id="19585" class="Symbol">=</a>
   <a id="19590" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="19595" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="19598" class="Symbol">(</a><a id="19599" href="/Substitution/#19270" class="Function">commute-subst-rename</a><a id="19619" class="Symbol">{</a><a id="19620" href="/Substitution/#19566" class="Bound">Γ</a> <a id="19622" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="19624" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19625" class="Symbol">}{</a><a id="19627" href="/Substitution/#19569" class="Bound">Δ</a> <a id="19629" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="19631" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19632" class="Symbol">}{</a><a id="19634" href="/Substitution/#19574" class="Bound">N</a><a id="19635" class="Symbol">}</a>
               <a id="19652" class="Symbol">{</a><a id="19653" href="/Untyped/#6623" class="Function">exts</a> <a id="19658" href="/Substitution/#19577" class="Bound">σ</a><a id="19659" class="Symbol">}{</a><a id="19661" class="Argument">ρ</a> <a id="19663" class="Symbol">=</a> <a id="19665" href="/Substitution/#19698" class="Function">ρ′</a><a id="19667" class="Symbol">}</a> <a id="19669" class="Symbol">(λ</a> <a id="19672" class="Symbol">{</a><a id="19673" href="/Substitution/#19673" class="Bound">x</a><a id="19674" class="Symbol">}</a> <a id="19676" class="Symbol">→</a> <a id="19678" href="/Substitution/#19771" class="Function">H</a> <a id="19680" class="Symbol">{</a><a id="19681" href="/Substitution/#19673" class="Bound">x</a><a id="19682" class="Symbol">}))</a>
   <a id="19689" class="Keyword">where</a>
   <a id="19698" href="/Substitution/#19698" class="Function">ρ′</a> <a id="19701" class="Symbol">:</a> <a id="19703" class="Symbol">∀</a> <a id="19705" class="Symbol">{</a><a id="19706" href="/Substitution/#19706" class="Bound">Γ</a><a id="19707" class="Symbol">}</a> <a id="19709" class="Symbol">→</a> <a id="19711" href="/Denotational/#23035" class="Function">Rename</a> <a id="19718" href="/Substitution/#19706" class="Bound">Γ</a> <a id="19720" class="Symbol">(</a><a id="19721" href="/Substitution/#19706" class="Bound">Γ</a> <a id="19723" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="19725" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19726" class="Symbol">)</a>
   <a id="19731" href="/Substitution/#19698" class="Function">ρ′</a> <a id="19734" class="Symbol">{</a><a id="19735" href="/Untyped/#3002" class="InductiveConstructor">∅</a><a id="19736" class="Symbol">}</a> <a id="19738" class="Symbol">=</a> <a id="19740" class="Symbol">λ</a> <a id="19742" class="Symbol">()</a>
   <a id="19748" href="/Substitution/#19698" class="Function">ρ′</a> <a id="19751" class="Symbol">{</a><a id="19752" href="/Substitution/#19752" class="Bound">Γ</a> <a id="19754" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="19756" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19757" class="Symbol">}</a> <a id="19759" class="Symbol">=</a> <a id="19761" href="/Untyped/#5845" class="Function">ext</a> <a id="19765" href="/Substitution/#19580" class="Bound">ρ</a>

   <a id="19771" href="/Substitution/#19771" class="Function">H</a> <a id="19773" class="Symbol">:</a> <a id="19775" class="Symbol">{</a><a id="19776" href="/Substitution/#19776" class="Bound">x</a> <a id="19778" class="Symbol">:</a> <a id="19780" href="/Substitution/#19566" class="Bound">Γ</a> <a id="19782" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="19784" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="19786" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="19788" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19789" class="Symbol">}</a> <a id="19791" class="Symbol">→</a> <a id="19793" href="/Untyped/#6623" class="Function">exts</a> <a id="19798" class="Symbol">(</a><a id="19799" href="/Untyped/#6623" class="Function">exts</a> <a id="19804" href="/Substitution/#19577" class="Bound">σ</a><a id="19805" class="Symbol">)</a> <a id="19807" class="Symbol">(</a><a id="19808" href="/Untyped/#5845" class="Function">ext</a> <a id="19812" href="/Substitution/#19580" class="Bound">ρ</a> <a id="19814" href="/Substitution/#19776" class="Bound">x</a><a id="19815" class="Symbol">)</a> <a id="19817" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="19819" href="/Untyped/#6171" class="Function">rename</a> <a id="19826" class="Symbol">(</a><a id="19827" href="/Untyped/#5845" class="Function">ext</a> <a id="19831" href="/Substitution/#19580" class="Bound">ρ</a><a id="19832" class="Symbol">)</a> <a id="19834" class="Symbol">(</a><a id="19835" href="/Untyped/#6623" class="Function">exts</a> <a id="19840" href="/Substitution/#19577" class="Bound">σ</a> <a id="19842" href="/Substitution/#19776" class="Bound">x</a><a id="19843" class="Symbol">)</a>
   <a id="19848" href="/Substitution/#19771" class="Function">H</a> <a id="19850" class="Symbol">{</a><a id="19851" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="19852" class="Symbol">}</a> <a id="19854" class="Symbol">=</a> <a id="19856" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="19864" href="/Substitution/#19771" class="Function">H</a> <a id="19866" class="Symbol">{</a><a id="19867" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="19869" href="/Substitution/#19869" class="Bound">y</a><a id="19870" class="Symbol">}</a> <a id="19872" class="Symbol">=</a>
     <a id="19879" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="19892" href="/Untyped/#6623" class="Function">exts</a> <a id="19897" class="Symbol">(</a><a id="19898" href="/Untyped/#6623" class="Function">exts</a> <a id="19903" href="/Substitution/#19577" class="Bound">σ</a><a id="19904" class="Symbol">)</a> <a id="19906" class="Symbol">(</a><a id="19907" href="/Untyped/#5845" class="Function">ext</a> <a id="19911" href="/Substitution/#19580" class="Bound">ρ</a> <a id="19913" class="Symbol">(</a><a id="19914" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="19916" href="/Substitution/#19869" class="Bound">y</a><a id="19917" class="Symbol">))</a>
     <a id="19925" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="19936" href="/Untyped/#6171" class="Function">rename</a> <a id="19943" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="19946" class="Symbol">(</a><a id="19947" href="/Untyped/#6623" class="Function">exts</a> <a id="19952" href="/Substitution/#19577" class="Bound">σ</a> <a id="19954" class="Symbol">(</a><a id="19955" href="/Substitution/#19580" class="Bound">ρ</a> <a id="19957" href="/Substitution/#19869" class="Bound">y</a><a id="19958" class="Symbol">))</a> 
     <a id="19967" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="19970" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="19975" class="Symbol">(</a><a id="19976" href="/Untyped/#6171" class="Function">rename</a> <a id="19983" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="19985" class="Symbol">)</a> <a id="19987" href="/Substitution/#19583" class="Bound">r</a> <a id="19989" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="19998" href="/Untyped/#6171" class="Function">rename</a> <a id="20005" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="20008" class="Symbol">(</a><a id="20009" href="/Untyped/#6171" class="Function">rename</a> <a id="20016" href="/Substitution/#19580" class="Bound">ρ</a> <a id="20018" class="Symbol">(</a><a id="20019" href="/Substitution/#19577" class="Bound">σ</a> <a id="20021" href="/Substitution/#19869" class="Bound">y</a><a id="20022" class="Symbol">))</a>
     <a id="20030" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="20033" href="/Substitution/#18508" class="Function">compose-rename</a> <a id="20048" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="20057" href="/Untyped/#6171" class="Function">rename</a> <a id="20064" class="Symbol">(</a><a id="20065" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="20068" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="20070" href="/Substitution/#19580" class="Bound">ρ</a><a id="20071" class="Symbol">)</a> <a id="20073" class="Symbol">(</a><a id="20074" href="/Substitution/#19577" class="Bound">σ</a> <a id="20076" href="/Substitution/#19869" class="Bound">y</a><a id="20077" class="Symbol">)</a>
     <a id="20084" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="20087" href="/Substitution/#10022" class="Function">cong-rename</a> <a id="20099" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="20104" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="20109" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="20118" href="/Untyped/#6171" class="Function">rename</a> <a id="20125" class="Symbol">((</a><a id="20127" href="/Untyped/#5845" class="Function">ext</a> <a id="20131" href="/Substitution/#19580" class="Bound">ρ</a><a id="20132" class="Symbol">)</a> <a id="20134" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="20136" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="20138" class="Symbol">)</a> <a id="20140" class="Symbol">(</a><a id="20141" href="/Substitution/#19577" class="Bound">σ</a> <a id="20143" href="/Substitution/#19869" class="Bound">y</a><a id="20144" class="Symbol">)</a>
     <a id="20151" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="20154" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="20158" href="/Substitution/#18508" class="Function">compose-rename</a> <a id="20173" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="20182" href="/Untyped/#6171" class="Function">rename</a> <a id="20189" class="Symbol">(</a><a id="20190" href="/Untyped/#5845" class="Function">ext</a> <a id="20194" href="/Substitution/#19580" class="Bound">ρ</a><a id="20195" class="Symbol">)</a> <a id="20197" class="Symbol">(</a><a id="20198" href="/Untyped/#6171" class="Function">rename</a> <a id="20205" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="20208" class="Symbol">(</a><a id="20209" href="/Substitution/#19577" class="Bound">σ</a> <a id="20211" href="/Substitution/#19869" class="Bound">y</a><a id="20212" class="Symbol">))</a>
     <a id="20220" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="20231" href="/Untyped/#6171" class="Function">rename</a> <a id="20238" class="Symbol">(</a><a id="20239" href="/Untyped/#5845" class="Function">ext</a> <a id="20243" href="/Substitution/#19580" class="Bound">ρ</a><a id="20244" class="Symbol">)</a> <a id="20246" class="Symbol">(</a><a id="20247" href="/Untyped/#6623" class="Function">exts</a> <a id="20252" href="/Substitution/#19577" class="Bound">σ</a> <a id="20254" class="Symbol">(</a><a id="20255" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="20257" href="/Substitution/#19869" class="Bound">y</a><a id="20258" class="Symbol">))</a>
     <a id="20266" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="20268" href="/Substitution/#19270" class="Function">commute-subst-rename</a> <a id="20289" class="Symbol">{</a><a id="20290" class="Argument">M</a> <a id="20292" class="Symbol">=</a> <a id="20294" href="/Substitution/#20294" class="Bound">L</a> <a id="20296" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="20298" href="/Substitution/#20298" class="Bound">M</a><a id="20299" class="Symbol">}{</a><a id="20301" class="Argument">ρ</a> <a id="20303" class="Symbol">=</a> <a id="20305" href="/Substitution/#20305" class="Bound">ρ</a><a id="20306" class="Symbol">}</a> <a id="20308" href="/Substitution/#20308" class="Bound">r</a> <a id="20310" class="Symbol">=</a>
   <a id="20315" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="20321" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="20325" class="Symbol">(</a><a id="20326" href="/Substitution/#19270" class="Function">commute-subst-rename</a><a id="20346" class="Symbol">{</a><a id="20347" class="Argument">M</a> <a id="20349" class="Symbol">=</a> <a id="20351" href="/Substitution/#20294" class="Bound">L</a><a id="20352" class="Symbol">}{</a><a id="20354" class="Argument">ρ</a> <a id="20356" class="Symbol">=</a> <a id="20358" href="/Substitution/#20305" class="Bound">ρ</a><a id="20359" class="Symbol">}</a> <a id="20361" href="/Substitution/#20308" class="Bound">r</a><a id="20362" class="Symbol">)</a>
             <a id="20377" class="Symbol">(</a><a id="20378" href="/Substitution/#19270" class="Function">commute-subst-rename</a><a id="20398" class="Symbol">{</a><a id="20399" class="Argument">M</a> <a id="20401" class="Symbol">=</a> <a id="20403" href="/Substitution/#20298" class="Bound">M</a><a id="20404" class="Symbol">}{</a><a id="20406" class="Argument">ρ</a> <a id="20408" class="Symbol">=</a> <a id="20410" href="/Substitution/#20305" class="Bound">ρ</a><a id="20411" class="Symbol">}</a> <a id="20413" href="/Substitution/#20308" class="Bound">r</a><a id="20414" class="Symbol">)</a></pre>

<p>The proof is by induction on the term <code class="highlighter-rouge">M</code>.</p>

<ul>
  <li>
    <p>If <code class="highlighter-rouge">M</code> is a variable, then we use the premise to conclude.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M ≡ ƛ N</code>, we conclude using the induction hypothesis for
<code class="highlighter-rouge">N</code>. However, to use the induction hypothesis, we must show
that</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  exts (exts σ) (ext ρ x) ≡ rename (ext ρ) (exts σ x)
</code></pre></div>    </div>

    <p>We prove this equation by cases on x.</p>

    <ul>
      <li>
        <p>If <code class="highlighter-rouge">x = Z</code>, the two sides are equal by definition.</p>
      </li>
      <li>
        <p>If <code class="highlighter-rouge">x = S y</code>, we obtain the goal by the following equational reasoning.</p>

        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts (exts σ) (ext ρ (S y))   ≡ rename S_ (exts σ (ρ y))    ≡ rename S_ (rename S_ (σ (ρ y)      (by the premise)   ≡ rename (ext ρ) (exts σ (S y))      (by compose-rename)   ≡ rename ((ext ρ) ∘ S_) (σ y)   ≡ rename (ext ρ) (rename S_ (σ y))   (by compose-rename)   ≡ rename (ext ρ) (exts σ (S y))
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M</code> is an application, we obtain the goal using the induction
hypothesis for each subterm.</p>
  </li>
</ul>

<p>The last lemma needed to prove <code class="highlighter-rouge">sub-sub</code> states that the <code class="highlighter-rouge">exts</code>
function distributes with sequencing. It is a corollary of
<code class="highlighter-rouge">commute-subst-rename</code>. We describe the proof below.</p>

<pre class="Agda"><a id="exts-seq"></a><a id="21541" href="/Substitution/#21541" class="Function">exts-seq</a> <a id="21550" class="Symbol">:</a> <a id="21552" class="Symbol">∀{</a><a id="21554" href="/Substitution/#21554" class="Bound">Γ</a> <a id="21556" href="/Substitution/#21556" class="Bound">Δ</a> <a id="21558" href="/Substitution/#21558" class="Bound">Δ′</a><a id="21560" class="Symbol">}</a> <a id="21562" class="Symbol">{</a><a id="21563" href="/Substitution/#21563" class="Bound">σ₁</a> <a id="21566" class="Symbol">:</a> <a id="21568" href="/Soundness/#2673" class="Function">Subst</a> <a id="21574" href="/Substitution/#21554" class="Bound">Γ</a> <a id="21576" href="/Substitution/#21556" class="Bound">Δ</a><a id="21577" class="Symbol">}</a> <a id="21579" class="Symbol">{</a><a id="21580" href="/Substitution/#21580" class="Bound">σ₂</a> <a id="21583" class="Symbol">:</a> <a id="21585" href="/Soundness/#2673" class="Function">Subst</a> <a id="21591" href="/Substitution/#21556" class="Bound">Δ</a> <a id="21593" href="/Substitution/#21558" class="Bound">Δ′</a><a id="21595" class="Symbol">}</a>
   <a id="21600" class="Symbol">→</a> <a id="21602" class="Symbol">∀</a> <a id="21604" class="Symbol">{</a><a id="21605" href="/Substitution/#21605" class="Bound">A</a><a id="21606" class="Symbol">}</a> <a id="21608" class="Symbol">→</a> <a id="21610" class="Symbol">(</a><a id="21611" href="/Untyped/#6623" class="Function">exts</a> <a id="21616" href="/Substitution/#21563" class="Bound">σ₁</a> <a id="21619" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="21621" href="/Untyped/#6623" class="Function">exts</a> <a id="21626" href="/Substitution/#21580" class="Bound">σ₂</a><a id="21628" class="Symbol">)</a> <a id="21630" class="Symbol">{</a><a id="21631" href="/Substitution/#21605" class="Bound">A</a><a id="21632" class="Symbol">}</a> <a id="21634" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="21636" href="/Untyped/#6623" class="Function">exts</a> <a id="21641" class="Symbol">(</a><a id="21642" href="/Substitution/#21563" class="Bound">σ₁</a> <a id="21645" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="21647" href="/Substitution/#21580" class="Bound">σ₂</a><a id="21649" class="Symbol">)</a>
<a id="21651" href="/Substitution/#21541" class="Function">exts-seq</a> <a id="21660" class="Symbol">=</a> <a id="21662" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="21677" class="Symbol">λ</a> <a id="21679" href="/Substitution/#21679" class="Bound">x</a> <a id="21681" class="Symbol">→</a> <a id="21683" href="/Substitution/#21707" class="Function">lemma</a> <a id="21689" class="Symbol">{</a><a id="21690" class="Argument">x</a> <a id="21692" class="Symbol">=</a> <a id="21694" href="/Substitution/#21679" class="Bound">x</a><a id="21695" class="Symbol">}</a>
  <a id="21699" class="Keyword">where</a>
  <a id="21707" href="/Substitution/#21707" class="Function">lemma</a> <a id="21713" class="Symbol">:</a> <a id="21715" class="Symbol">∀{</a><a id="21717" href="/Substitution/#21717" class="Bound">Γ</a> <a id="21719" href="/Substitution/#21719" class="Bound">Δ</a> <a id="21721" href="/Substitution/#21721" class="Bound">Δ′</a><a id="21723" class="Symbol">}{</a><a id="21725" href="/Substitution/#21725" class="Bound">A</a><a id="21726" class="Symbol">}{</a><a id="21728" href="/Substitution/#21728" class="Bound">x</a> <a id="21730" class="Symbol">:</a> <a id="21732" href="/Substitution/#21717" class="Bound">Γ</a> <a id="21734" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="21736" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="21738" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="21740" href="/Substitution/#21725" class="Bound">A</a><a id="21741" class="Symbol">}</a> <a id="21743" class="Symbol">{</a><a id="21744" href="/Substitution/#21744" class="Bound">σ₁</a> <a id="21747" class="Symbol">:</a> <a id="21749" href="/Soundness/#2673" class="Function">Subst</a> <a id="21755" href="/Substitution/#21717" class="Bound">Γ</a> <a id="21757" href="/Substitution/#21719" class="Bound">Δ</a><a id="21758" class="Symbol">}{</a><a id="21760" href="/Substitution/#21760" class="Bound">σ₂</a> <a id="21763" class="Symbol">:</a> <a id="21765" href="/Soundness/#2673" class="Function">Subst</a> <a id="21771" href="/Substitution/#21719" class="Bound">Δ</a> <a id="21773" href="/Substitution/#21721" class="Bound">Δ′</a><a id="21775" class="Symbol">}</a>
     <a id="21782" class="Symbol">→</a> <a id="21784" class="Symbol">(</a><a id="21785" href="/Untyped/#6623" class="Function">exts</a> <a id="21790" href="/Substitution/#21744" class="Bound">σ₁</a> <a id="21793" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="21795" href="/Untyped/#6623" class="Function">exts</a> <a id="21800" href="/Substitution/#21760" class="Bound">σ₂</a><a id="21802" class="Symbol">)</a> <a id="21804" href="/Substitution/#21728" class="Bound">x</a> <a id="21806" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="21808" href="/Untyped/#6623" class="Function">exts</a> <a id="21813" class="Symbol">(</a><a id="21814" href="/Substitution/#21744" class="Bound">σ₁</a> <a id="21817" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="21819" href="/Substitution/#21760" class="Bound">σ₂</a><a id="21821" class="Symbol">)</a> <a id="21823" href="/Substitution/#21728" class="Bound">x</a>
  <a id="21827" href="/Substitution/#21707" class="Function">lemma</a> <a id="21833" class="Symbol">{</a><a id="21834" class="Argument">x</a> <a id="21836" class="Symbol">=</a> <a id="21838" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="21839" class="Symbol">}</a> <a id="21841" class="Symbol">=</a> <a id="21843" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="21850" href="/Substitution/#21707" class="Function">lemma</a> <a id="21856" class="Symbol">{</a><a id="21857" class="Argument">A</a> <a id="21859" class="Symbol">=</a> <a id="21861" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="21862" class="Symbol">}{</a><a id="21864" class="Argument">x</a> <a id="21866" class="Symbol">=</a> <a id="21868" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="21870" href="/Substitution/#21870" class="Bound">x</a><a id="21871" class="Symbol">}{</a><a id="21873" href="/Substitution/#21873" class="Bound">σ₁</a><a id="21875" class="Symbol">}{</a><a id="21877" href="/Substitution/#21877" class="Bound">σ₂</a><a id="21879" class="Symbol">}</a> <a id="21881" class="Symbol">=</a>
     <a id="21888" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="21901" class="Symbol">(</a><a id="21902" href="/Untyped/#6623" class="Function">exts</a> <a id="21907" href="/Substitution/#21873" class="Bound">σ₁</a> <a id="21910" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="21912" href="/Untyped/#6623" class="Function">exts</a> <a id="21917" href="/Substitution/#21877" class="Bound">σ₂</a><a id="21919" class="Symbol">)</a> <a id="21921" class="Symbol">(</a><a id="21922" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="21924" href="/Substitution/#21870" class="Bound">x</a><a id="21925" class="Symbol">)</a>
     <a id="21932" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="21943" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="21945" href="/Untyped/#6623" class="Function">exts</a> <a id="21950" href="/Substitution/#21877" class="Bound">σ₂</a> <a id="21953" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="21955" class="Symbol">(</a><a id="21956" href="/Untyped/#6171" class="Function">rename</a> <a id="21963" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="21966" class="Symbol">(</a><a id="21967" href="/Substitution/#21873" class="Bound">σ₁</a> <a id="21970" href="/Substitution/#21870" class="Bound">x</a><a id="21971" class="Symbol">))</a>
     <a id="21979" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="21982" href="/Substitution/#19270" class="Function">commute-subst-rename</a><a id="22002" class="Symbol">{</a><a id="22003" class="Argument">M</a> <a id="22005" class="Symbol">=</a> <a id="22007" href="/Substitution/#21873" class="Bound">σ₁</a> <a id="22010" href="/Substitution/#21870" class="Bound">x</a><a id="22011" class="Symbol">}{</a><a id="22013" class="Argument">σ</a> <a id="22015" class="Symbol">=</a> <a id="22017" href="/Substitution/#21877" class="Bound">σ₂</a><a id="22019" class="Symbol">}{</a><a id="22021" class="Argument">ρ</a> <a id="22023" class="Symbol">=</a> <a id="22025" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="22027" class="Symbol">}</a> <a id="22029" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="22034" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="22043" href="/Untyped/#6171" class="Function">rename</a> <a id="22050" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="22053" class="Symbol">(</a><a id="22054" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="22056" href="/Substitution/#21877" class="Bound">σ₂</a> <a id="22059" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="22061" class="Symbol">(</a><a id="22062" href="/Substitution/#21873" class="Bound">σ₁</a> <a id="22065" href="/Substitution/#21870" class="Bound">x</a><a id="22066" class="Symbol">))</a>
     <a id="22074" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="22085" href="/Untyped/#6171" class="Function">rename</a> <a id="22092" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="22095" class="Symbol">((</a><a id="22097" href="/Substitution/#21873" class="Bound">σ₁</a> <a id="22100" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="22102" href="/Substitution/#21877" class="Bound">σ₂</a><a id="22104" class="Symbol">)</a> <a id="22106" href="/Substitution/#21870" class="Bound">x</a><a id="22107" class="Symbol">)</a>
     <a id="22114" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>The proof proceed by cases on <code class="highlighter-rouge">x</code>.</p>

<ul>
  <li>
    <p>If <code class="highlighter-rouge">x = Z</code>, the two sides are equal by the definition of <code class="highlighter-rouge">exts</code>
and sequencing.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">x = S x</code>, we unfold the first use of <code class="highlighter-rouge">exts</code> and sequencing, then
apply the lemma <code class="highlighter-rouge">commute-subst-rename</code>. We conclude by the
definition of sequencing.</p>
  </li>
</ul>

<p>Now we come to the proof of <code class="highlighter-rouge">sub-sub</code>, which we explain below.</p>

<pre class="Agda"><a id="sub-sub"></a><a id="22488" href="/Substitution/#22488" class="Function">sub-sub</a> <a id="22496" class="Symbol">:</a> <a id="22498" class="Symbol">∀{</a><a id="22500" href="/Substitution/#22500" class="Bound">Γ</a> <a id="22502" href="/Substitution/#22502" class="Bound">Δ</a> <a id="22504" href="/Substitution/#22504" class="Bound">Σ</a><a id="22505" class="Symbol">}{</a><a id="22507" href="/Substitution/#22507" class="Bound">A</a><a id="22508" class="Symbol">}{</a><a id="22510" href="/Substitution/#22510" class="Bound">M</a> <a id="22512" class="Symbol">:</a> <a id="22514" href="/Substitution/#22500" class="Bound">Γ</a> <a id="22516" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="22518" href="/Substitution/#22507" class="Bound">A</a><a id="22519" class="Symbol">}</a> <a id="22521" class="Symbol">{</a><a id="22522" href="/Substitution/#22522" class="Bound">σ₁</a> <a id="22525" class="Symbol">:</a> <a id="22527" href="/Soundness/#2673" class="Function">Subst</a> <a id="22533" href="/Substitution/#22500" class="Bound">Γ</a> <a id="22535" href="/Substitution/#22502" class="Bound">Δ</a><a id="22536" class="Symbol">}{</a><a id="22538" href="/Substitution/#22538" class="Bound">σ₂</a> <a id="22541" class="Symbol">:</a> <a id="22543" href="/Soundness/#2673" class="Function">Subst</a> <a id="22549" href="/Substitution/#22502" class="Bound">Δ</a> <a id="22551" href="/Substitution/#22504" class="Bound">Σ</a><a id="22552" class="Symbol">}</a> 
            <a id="22567" class="Symbol">→</a> <a id="22569" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="22571" href="/Substitution/#22538" class="Bound">σ₂</a> <a id="22574" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="22576" class="Symbol">(</a><a id="22577" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="22579" href="/Substitution/#22522" class="Bound">σ₁</a> <a id="22582" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="22584" href="/Substitution/#22510" class="Bound">M</a><a id="22585" class="Symbol">)</a> <a id="22587" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="22589" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="22591" href="/Substitution/#22522" class="Bound">σ₁</a> <a id="22594" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="22596" href="/Substitution/#22538" class="Bound">σ₂</a> <a id="22599" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="22601" href="/Substitution/#22510" class="Bound">M</a>
<a id="22603" href="/Substitution/#22488" class="Function">sub-sub</a> <a id="22611" class="Symbol">{</a><a id="22612" class="Argument">M</a> <a id="22614" class="Symbol">=</a> <a id="22616" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="22618" href="/Substitution/#22618" class="Bound">x</a><a id="22619" class="Symbol">}</a> <a id="22621" class="Symbol">=</a> <a id="22623" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="22628" href="/Substitution/#22488" class="Function">sub-sub</a> <a id="22636" class="Symbol">{</a><a id="22637" href="/Substitution/#22637" class="Bound">Γ</a><a id="22638" class="Symbol">}{</a><a id="22640" href="/Substitution/#22640" class="Bound">Δ</a><a id="22641" class="Symbol">}{</a><a id="22643" href="/Substitution/#22643" class="Bound">Σ</a><a id="22644" class="Symbol">}{</a><a id="22646" href="/Substitution/#22646" class="Bound">A</a><a id="22647" class="Symbol">}{</a><a id="22649" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="22651" href="/Substitution/#22651" class="Bound">N</a><a id="22652" class="Symbol">}{</a><a id="22654" href="/Substitution/#22654" class="Bound">σ₁</a><a id="22656" class="Symbol">}{</a><a id="22658" href="/Substitution/#22658" class="Bound">σ₂</a><a id="22660" class="Symbol">}</a> <a id="22662" class="Symbol">=</a>
   <a id="22667" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="22678" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="22680" href="/Substitution/#22658" class="Bound">σ₂</a> <a id="22683" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="22685" class="Symbol">(</a><a id="22686" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="22688" href="/Substitution/#22654" class="Bound">σ₁</a> <a id="22691" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="22693" class="Symbol">(</a><a id="22694" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="22696" href="/Substitution/#22651" class="Bound">N</a><a id="22697" class="Symbol">))</a>
   <a id="22703" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="22712" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="22714" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="22716" href="/Untyped/#6623" class="Function">exts</a> <a id="22721" href="/Substitution/#22658" class="Bound">σ₂</a> <a id="22724" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="22726" class="Symbol">(</a><a id="22727" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="22729" href="/Untyped/#6623" class="Function">exts</a> <a id="22734" href="/Substitution/#22654" class="Bound">σ₁</a> <a id="22737" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="22739" href="/Substitution/#22651" class="Bound">N</a><a id="22740" class="Symbol">)</a>
   <a id="22745" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="22748" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="22753" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="22756" class="Symbol">(</a><a id="22757" href="/Substitution/#22488" class="Function">sub-sub</a><a id="22764" class="Symbol">{</a><a id="22765" class="Argument">M</a> <a id="22767" class="Symbol">=</a> <a id="22769" href="/Substitution/#22651" class="Bound">N</a><a id="22770" class="Symbol">}{</a><a id="22772" class="Argument">σ₁</a> <a id="22775" class="Symbol">=</a> <a id="22777" href="/Untyped/#6623" class="Function">exts</a> <a id="22782" href="/Substitution/#22654" class="Bound">σ₁</a><a id="22784" class="Symbol">}{</a><a id="22786" class="Argument">σ₂</a> <a id="22789" class="Symbol">=</a> <a id="22791" href="/Untyped/#6623" class="Function">exts</a> <a id="22796" href="/Substitution/#22658" class="Bound">σ₂</a><a id="22798" class="Symbol">})</a> <a id="22801" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="22808" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="22810" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="22812" href="/Untyped/#6623" class="Function">exts</a> <a id="22817" href="/Substitution/#22654" class="Bound">σ₁</a> <a id="22820" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="22822" href="/Untyped/#6623" class="Function">exts</a> <a id="22827" href="/Substitution/#22658" class="Bound">σ₂</a> <a id="22830" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="22832" href="/Substitution/#22651" class="Bound">N</a>
   <a id="22837" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="22840" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="22845" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="22848" class="Symbol">(</a><a id="22849" href="/Substitution/#10856" class="Function">cong-sub</a><a id="22857" class="Symbol">{</a><a id="22858" class="Argument">M</a> <a id="22860" class="Symbol">=</a> <a id="22862" href="/Substitution/#22651" class="Bound">N</a><a id="22863" class="Symbol">}</a> <a id="22865" class="Symbol">(λ</a> <a id="22868" class="Symbol">{</a><a id="22869" href="/Substitution/#22869" class="Bound">A</a><a id="22870" class="Symbol">}</a> <a id="22872" class="Symbol">→</a> <a id="22874" href="/Substitution/#21541" class="Function">exts-seq</a><a id="22882" class="Symbol">)</a> <a id="22884" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="22888" class="Symbol">)</a> <a id="22890" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="22897" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="22899" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="22901" href="/Untyped/#6623" class="Function">exts</a> <a id="22906" class="Symbol">(</a> <a id="22908" href="/Substitution/#22654" class="Bound">σ₁</a> <a id="22911" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="22913" href="/Substitution/#22658" class="Bound">σ₂</a><a id="22915" class="Symbol">)</a> <a id="22917" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="22919" href="/Substitution/#22651" class="Bound">N</a>
   <a id="22924" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="22926" href="/Substitution/#22488" class="Function">sub-sub</a> <a id="22934" class="Symbol">{</a><a id="22935" class="Argument">M</a> <a id="22937" class="Symbol">=</a> <a id="22939" href="/Substitution/#22939" class="Bound">L</a> <a id="22941" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="22943" href="/Substitution/#22943" class="Bound">M</a><a id="22944" class="Symbol">}</a> <a id="22946" class="Symbol">=</a> <a id="22948" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="22954" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="22958" class="Symbol">(</a><a id="22959" href="/Substitution/#22488" class="Function">sub-sub</a><a id="22966" class="Symbol">{</a><a id="22967" class="Argument">M</a> <a id="22969" class="Symbol">=</a> <a id="22971" href="/Substitution/#22939" class="Bound">L</a><a id="22972" class="Symbol">})</a> <a id="22975" class="Symbol">(</a><a id="22976" href="/Substitution/#22488" class="Function">sub-sub</a><a id="22983" class="Symbol">{</a><a id="22984" class="Argument">M</a> <a id="22986" class="Symbol">=</a> <a id="22988" href="/Substitution/#22943" class="Bound">M</a><a id="22989" class="Symbol">})</a></pre>

<p>We proceed by induction on the term <code class="highlighter-rouge">M</code>.</p>

<ul>
  <li>
    <p>If <code class="highlighter-rouge">M = x</code>, then both sides are equal to <code class="highlighter-rouge">σ₂ (σ₁ x)</code>.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M = ƛ N</code>, we first use the induction hypothesis to show that</p>

    <p>ƛ ⟪ exts σ₂ ⟫ (⟪ exts σ₁ ⟫ N) ≡ ƛ ⟪ exts σ₁ ⨟ exts σ₂ ⟫ N</p>

    <p>and then use the lemma <code class="highlighter-rouge">exts-seq</code> to show</p>

    <p>ƛ ⟪ exts σ₁ ⨟ exts σ₂ ⟫ N ≡ ƛ ⟪ exts ( σ₁ ⨟ σ₂) ⟫ N</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M</code> is an application, we use the induction hypothesis
for both subterms.</p>
  </li>
</ul>

<p>The following corollary of <code class="highlighter-rouge">sub-sub</code> specializes the first
substitution to a renaming.</p>

<pre class="Agda"><a id="rename-subst"></a><a id="23522" href="/Substitution/#23522" class="Function">rename-subst</a> <a id="23535" class="Symbol">:</a> <a id="23537" class="Symbol">∀{</a><a id="23539" href="/Substitution/#23539" class="Bound">Γ</a> <a id="23541" href="/Substitution/#23541" class="Bound">Δ</a> <a id="23543" href="/Substitution/#23543" class="Bound">Δ′</a><a id="23545" class="Symbol">}{</a><a id="23547" href="/Substitution/#23547" class="Bound">M</a> <a id="23549" class="Symbol">:</a> <a id="23551" href="/Substitution/#23539" class="Bound">Γ</a> <a id="23553" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="23555" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="23556" class="Symbol">}{</a><a id="23558" href="/Substitution/#23558" class="Bound">ρ</a> <a id="23560" class="Symbol">:</a> <a id="23562" href="/Denotational/#23035" class="Function">Rename</a> <a id="23569" href="/Substitution/#23539" class="Bound">Γ</a> <a id="23571" href="/Substitution/#23541" class="Bound">Δ</a><a id="23572" class="Symbol">}{</a><a id="23574" href="/Substitution/#23574" class="Bound">σ</a> <a id="23576" class="Symbol">:</a> <a id="23578" href="/Soundness/#2673" class="Function">Subst</a> <a id="23584" href="/Substitution/#23541" class="Bound">Δ</a> <a id="23586" href="/Substitution/#23543" class="Bound">Δ′</a><a id="23588" class="Symbol">}</a>
             <a id="23603" class="Symbol">→</a> <a id="23605" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="23607" href="/Substitution/#23574" class="Bound">σ</a> <a id="23609" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="23611" class="Symbol">(</a><a id="23612" href="/Untyped/#6171" class="Function">rename</a> <a id="23619" href="/Substitution/#23558" class="Bound">ρ</a> <a id="23621" href="/Substitution/#23547" class="Bound">M</a><a id="23622" class="Symbol">)</a> <a id="23624" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="23626" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="23628" href="/Substitution/#23574" class="Bound">σ</a> <a id="23630" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="23632" href="/Substitution/#23558" class="Bound">ρ</a> <a id="23634" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="23636" href="/Substitution/#23547" class="Bound">M</a>
<a id="23638" href="/Substitution/#23522" class="Function">rename-subst</a> <a id="23651" class="Symbol">{</a><a id="23652" href="/Substitution/#23652" class="Bound">Γ</a><a id="23653" class="Symbol">}{</a><a id="23655" href="/Substitution/#23655" class="Bound">Δ</a><a id="23656" class="Symbol">}{</a><a id="23658" href="/Substitution/#23658" class="Bound">Δ′</a><a id="23660" class="Symbol">}{</a><a id="23662" href="/Substitution/#23662" class="Bound">M</a><a id="23663" class="Symbol">}{</a><a id="23665" href="/Substitution/#23665" class="Bound">ρ</a><a id="23666" class="Symbol">}{</a><a id="23668" href="/Substitution/#23668" class="Bound">σ</a><a id="23669" class="Symbol">}</a> <a id="23671" class="Symbol">=</a>
   <a id="23676" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="23687" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="23689" href="/Substitution/#23668" class="Bound">σ</a> <a id="23691" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="23693" class="Symbol">(</a><a id="23694" href="/Untyped/#6171" class="Function">rename</a> <a id="23701" href="/Substitution/#23665" class="Bound">ρ</a> <a id="23703" href="/Substitution/#23662" class="Bound">M</a><a id="23704" class="Symbol">)</a>
   <a id="23709" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="23712" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="23717" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="23719" href="/Substitution/#23668" class="Bound">σ</a> <a id="23721" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="23723" class="Symbol">(</a><a id="23724" href="/Substitution/#13437" class="Function">rename-subst-ren</a><a id="23740" class="Symbol">{</a><a id="23741" class="Argument">M</a> <a id="23743" class="Symbol">=</a> <a id="23745" href="/Substitution/#23662" class="Bound">M</a><a id="23746" class="Symbol">})</a> <a id="23749" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="23756" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="23758" href="/Substitution/#23668" class="Bound">σ</a> <a id="23760" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="23762" class="Symbol">(</a><a id="23763" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="23765" href="/Substitution/#6114" class="Function">ren</a> <a id="23769" href="/Substitution/#23665" class="Bound">ρ</a> <a id="23771" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="23773" href="/Substitution/#23662" class="Bound">M</a><a id="23774" class="Symbol">)</a>
   <a id="23779" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="23782" href="/Substitution/#22488" class="Function">sub-sub</a><a id="23789" class="Symbol">{</a><a id="23790" class="Argument">M</a> <a id="23792" class="Symbol">=</a> <a id="23794" href="/Substitution/#23662" class="Bound">M</a><a id="23795" class="Symbol">}</a> <a id="23797" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="23804" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="23806" href="/Substitution/#6114" class="Function">ren</a> <a id="23810" href="/Substitution/#23665" class="Bound">ρ</a> <a id="23812" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="23814" href="/Substitution/#23668" class="Bound">σ</a> <a id="23816" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="23818" href="/Substitution/#23662" class="Bound">M</a>
   <a id="23823" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="23832" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="23834" href="/Substitution/#23668" class="Bound">σ</a> <a id="23836" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="23838" href="/Substitution/#23665" class="Bound">ρ</a> <a id="23840" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="23842" href="/Substitution/#23662" class="Bound">M</a>
   <a id="23847" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-sub-assoc">Proof of sub-assoc</h2>

<p>The proof of <code class="highlighter-rouge">sub-assoc</code> follows directly from <code class="highlighter-rouge">sub-sub</code> and the
definition of sequencing.</p>

<pre class="Agda"><a id="sub-assoc"></a><a id="23990" href="/Substitution/#23990" class="Function">sub-assoc</a> <a id="24000" class="Symbol">:</a> <a id="24002" class="Symbol">∀{</a><a id="24004" href="/Substitution/#24004" class="Bound">Γ</a> <a id="24006" href="/Substitution/#24006" class="Bound">Δ</a> <a id="24008" href="/Substitution/#24008" class="Bound">Σ</a> <a id="24010" href="/Substitution/#24010" class="Bound">Ψ</a> <a id="24012" class="Symbol">:</a> <a id="24014" href="/Untyped/#2980" class="Datatype">Context</a><a id="24021" class="Symbol">}</a> <a id="24023" class="Symbol">{</a><a id="24024" href="/Substitution/#24024" class="Bound">σ</a> <a id="24026" class="Symbol">:</a> <a id="24028" href="/Soundness/#2673" class="Function">Subst</a> <a id="24034" href="/Substitution/#24004" class="Bound">Γ</a> <a id="24036" href="/Substitution/#24006" class="Bound">Δ</a><a id="24037" class="Symbol">}</a> <a id="24039" class="Symbol">{</a><a id="24040" href="/Substitution/#24040" class="Bound">τ</a> <a id="24042" class="Symbol">:</a> <a id="24044" href="/Soundness/#2673" class="Function">Subst</a> <a id="24050" href="/Substitution/#24006" class="Bound">Δ</a> <a id="24052" href="/Substitution/#24008" class="Bound">Σ</a><a id="24053" class="Symbol">}</a>
             <a id="24068" class="Symbol">{</a><a id="24069" href="/Substitution/#24069" class="Bound">θ</a> <a id="24071" class="Symbol">:</a> <a id="24073" href="/Soundness/#2673" class="Function">Subst</a> <a id="24079" href="/Substitution/#24008" class="Bound">Σ</a> <a id="24081" href="/Substitution/#24010" class="Bound">Ψ</a><a id="24082" class="Symbol">}</a>
          <a id="24094" class="Symbol">→</a> <a id="24096" class="Symbol">∀{</a><a id="24098" href="/Substitution/#24098" class="Bound">A</a><a id="24099" class="Symbol">}</a> <a id="24101" class="Symbol">→</a> <a id="24103" class="Symbol">(</a><a id="24104" href="/Substitution/#24024" class="Bound">σ</a> <a id="24106" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="24108" href="/Substitution/#24040" class="Bound">τ</a><a id="24109" class="Symbol">)</a> <a id="24111" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="24113" href="/Substitution/#24069" class="Bound">θ</a> <a id="24115" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="24117" class="Symbol">(</a><a id="24118" href="/Substitution/#24024" class="Bound">σ</a> <a id="24120" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="24122" href="/Substitution/#24040" class="Bound">τ</a> <a id="24124" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="24126" href="/Substitution/#24069" class="Bound">θ</a><a id="24127" class="Symbol">)</a> <a id="24129" class="Symbol">{</a><a id="24130" href="/Substitution/#24098" class="Bound">A</a><a id="24131" class="Symbol">}</a>
<a id="24133" href="/Substitution/#23990" class="Function">sub-assoc</a> <a id="24143" class="Symbol">{</a><a id="24144" href="/Substitution/#24144" class="Bound">Γ</a><a id="24145" class="Symbol">}{</a><a id="24147" href="/Substitution/#24147" class="Bound">Δ</a><a id="24148" class="Symbol">}{</a><a id="24150" href="/Substitution/#24150" class="Bound">Σ</a><a id="24151" class="Symbol">}{</a><a id="24153" href="/Substitution/#24153" class="Bound">Ψ</a><a id="24154" class="Symbol">}{</a><a id="24156" href="/Substitution/#24156" class="Bound">σ</a><a id="24157" class="Symbol">}{</a><a id="24159" href="/Substitution/#24159" class="Bound">τ</a><a id="24160" class="Symbol">}{</a><a id="24162" href="/Substitution/#24162" class="Bound">θ</a><a id="24163" class="Symbol">}{</a><a id="24165" href="/Substitution/#24165" class="Bound">A</a><a id="24166" class="Symbol">}</a> <a id="24168" class="Symbol">=</a> <a id="24170" href="/Denotational/#3265" class="Postulate">extensionality</a> <a id="24185" class="Symbol">λ</a> <a id="24187" href="/Substitution/#24187" class="Bound">x</a> <a id="24189" class="Symbol">→</a> <a id="24191" href="/Substitution/#24214" class="Function">lemma</a><a id="24196" class="Symbol">{</a><a id="24197" class="Argument">x</a> <a id="24199" class="Symbol">=</a> <a id="24201" href="/Substitution/#24187" class="Bound">x</a><a id="24202" class="Symbol">}</a>
  <a id="24206" class="Keyword">where</a>
  <a id="24214" href="/Substitution/#24214" class="Function">lemma</a> <a id="24220" class="Symbol">:</a> <a id="24222" class="Symbol">∀</a> <a id="24224" class="Symbol">{</a><a id="24225" href="/Substitution/#24225" class="Bound">x</a> <a id="24227" class="Symbol">:</a> <a id="24229" href="/Substitution/#24144" class="Bound">Γ</a> <a id="24231" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="24233" href="/Substitution/#24165" class="Bound">A</a><a id="24234" class="Symbol">}</a> <a id="24236" class="Symbol">→</a> <a id="24238" class="Symbol">((</a><a id="24240" href="/Substitution/#24156" class="Bound">σ</a> <a id="24242" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="24244" href="/Substitution/#24159" class="Bound">τ</a><a id="24245" class="Symbol">)</a> <a id="24247" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="24249" href="/Substitution/#24162" class="Bound">θ</a><a id="24250" class="Symbol">)</a> <a id="24252" href="/Substitution/#24225" class="Bound">x</a> <a id="24254" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="24256" class="Symbol">(</a><a id="24257" href="/Substitution/#24156" class="Bound">σ</a> <a id="24259" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="24261" href="/Substitution/#24159" class="Bound">τ</a> <a id="24263" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="24265" href="/Substitution/#24162" class="Bound">θ</a><a id="24266" class="Symbol">)</a> <a id="24268" href="/Substitution/#24225" class="Bound">x</a>
  <a id="24272" href="/Substitution/#24214" class="Function">lemma</a> <a id="24278" class="Symbol">{</a><a id="24279" href="/Substitution/#24279" class="Bound">x</a><a id="24280" class="Symbol">}</a> <a id="24282" class="Symbol">=</a>
      <a id="24290" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
        <a id="24304" class="Symbol">((</a><a id="24306" href="/Substitution/#24156" class="Bound">σ</a> <a id="24308" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="24310" href="/Substitution/#24159" class="Bound">τ</a><a id="24311" class="Symbol">)</a> <a id="24313" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="24315" href="/Substitution/#24162" class="Bound">θ</a><a id="24316" class="Symbol">)</a> <a id="24318" href="/Substitution/#24279" class="Bound">x</a>
      <a id="24326" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
        <a id="24338" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="24340" href="/Substitution/#24162" class="Bound">θ</a> <a id="24342" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="24344" class="Symbol">(</a><a id="24345" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="24347" href="/Substitution/#24159" class="Bound">τ</a> <a id="24349" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="24351" class="Symbol">(</a><a id="24352" href="/Substitution/#24156" class="Bound">σ</a> <a id="24354" href="/Substitution/#24279" class="Bound">x</a><a id="24355" class="Symbol">))</a>
      <a id="24364" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="24367" href="/Substitution/#22488" class="Function">sub-sub</a><a id="24374" class="Symbol">{</a><a id="24375" class="Argument">M</a> <a id="24377" class="Symbol">=</a> <a id="24379" href="/Substitution/#24156" class="Bound">σ</a> <a id="24381" href="/Substitution/#24279" class="Bound">x</a><a id="24382" class="Symbol">}</a> <a id="24384" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
        <a id="24394" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="24396" href="/Substitution/#24159" class="Bound">τ</a> <a id="24398" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="24400" href="/Substitution/#24162" class="Bound">θ</a> <a id="24402" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="24404" class="Symbol">(</a><a id="24405" href="/Substitution/#24156" class="Bound">σ</a> <a id="24407" href="/Substitution/#24279" class="Bound">x</a><a id="24408" class="Symbol">)</a>
      <a id="24416" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
        <a id="24428" class="Symbol">(</a><a id="24429" href="/Substitution/#24156" class="Bound">σ</a> <a id="24431" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="24433" href="/Substitution/#24159" class="Bound">τ</a> <a id="24435" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="24437" href="/Substitution/#24162" class="Bound">θ</a><a id="24438" class="Symbol">)</a> <a id="24440" href="/Substitution/#24279" class="Bound">x</a>
      <a id="24448" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-subst-zero-exts-cons">Proof of subst-zero-exts-cons</h2>

<p>The last equation we needed to prove <code class="highlighter-rouge">subst-zero-exts-cons</code> was
<code class="highlighter-rouge">sub-assoc</code>, so we can now go ahead with its proof.  We simply apply
the equations for <code class="highlighter-rouge">exts</code> and <code class="highlighter-rouge">subst-zero</code> and then apply the σ algebra
equation to arrive at the normal form <code class="highlighter-rouge">M • σ</code>.</p>

<pre class="Agda"><a id="subst-zero-exts-cons"></a><a id="24761" href="/Substitution/#24761" class="Function">subst-zero-exts-cons</a> <a id="24782" class="Symbol">:</a> <a id="24784" class="Symbol">∀{</a><a id="24786" href="/Substitution/#24786" class="Bound">Γ</a> <a id="24788" href="/Substitution/#24788" class="Bound">Δ</a><a id="24789" class="Symbol">}{</a><a id="24791" href="/Substitution/#24791" class="Bound">σ</a> <a id="24793" class="Symbol">:</a> <a id="24795" href="/Soundness/#2673" class="Function">Subst</a> <a id="24801" href="/Substitution/#24786" class="Bound">Γ</a> <a id="24803" href="/Substitution/#24788" class="Bound">Δ</a><a id="24804" class="Symbol">}{</a><a id="24806" href="/Substitution/#24806" class="Bound">B</a><a id="24807" class="Symbol">}{</a><a id="24809" href="/Substitution/#24809" class="Bound">M</a> <a id="24811" class="Symbol">:</a> <a id="24813" href="/Substitution/#24788" class="Bound">Δ</a> <a id="24815" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="24817" href="/Substitution/#24806" class="Bound">B</a><a id="24818" class="Symbol">}{</a><a id="24820" href="/Substitution/#24820" class="Bound">A</a><a id="24821" class="Symbol">}</a>
                     <a id="24844" class="Symbol">→</a> <a id="24846" href="/Untyped/#6623" class="Function">exts</a> <a id="24851" href="/Substitution/#24791" class="Bound">σ</a> <a id="24853" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="24855" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="24866" href="/Substitution/#24809" class="Bound">M</a> <a id="24868" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="24870" class="Symbol">(</a><a id="24871" href="/Substitution/#24809" class="Bound">M</a> <a id="24873" href="/Substitution/#3004" class="Function Operator">•</a> <a id="24875" href="/Substitution/#24791" class="Bound">σ</a><a id="24876" class="Symbol">)</a> <a id="24878" class="Symbol">{</a><a id="24879" href="/Substitution/#24820" class="Bound">A</a><a id="24880" class="Symbol">}</a>
<a id="24882" href="/Substitution/#24761" class="Function">subst-zero-exts-cons</a> <a id="24903" class="Symbol">{</a><a id="24904" href="/Substitution/#24904" class="Bound">Γ</a><a id="24905" class="Symbol">}{</a><a id="24907" href="/Substitution/#24907" class="Bound">Δ</a><a id="24908" class="Symbol">}{</a><a id="24910" href="/Substitution/#24910" class="Bound">σ</a><a id="24911" class="Symbol">}{</a><a id="24913" href="/Substitution/#24913" class="Bound">B</a><a id="24914" class="Symbol">}{</a><a id="24916" href="/Substitution/#24916" class="Bound">M</a><a id="24917" class="Symbol">}{</a><a id="24919" href="/Substitution/#24919" class="Bound">A</a><a id="24920" class="Symbol">}</a> <a id="24922" class="Symbol">=</a>
    <a id="24928" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
      <a id="24940" href="/Untyped/#6623" class="Function">exts</a> <a id="24945" href="/Substitution/#24910" class="Bound">σ</a> <a id="24947" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="24949" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="24960" href="/Substitution/#24916" class="Bound">M</a>
    <a id="24966" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="24969" href="/Substitution/#11989" class="Function">cong-seq</a> <a id="24978" href="/Substitution/#14849" class="Function">exts-cons-shift</a> <a id="24994" href="/Substitution/#15663" class="Function">subst-Z-cons-ids</a> <a id="25011" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="25019" class="Symbol">(</a><a id="25020" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="25022" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="25024" href="/Substitution/#3004" class="Function Operator">•</a> <a id="25026" class="Symbol">(</a><a id="25027" href="/Substitution/#24910" class="Bound">σ</a> <a id="25029" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="25031" href="/Substitution/#2746" class="Function">↑</a><a id="25032" class="Symbol">))</a> <a id="25035" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="25037" class="Symbol">(</a><a id="25038" href="/Substitution/#24916" class="Bound">M</a> <a id="25040" href="/Substitution/#3004" class="Function Operator">•</a> <a id="25042" href="/Substitution/#2591" class="Function">ids</a><a id="25045" class="Symbol">)</a>
    <a id="25051" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25054" href="/Substitution/#8670" class="Function">sub-dist</a> <a id="25063" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="25071" class="Symbol">(</a><a id="25072" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="25074" href="/Substitution/#24916" class="Bound">M</a> <a id="25076" href="/Substitution/#3004" class="Function Operator">•</a> <a id="25078" href="/Substitution/#2591" class="Function">ids</a> <a id="25082" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="25084" class="Symbol">(</a><a id="25085" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="25087" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="25088" class="Symbol">))</a> <a id="25091" href="/Substitution/#3004" class="Function Operator">•</a> <a id="25093" class="Symbol">((</a><a id="25095" href="/Substitution/#24910" class="Bound">σ</a> <a id="25097" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="25099" href="/Substitution/#2746" class="Function">↑</a><a id="25100" class="Symbol">)</a> <a id="25102" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="25104" class="Symbol">(</a><a id="25105" href="/Substitution/#24916" class="Bound">M</a> <a id="25107" href="/Substitution/#3004" class="Function Operator">•</a> <a id="25109" href="/Substitution/#2591" class="Function">ids</a><a id="25112" class="Symbol">))</a>
    <a id="25119" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25122" href="/Substitution/#11628" class="Function">cong-cons</a> <a id="25132" class="Symbol">(</a><a id="25133" href="/Substitution/#7772" class="Function">sub-head</a><a id="25141" class="Symbol">{</a><a id="25142" class="Argument">σ</a> <a id="25144" class="Symbol">=</a> <a id="25146" href="/Substitution/#2591" class="Function">ids</a><a id="25149" class="Symbol">})</a> <a id="25152" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25157" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="25165" href="/Substitution/#24916" class="Bound">M</a> <a id="25167" href="/Substitution/#3004" class="Function Operator">•</a> <a id="25169" class="Symbol">((</a><a id="25171" href="/Substitution/#24910" class="Bound">σ</a> <a id="25173" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="25175" href="/Substitution/#2746" class="Function">↑</a><a id="25176" class="Symbol">)</a> <a id="25178" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="25180" class="Symbol">(</a><a id="25181" href="/Substitution/#24916" class="Bound">M</a> <a id="25183" href="/Substitution/#3004" class="Function Operator">•</a> <a id="25185" href="/Substitution/#2591" class="Function">ids</a><a id="25188" class="Symbol">))</a>
    <a id="25195" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25198" href="/Substitution/#11628" class="Function">cong-cons</a> <a id="25208" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25213" class="Symbol">(</a><a id="25214" href="/Substitution/#23990" class="Function">sub-assoc</a><a id="25223" class="Symbol">{</a><a id="25224" class="Argument">σ</a> <a id="25226" class="Symbol">=</a> <a id="25228" href="/Substitution/#24910" class="Bound">σ</a><a id="25229" class="Symbol">})</a> <a id="25232" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="25240" href="/Substitution/#24916" class="Bound">M</a> <a id="25242" href="/Substitution/#3004" class="Function Operator">•</a> <a id="25244" class="Symbol">(</a><a id="25245" href="/Substitution/#24910" class="Bound">σ</a> <a id="25247" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="25249" class="Symbol">(</a><a id="25250" href="/Substitution/#2746" class="Function">↑</a> <a id="25252" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="25254" class="Symbol">(</a><a id="25255" href="/Substitution/#24916" class="Bound">M</a> <a id="25257" href="/Substitution/#3004" class="Function Operator">•</a> <a id="25259" href="/Substitution/#2591" class="Function">ids</a><a id="25262" class="Symbol">)))</a>
    <a id="25270" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25273" href="/Substitution/#11628" class="Function">cong-cons</a> <a id="25283" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25288" class="Symbol">(</a><a id="25289" href="/Substitution/#11989" class="Function">cong-seq</a><a id="25297" class="Symbol">{</a><a id="25298" class="Argument">σ</a> <a id="25300" class="Symbol">=</a> <a id="25302" href="/Substitution/#24910" class="Bound">σ</a><a id="25303" class="Symbol">}</a> <a id="25305" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25310" class="Symbol">(</a><a id="25311" href="/Substitution/#7894" class="Function">sub-tail</a><a id="25319" class="Symbol">{</a><a id="25320" class="Argument">M</a> <a id="25322" class="Symbol">=</a> <a id="25324" href="/Substitution/#24916" class="Bound">M</a><a id="25325" class="Symbol">}{</a><a id="25327" class="Argument">σ</a> <a id="25329" class="Symbol">=</a> <a id="25331" href="/Substitution/#2591" class="Function">ids</a><a id="25334" class="Symbol">}))</a> <a id="25338" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="25346" href="/Substitution/#24916" class="Bound">M</a> <a id="25348" href="/Substitution/#3004" class="Function Operator">•</a> <a id="25350" class="Symbol">(</a><a id="25351" href="/Substitution/#24910" class="Bound">σ</a> <a id="25353" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="25355" href="/Substitution/#2591" class="Function">ids</a><a id="25358" class="Symbol">)</a>
    <a id="25364" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25367" href="/Substitution/#11628" class="Function">cong-cons</a> <a id="25377" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25382" class="Symbol">(</a><a id="25383" href="/Substitution/#17293" class="Function">sub-idR</a><a id="25390" class="Symbol">{</a><a id="25391" class="Argument">σ</a> <a id="25393" class="Symbol">=</a> <a id="25395" href="/Substitution/#24910" class="Bound">σ</a><a id="25396" class="Symbol">})</a> <a id="25399" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="25407" href="/Substitution/#24916" class="Bound">M</a> <a id="25409" href="/Substitution/#3004" class="Function Operator">•</a> <a id="25411" href="/Substitution/#24910" class="Bound">σ</a>
    <a id="25417" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-the-substitution-lemma">Proof of the substitution lemma</h2>

<p>We first prove the generalized form of the substitution lemma, showing
that a substitution <code class="highlighter-rouge">σ</code> commutes with the subusitution of <code class="highlighter-rouge">M</code> into
<code class="highlighter-rouge">N</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ exts σ ⟫ N [ ⟪ σ ⟫ M ] ≡ ⟪ σ ⟫ (N [ M ])
</code></pre></div></div>

<p>This proof is where the σ algebra pays off.  The proof is by direct
equational reasoning. Starting with the left-hand side, we apply σ
algebra equations, oriented left-to-right, until we arive at the
normal form</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ ⟪ σ ⟫ M • σ ⟫ N
</code></pre></div></div>

<p>We then do the same with the right-hand side, arriving at the same
normal form.</p>

<pre class="Agda"><a id="subst-commute"></a><a id="25991" href="/Substitution/#25991" class="Function">subst-commute</a> <a id="26005" class="Symbol">:</a> <a id="26007" class="Symbol">∀{</a><a id="26009" href="/Substitution/#26009" class="Bound">Γ</a> <a id="26011" href="/Substitution/#26011" class="Bound">Δ</a><a id="26012" class="Symbol">}{</a><a id="26014" href="/Substitution/#26014" class="Bound">N</a> <a id="26016" class="Symbol">:</a> <a id="26018" href="/Substitution/#26009" class="Bound">Γ</a> <a id="26020" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="26022" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="26024" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="26026" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="26027" class="Symbol">}{</a><a id="26029" href="/Substitution/#26029" class="Bound">M</a> <a id="26031" class="Symbol">:</a> <a id="26033" href="/Substitution/#26009" class="Bound">Γ</a> <a id="26035" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="26037" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="26038" class="Symbol">}{</a><a id="26040" href="/Substitution/#26040" class="Bound">σ</a> <a id="26042" class="Symbol">:</a> <a id="26044" href="/Soundness/#2673" class="Function">Subst</a> <a id="26050" href="/Substitution/#26009" class="Bound">Γ</a> <a id="26052" href="/Substitution/#26011" class="Bound">Δ</a> <a id="26054" class="Symbol">}</a>
    <a id="26060" class="Symbol">→</a> <a id="26062" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26064" href="/Untyped/#6623" class="Function">exts</a> <a id="26069" href="/Substitution/#26040" class="Bound">σ</a> <a id="26071" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26073" href="/Substitution/#26014" class="Bound">N</a> <a id="26075" href="/Untyped/#7475" class="Function Operator">[</a> <a id="26077" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26079" href="/Substitution/#26040" class="Bound">σ</a> <a id="26081" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26083" href="/Substitution/#26029" class="Bound">M</a> <a id="26085" href="/Untyped/#7475" class="Function Operator">]</a> <a id="26087" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="26089" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26091" href="/Substitution/#26040" class="Bound">σ</a> <a id="26093" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26095" class="Symbol">(</a><a id="26096" href="/Substitution/#26014" class="Bound">N</a> <a id="26098" href="/Untyped/#7475" class="Function Operator">[</a> <a id="26100" href="/Substitution/#26029" class="Bound">M</a> <a id="26102" href="/Untyped/#7475" class="Function Operator">]</a><a id="26103" class="Symbol">)</a>
<a id="26105" href="/Substitution/#25991" class="Function">subst-commute</a> <a id="26119" class="Symbol">{</a><a id="26120" href="/Substitution/#26120" class="Bound">Γ</a><a id="26121" class="Symbol">}{</a><a id="26123" href="/Substitution/#26123" class="Bound">Δ</a><a id="26124" class="Symbol">}{</a><a id="26126" href="/Substitution/#26126" class="Bound">N</a><a id="26127" class="Symbol">}{</a><a id="26129" href="/Substitution/#26129" class="Bound">M</a><a id="26130" class="Symbol">}{</a><a id="26132" href="/Substitution/#26132" class="Bound">σ</a><a id="26133" class="Symbol">}</a> <a id="26135" class="Symbol">=</a>
     <a id="26142" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="26155" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26157" href="/Untyped/#6623" class="Function">exts</a> <a id="26162" href="/Substitution/#26132" class="Bound">σ</a> <a id="26164" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26166" href="/Substitution/#26126" class="Bound">N</a> <a id="26168" href="/Untyped/#7475" class="Function Operator">[</a> <a id="26170" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26172" href="/Substitution/#26132" class="Bound">σ</a> <a id="26174" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26176" href="/Substitution/#26129" class="Bound">M</a> <a id="26178" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="26185" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="26196" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26198" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="26209" class="Symbol">(</a><a id="26210" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26212" href="/Substitution/#26132" class="Bound">σ</a> <a id="26214" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26216" href="/Substitution/#26129" class="Bound">M</a><a id="26217" class="Symbol">)</a> <a id="26219" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26221" class="Symbol">(</a><a id="26222" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26224" href="/Untyped/#6623" class="Function">exts</a> <a id="26229" href="/Substitution/#26132" class="Bound">σ</a> <a id="26231" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26233" href="/Substitution/#26126" class="Bound">N</a><a id="26234" class="Symbol">)</a>
     <a id="26241" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26244" href="/Substitution/#10856" class="Function">cong-sub</a> <a id="26253" class="Symbol">{</a><a id="26254" class="Argument">M</a> <a id="26256" class="Symbol">=</a> <a id="26258" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26260" href="/Untyped/#6623" class="Function">exts</a> <a id="26265" href="/Substitution/#26132" class="Bound">σ</a> <a id="26267" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26269" href="/Substitution/#26126" class="Bound">N</a><a id="26270" class="Symbol">}</a> <a id="26272" href="/Substitution/#15663" class="Function">subst-Z-cons-ids</a> <a id="26289" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26294" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="26303" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26305" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26307" href="/Substitution/#26132" class="Bound">σ</a> <a id="26309" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26311" href="/Substitution/#26129" class="Bound">M</a> <a id="26313" href="/Substitution/#3004" class="Function Operator">•</a> <a id="26315" href="/Substitution/#2591" class="Function">ids</a> <a id="26319" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26321" class="Symbol">(</a><a id="26322" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26324" href="/Untyped/#6623" class="Function">exts</a> <a id="26329" href="/Substitution/#26132" class="Bound">σ</a> <a id="26331" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26333" href="/Substitution/#26126" class="Bound">N</a><a id="26334" class="Symbol">)</a>
     <a id="26341" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26344" href="/Substitution/#22488" class="Function">sub-sub</a> <a id="26352" class="Symbol">{</a><a id="26353" class="Argument">M</a> <a id="26355" class="Symbol">=</a> <a id="26357" href="/Substitution/#26126" class="Bound">N</a><a id="26358" class="Symbol">}</a> <a id="26360" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="26369" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26371" class="Symbol">(</a><a id="26372" href="/Untyped/#6623" class="Function">exts</a> <a id="26377" href="/Substitution/#26132" class="Bound">σ</a><a id="26378" class="Symbol">)</a> <a id="26380" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="26382" class="Symbol">((</a><a id="26384" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26386" href="/Substitution/#26132" class="Bound">σ</a> <a id="26388" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26390" href="/Substitution/#26129" class="Bound">M</a><a id="26391" class="Symbol">)</a> <a id="26393" href="/Substitution/#3004" class="Function Operator">•</a> <a id="26395" href="/Substitution/#2591" class="Function">ids</a><a id="26398" class="Symbol">)</a> <a id="26400" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26402" href="/Substitution/#26126" class="Bound">N</a>
     <a id="26409" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26412" href="/Substitution/#10856" class="Function">cong-sub</a> <a id="26421" class="Symbol">{</a><a id="26422" class="Argument">M</a> <a id="26424" class="Symbol">=</a> <a id="26426" href="/Substitution/#26126" class="Bound">N</a><a id="26427" class="Symbol">}</a> <a id="26429" class="Symbol">(</a><a id="26430" href="/Substitution/#11989" class="Function">cong-seq</a> <a id="26439" href="/Substitution/#14849" class="Function">exts-cons-shift</a> <a id="26455" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="26459" class="Symbol">)</a> <a id="26461" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26466" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="26475" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26477" class="Symbol">(</a><a id="26478" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="26480" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="26482" href="/Substitution/#3004" class="Function Operator">•</a> <a id="26484" class="Symbol">(</a><a id="26485" href="/Substitution/#26132" class="Bound">σ</a> <a id="26487" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="26489" href="/Substitution/#2746" class="Function">↑</a><a id="26490" class="Symbol">))</a> <a id="26493" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="26495" class="Symbol">(</a><a id="26496" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26498" href="/Substitution/#26132" class="Bound">σ</a> <a id="26500" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26502" href="/Substitution/#26129" class="Bound">M</a> <a id="26504" href="/Substitution/#3004" class="Function Operator">•</a> <a id="26506" href="/Substitution/#2591" class="Function">ids</a><a id="26509" class="Symbol">)</a> <a id="26511" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26513" href="/Substitution/#26126" class="Bound">N</a>
     <a id="26520" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26523" href="/Substitution/#10856" class="Function">cong-sub</a> <a id="26532" class="Symbol">{</a><a id="26533" class="Argument">M</a> <a id="26535" class="Symbol">=</a> <a id="26537" href="/Substitution/#26126" class="Bound">N</a><a id="26538" class="Symbol">}</a> <a id="26540" class="Symbol">(</a><a id="26541" href="/Substitution/#8670" class="Function">sub-dist</a> <a id="26550" class="Symbol">{</a><a id="26551" class="Argument">M</a> <a id="26553" class="Symbol">=</a> <a id="26555" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="26557" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="26558" class="Symbol">})</a> <a id="26561" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26566" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="26575" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26577" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26579" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26581" href="/Substitution/#26132" class="Bound">σ</a> <a id="26583" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26585" href="/Substitution/#26129" class="Bound">M</a> <a id="26587" href="/Substitution/#3004" class="Function Operator">•</a> <a id="26589" href="/Substitution/#2591" class="Function">ids</a> <a id="26593" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26595" class="Symbol">(</a><a id="26596" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="26598" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="26599" class="Symbol">)</a> <a id="26601" href="/Substitution/#3004" class="Function Operator">•</a> <a id="26603" class="Symbol">((</a><a id="26605" href="/Substitution/#26132" class="Bound">σ</a> <a id="26607" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="26609" href="/Substitution/#2746" class="Function">↑</a><a id="26610" class="Symbol">)</a> <a id="26612" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="26614" class="Symbol">(</a><a id="26615" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26617" href="/Substitution/#26132" class="Bound">σ</a> <a id="26619" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26621" href="/Substitution/#26129" class="Bound">M</a> <a id="26623" href="/Substitution/#3004" class="Function Operator">•</a> <a id="26625" href="/Substitution/#2591" class="Function">ids</a><a id="26628" class="Symbol">))</a> <a id="26631" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26633" href="/Substitution/#26126" class="Bound">N</a>
     <a id="26640" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="26651" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26653" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26655" href="/Substitution/#26132" class="Bound">σ</a> <a id="26657" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26659" href="/Substitution/#26129" class="Bound">M</a> <a id="26661" href="/Substitution/#3004" class="Function Operator">•</a> <a id="26663" class="Symbol">((</a><a id="26665" href="/Substitution/#26132" class="Bound">σ</a> <a id="26667" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="26669" href="/Substitution/#2746" class="Function">↑</a><a id="26670" class="Symbol">)</a> <a id="26672" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="26674" class="Symbol">(</a><a id="26675" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26677" href="/Substitution/#26132" class="Bound">σ</a> <a id="26679" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26681" href="/Substitution/#26129" class="Bound">M</a> <a id="26683" href="/Substitution/#3004" class="Function Operator">•</a> <a id="26685" href="/Substitution/#2591" class="Function">ids</a><a id="26688" class="Symbol">))</a> <a id="26691" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26693" href="/Substitution/#26126" class="Bound">N</a>
     <a id="26700" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26703" href="/Substitution/#10856" class="Function">cong-sub</a><a id="26711" class="Symbol">{</a><a id="26712" class="Argument">M</a> <a id="26714" class="Symbol">=</a> <a id="26716" href="/Substitution/#26126" class="Bound">N</a><a id="26717" class="Symbol">}</a> <a id="26719" class="Symbol">(</a><a id="26720" href="/Substitution/#11628" class="Function">cong-cons</a> <a id="26730" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26735" class="Symbol">(</a><a id="26736" href="/Substitution/#23990" class="Function">sub-assoc</a><a id="26745" class="Symbol">{</a><a id="26746" class="Argument">σ</a> <a id="26748" class="Symbol">=</a> <a id="26750" href="/Substitution/#26132" class="Bound">σ</a><a id="26751" class="Symbol">}))</a> <a id="26755" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26760" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="26769" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26771" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26773" href="/Substitution/#26132" class="Bound">σ</a> <a id="26775" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26777" href="/Substitution/#26129" class="Bound">M</a> <a id="26779" href="/Substitution/#3004" class="Function Operator">•</a> <a id="26781" class="Symbol">(</a><a id="26782" href="/Substitution/#26132" class="Bound">σ</a> <a id="26784" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="26786" href="/Substitution/#2746" class="Function">↑</a> <a id="26788" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="26790" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26792" href="/Substitution/#26132" class="Bound">σ</a> <a id="26794" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26796" href="/Substitution/#26129" class="Bound">M</a> <a id="26798" href="/Substitution/#3004" class="Function Operator">•</a> <a id="26800" href="/Substitution/#2591" class="Function">ids</a><a id="26803" class="Symbol">)</a> <a id="26805" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26807" href="/Substitution/#26126" class="Bound">N</a>
     <a id="26814" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26817" href="/Substitution/#10856" class="Function">cong-sub</a><a id="26825" class="Symbol">{</a><a id="26826" class="Argument">M</a> <a id="26828" class="Symbol">=</a> <a id="26830" href="/Substitution/#26126" class="Bound">N</a><a id="26831" class="Symbol">}</a> <a id="26833" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26838" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26843" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="26852" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26854" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26856" href="/Substitution/#26132" class="Bound">σ</a> <a id="26858" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26860" href="/Substitution/#26129" class="Bound">M</a> <a id="26862" href="/Substitution/#3004" class="Function Operator">•</a> <a id="26864" class="Symbol">(</a><a id="26865" href="/Substitution/#26132" class="Bound">σ</a> <a id="26867" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="26869" href="/Substitution/#2591" class="Function">ids</a><a id="26872" class="Symbol">)</a> <a id="26874" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26876" href="/Substitution/#26126" class="Bound">N</a>
     <a id="26883" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26886" href="/Substitution/#10856" class="Function">cong-sub</a><a id="26894" class="Symbol">{</a><a id="26895" class="Argument">M</a> <a id="26897" class="Symbol">=</a> <a id="26899" href="/Substitution/#26126" class="Bound">N</a><a id="26900" class="Symbol">}</a> <a id="26902" class="Symbol">(</a><a id="26903" href="/Substitution/#11628" class="Function">cong-cons</a> <a id="26913" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26918" class="Symbol">(</a><a id="26919" href="/Substitution/#17293" class="Function">sub-idR</a><a id="26926" class="Symbol">{</a><a id="26927" class="Argument">σ</a> <a id="26929" class="Symbol">=</a> <a id="26931" href="/Substitution/#26132" class="Bound">σ</a><a id="26932" class="Symbol">}))</a> <a id="26936" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26941" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="26950" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26952" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="26954" href="/Substitution/#26132" class="Bound">σ</a> <a id="26956" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26958" href="/Substitution/#26129" class="Bound">M</a> <a id="26960" href="/Substitution/#3004" class="Function Operator">•</a> <a id="26962" href="/Substitution/#26132" class="Bound">σ</a> <a id="26964" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="26966" href="/Substitution/#26126" class="Bound">N</a>
     <a id="26973" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26976" href="/Substitution/#10856" class="Function">cong-sub</a><a id="26984" class="Symbol">{</a><a id="26985" class="Argument">M</a> <a id="26987" class="Symbol">=</a> <a id="26989" href="/Substitution/#26126" class="Bound">N</a><a id="26990" class="Symbol">}</a> <a id="26992" class="Symbol">(</a><a id="26993" href="/Substitution/#11628" class="Function">cong-cons</a> <a id="27003" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="27008" class="Symbol">(</a><a id="27009" href="/Substitution/#8547" class="Function">sub-idL</a><a id="27016" class="Symbol">{</a><a id="27017" class="Argument">σ</a> <a id="27019" class="Symbol">=</a> <a id="27021" href="/Substitution/#26132" class="Bound">σ</a><a id="27022" class="Symbol">}))</a> <a id="27026" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="27031" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27040" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="27042" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="27044" href="/Substitution/#26132" class="Bound">σ</a> <a id="27046" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="27048" href="/Substitution/#26129" class="Bound">M</a> <a id="27050" href="/Substitution/#3004" class="Function Operator">•</a> <a id="27052" class="Symbol">(</a><a id="27053" href="/Substitution/#2591" class="Function">ids</a> <a id="27057" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="27059" href="/Substitution/#26132" class="Bound">σ</a><a id="27060" class="Symbol">)</a> <a id="27062" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="27064" href="/Substitution/#26126" class="Bound">N</a>
     <a id="27071" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27074" href="/Substitution/#10856" class="Function">cong-sub</a><a id="27082" class="Symbol">{</a><a id="27083" class="Argument">M</a> <a id="27085" class="Symbol">=</a> <a id="27087" href="/Substitution/#26126" class="Bound">N</a><a id="27088" class="Symbol">}</a> <a id="27090" class="Symbol">(</a><a id="27091" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="27095" href="/Substitution/#8670" class="Function">sub-dist</a><a id="27103" class="Symbol">)</a> <a id="27105" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="27110" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27119" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="27121" href="/Substitution/#26129" class="Bound">M</a> <a id="27123" href="/Substitution/#3004" class="Function Operator">•</a> <a id="27125" href="/Substitution/#2591" class="Function">ids</a> <a id="27129" href="/Substitution/#3357" class="Function Operator">⨟</a> <a id="27131" href="/Substitution/#26132" class="Bound">σ</a> <a id="27133" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="27135" href="/Substitution/#26126" class="Bound">N</a>
     <a id="27142" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27145" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="27149" class="Symbol">(</a><a id="27150" href="/Substitution/#22488" class="Function">sub-sub</a><a id="27157" class="Symbol">{</a><a id="27158" class="Argument">M</a> <a id="27160" class="Symbol">=</a> <a id="27162" href="/Substitution/#26126" class="Bound">N</a><a id="27163" class="Symbol">})</a> <a id="27166" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27175" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="27177" href="/Substitution/#26132" class="Bound">σ</a> <a id="27179" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="27181" class="Symbol">(</a><a id="27182" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="27184" href="/Substitution/#26129" class="Bound">M</a> <a id="27186" href="/Substitution/#3004" class="Function Operator">•</a> <a id="27188" href="/Substitution/#2591" class="Function">ids</a> <a id="27192" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="27194" href="/Substitution/#26126" class="Bound">N</a><a id="27195" class="Symbol">)</a>
     <a id="27202" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27205" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="27210" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="27212" href="/Substitution/#26132" class="Bound">σ</a> <a id="27214" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="27216" class="Symbol">(</a><a id="27217" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="27221" class="Symbol">(</a><a id="27222" href="/Substitution/#10856" class="Function">cong-sub</a><a id="27230" class="Symbol">{</a><a id="27231" class="Argument">M</a> <a id="27233" class="Symbol">=</a> <a id="27235" href="/Substitution/#26126" class="Bound">N</a><a id="27236" class="Symbol">}</a> <a id="27238" href="/Substitution/#15663" class="Function">subst-Z-cons-ids</a> <a id="27255" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="27259" class="Symbol">))</a> <a id="27262" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27271" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="27273" href="/Substitution/#26132" class="Bound">σ</a> <a id="27275" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="27277" class="Symbol">(</a><a id="27278" href="/Substitution/#26126" class="Bound">N</a> <a id="27280" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27282" href="/Substitution/#26129" class="Bound">M</a> <a id="27284" href="/Untyped/#7475" class="Function Operator">]</a><a id="27285" class="Symbol">)</a>
     <a id="27292" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>A corollary of <code class="highlighter-rouge">subst-commute</code> is that <code class="highlighter-rouge">rename</code> also commutes with
substitution. In the proof below, we first exchange <code class="highlighter-rouge">rename ρ</code> for
the substitution <code class="highlighter-rouge">⟪ ren ρ ⟫</code>, and apply <code class="highlighter-rouge">subst-commute</code>, and
then convert back to <code class="highlighter-rouge">rename ρ</code>.</p>

<pre class="Agda"><a id="rename-subst-commute"></a><a id="27548" href="/Substitution/#27548" class="Function">rename-subst-commute</a> <a id="27569" class="Symbol">:</a> <a id="27571" class="Symbol">∀{</a><a id="27573" href="/Substitution/#27573" class="Bound">Γ</a> <a id="27575" href="/Substitution/#27575" class="Bound">Δ</a><a id="27576" class="Symbol">}{</a><a id="27578" href="/Substitution/#27578" class="Bound">N</a> <a id="27580" class="Symbol">:</a> <a id="27582" href="/Substitution/#27573" class="Bound">Γ</a> <a id="27584" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="27586" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="27588" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="27590" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="27591" class="Symbol">}{</a><a id="27593" href="/Substitution/#27593" class="Bound">M</a> <a id="27595" class="Symbol">:</a> <a id="27597" href="/Substitution/#27573" class="Bound">Γ</a> <a id="27599" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="27601" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="27602" class="Symbol">}{</a><a id="27604" href="/Substitution/#27604" class="Bound">ρ</a> <a id="27606" class="Symbol">:</a> <a id="27608" href="/Denotational/#23035" class="Function">Rename</a> <a id="27615" href="/Substitution/#27573" class="Bound">Γ</a> <a id="27617" href="/Substitution/#27575" class="Bound">Δ</a> <a id="27619" class="Symbol">}</a>
    <a id="27625" class="Symbol">→</a> <a id="27627" class="Symbol">(</a><a id="27628" href="/Untyped/#6171" class="Function">rename</a> <a id="27635" class="Symbol">(</a><a id="27636" href="/Untyped/#5845" class="Function">ext</a> <a id="27640" href="/Substitution/#27604" class="Bound">ρ</a><a id="27641" class="Symbol">)</a> <a id="27643" href="/Substitution/#27578" class="Bound">N</a><a id="27644" class="Symbol">)</a> <a id="27646" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27648" href="/Untyped/#6171" class="Function">rename</a> <a id="27655" href="/Substitution/#27604" class="Bound">ρ</a> <a id="27657" href="/Substitution/#27593" class="Bound">M</a> <a id="27659" href="/Untyped/#7475" class="Function Operator">]</a> <a id="27661" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="27663" href="/Untyped/#6171" class="Function">rename</a> <a id="27670" href="/Substitution/#27604" class="Bound">ρ</a> <a id="27672" class="Symbol">(</a><a id="27673" href="/Substitution/#27578" class="Bound">N</a> <a id="27675" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27677" href="/Substitution/#27593" class="Bound">M</a> <a id="27679" href="/Untyped/#7475" class="Function Operator">]</a><a id="27680" class="Symbol">)</a>
<a id="27682" href="/Substitution/#27548" class="Function">rename-subst-commute</a> <a id="27703" class="Symbol">{</a><a id="27704" href="/Substitution/#27704" class="Bound">Γ</a><a id="27705" class="Symbol">}{</a><a id="27707" href="/Substitution/#27707" class="Bound">Δ</a><a id="27708" class="Symbol">}{</a><a id="27710" href="/Substitution/#27710" class="Bound">N</a><a id="27711" class="Symbol">}{</a><a id="27713" href="/Substitution/#27713" class="Bound">M</a><a id="27714" class="Symbol">}{</a><a id="27716" href="/Substitution/#27716" class="Bound">ρ</a><a id="27717" class="Symbol">}</a> <a id="27719" class="Symbol">=</a>
     <a id="27726" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="27739" class="Symbol">(</a><a id="27740" href="/Untyped/#6171" class="Function">rename</a> <a id="27747" class="Symbol">(</a><a id="27748" href="/Untyped/#5845" class="Function">ext</a> <a id="27752" href="/Substitution/#27716" class="Bound">ρ</a><a id="27753" class="Symbol">)</a> <a id="27755" href="/Substitution/#27710" class="Bound">N</a><a id="27756" class="Symbol">)</a> <a id="27758" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27760" href="/Untyped/#6171" class="Function">rename</a> <a id="27767" href="/Substitution/#27716" class="Bound">ρ</a> <a id="27769" href="/Substitution/#27713" class="Bound">M</a> <a id="27771" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="27778" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27781" href="/Substitution/#10856" class="Function">cong-sub</a> <a id="27790" class="Symbol">(</a><a id="27791" href="/Substitution/#11361" class="Function">cong-sub-zero</a> <a id="27805" class="Symbol">(</a><a id="27806" href="/Substitution/#13437" class="Function">rename-subst-ren</a><a id="27822" class="Symbol">{</a><a id="27823" class="Argument">M</a> <a id="27825" class="Symbol">=</a> <a id="27827" href="/Substitution/#27713" class="Bound">M</a><a id="27828" class="Symbol">}))</a>
                 <a id="27849" class="Symbol">(</a><a id="27850" href="/Substitution/#13437" class="Function">rename-subst-ren</a><a id="27866" class="Symbol">{</a><a id="27867" class="Argument">M</a> <a id="27869" class="Symbol">=</a> <a id="27871" href="/Substitution/#27710" class="Bound">N</a><a id="27872" class="Symbol">})</a> <a id="27875" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27884" class="Symbol">(</a><a id="27885" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="27887" href="/Substitution/#6114" class="Function">ren</a> <a id="27891" class="Symbol">(</a><a id="27892" href="/Untyped/#5845" class="Function">ext</a> <a id="27896" href="/Substitution/#27716" class="Bound">ρ</a><a id="27897" class="Symbol">)</a> <a id="27899" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="27901" href="/Substitution/#27710" class="Bound">N</a><a id="27902" class="Symbol">)</a> <a id="27904" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27906" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="27908" href="/Substitution/#6114" class="Function">ren</a> <a id="27912" href="/Substitution/#27716" class="Bound">ρ</a> <a id="27914" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="27916" href="/Substitution/#27713" class="Bound">M</a> <a id="27918" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="27925" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27928" href="/Substitution/#10856" class="Function">cong-sub</a> <a id="27937" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="27942" class="Symbol">(</a><a id="27943" href="/Substitution/#10856" class="Function">cong-sub</a><a id="27951" class="Symbol">{</a><a id="27952" class="Argument">M</a> <a id="27954" class="Symbol">=</a> <a id="27956" href="/Substitution/#27710" class="Bound">N</a><a id="27957" class="Symbol">}</a> <a id="27959" href="/Substitution/#13052" class="Function">ren-ext</a> <a id="27967" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="27971" class="Symbol">)</a> <a id="27973" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27982" class="Symbol">(</a><a id="27983" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="27985" href="/Untyped/#6623" class="Function">exts</a> <a id="27990" class="Symbol">(</a><a id="27991" href="/Substitution/#6114" class="Function">ren</a> <a id="27995" href="/Substitution/#27716" class="Bound">ρ</a><a id="27996" class="Symbol">)</a> <a id="27998" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="28000" href="/Substitution/#27710" class="Bound">N</a><a id="28001" class="Symbol">)</a> <a id="28003" href="/Untyped/#7475" class="Function Operator">[</a> <a id="28005" href="/Substitution/#2076" class="Function Operator">⟪</a> <a id="28007" href="/Substitution/#6114" class="Function">ren</a> <a id="28011" href="/Substitution/#27716" class="Bound">ρ</a> <a id="28013" href="/Substitution/#2076" class="Function Operator">⟫</a> <a id="28015" href="/Substitution/#27713" class="Bound">M</a> <a id="28017" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="28024" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="28027" href="/Substitution/#25991" class="Function">subst-commute</a><a id="28040" class="Symbol">{</a><a id="28041" class="Argument">N</a> <a id="28043" class="Symbol">=</a> <a id="28045" href="/Substitution/#27710" class="Bound">N</a><a id="28046" class="Symbol">}</a> <a id="28048" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="28057" href="/Untyped/#6931" class="Function">subst</a> <a id="28063" class="Symbol">(</a><a id="28064" href="/Substitution/#6114" class="Function">ren</a> <a id="28068" href="/Substitution/#27716" class="Bound">ρ</a><a id="28069" class="Symbol">)</a> <a id="28071" class="Symbol">(</a><a id="28072" href="/Substitution/#27710" class="Bound">N</a> <a id="28074" href="/Untyped/#7475" class="Function Operator">[</a> <a id="28076" href="/Substitution/#27713" class="Bound">M</a> <a id="28078" href="/Untyped/#7475" class="Function Operator">]</a><a id="28079" class="Symbol">)</a>
     <a id="28086" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="28089" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="28093" class="Symbol">(</a><a id="28094" href="/Substitution/#13437" class="Function">rename-subst-ren</a><a id="28110" class="Symbol">)</a> <a id="28112" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="28121" href="/Untyped/#6171" class="Function">rename</a> <a id="28128" href="/Substitution/#27716" class="Bound">ρ</a> <a id="28130" class="Symbol">(</a><a id="28131" href="/Substitution/#27710" class="Bound">N</a> <a id="28133" href="/Untyped/#7475" class="Function Operator">[</a> <a id="28135" href="/Substitution/#27713" class="Bound">M</a> <a id="28137" href="/Untyped/#7475" class="Function Operator">]</a><a id="28138" class="Symbol">)</a>
     <a id="28145" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>To present the substitution lemma, we introduce the following notation
for substituting a term <code class="highlighter-rouge">M</code> for index 1 within term <code class="highlighter-rouge">N</code>.</p>

<pre class="Agda"><a id="_〔_〕"></a><a id="28301" href="/Substitution/#28301" class="Function Operator">_〔_〕</a> <a id="28306" class="Symbol">:</a> <a id="28308" class="Symbol">∀</a> <a id="28310" class="Symbol">{</a><a id="28311" href="/Substitution/#28311" class="Bound">Γ</a> <a id="28313" href="/Substitution/#28313" class="Bound">A</a> <a id="28315" href="/Substitution/#28315" class="Bound">B</a> <a id="28317" href="/Substitution/#28317" class="Bound">C</a><a id="28318" class="Symbol">}</a>
        <a id="28328" class="Symbol">→</a> <a id="28330" href="/Substitution/#28311" class="Bound">Γ</a> <a id="28332" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="28334" href="/Substitution/#28315" class="Bound">B</a> <a id="28336" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="28338" href="/Substitution/#28317" class="Bound">C</a> <a id="28340" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="28342" href="/Substitution/#28313" class="Bound">A</a>
        <a id="28352" class="Symbol">→</a> <a id="28354" href="/Substitution/#28311" class="Bound">Γ</a> <a id="28356" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="28358" href="/Substitution/#28315" class="Bound">B</a>
          <a id="28370" class="Comment">---------</a>
        <a id="28388" class="Symbol">→</a> <a id="28390" href="/Substitution/#28311" class="Bound">Γ</a> <a id="28392" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="28394" href="/Substitution/#28317" class="Bound">C</a> <a id="28396" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="28398" href="/Substitution/#28313" class="Bound">A</a>
<a id="28400" href="/Substitution/#28301" class="Function Operator">_〔_〕</a> <a id="28405" class="Symbol">{</a><a id="28406" href="/Substitution/#28406" class="Bound">Γ</a><a id="28407" class="Symbol">}</a> <a id="28409" class="Symbol">{</a><a id="28410" href="/Substitution/#28410" class="Bound">A</a><a id="28411" class="Symbol">}</a> <a id="28413" class="Symbol">{</a><a id="28414" href="/Substitution/#28414" class="Bound">B</a><a id="28415" class="Symbol">}</a> <a id="28417" class="Symbol">{</a><a id="28418" href="/Substitution/#28418" class="Bound">C</a><a id="28419" class="Symbol">}</a> <a id="28421" href="/Substitution/#28421" class="Bound">N</a> <a id="28423" href="/Substitution/#28423" class="Bound">M</a> <a id="28425" class="Symbol">=</a>
   <a id="28430" href="/Untyped/#6931" class="Function">subst</a> <a id="28436" class="Symbol">{</a><a id="28437" href="/Substitution/#28406" class="Bound">Γ</a> <a id="28439" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="28441" href="/Substitution/#28414" class="Bound">B</a> <a id="28443" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="28445" href="/Substitution/#28418" class="Bound">C</a><a id="28446" class="Symbol">}</a> <a id="28448" class="Symbol">{</a><a id="28449" href="/Substitution/#28406" class="Bound">Γ</a> <a id="28451" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="28453" href="/Substitution/#28418" class="Bound">C</a><a id="28454" class="Symbol">}</a> <a id="28456" class="Symbol">(</a><a id="28457" href="/Untyped/#6623" class="Function">exts</a> <a id="28462" class="Symbol">(</a><a id="28463" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="28474" href="/Substitution/#28423" class="Bound">M</a><a id="28475" class="Symbol">))</a> <a id="28478" class="Symbol">{</a><a id="28479" href="/Substitution/#28410" class="Bound">A</a><a id="28480" class="Symbol">}</a> <a id="28482" href="/Substitution/#28421" class="Bound">N</a></pre>

<p>The substitution lemma is stated as follows and proved as a corollary
of the <code class="highlighter-rouge">subst-commute</code> lemma.</p>

<pre class="Agda"><a id="substitution"></a><a id="28610" href="/Substitution/#28610" class="Function">substitution</a> <a id="28623" class="Symbol">:</a> <a id="28625" class="Symbol">∀{</a><a id="28627" href="/Substitution/#28627" class="Bound">Γ</a><a id="28628" class="Symbol">}{</a><a id="28630" href="/Substitution/#28630" class="Bound">M</a> <a id="28632" class="Symbol">:</a> <a id="28634" href="/Substitution/#28627" class="Bound">Γ</a> <a id="28636" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="28638" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="28640" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="28642" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="28644" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="28646" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="28647" class="Symbol">}{</a><a id="28649" href="/Substitution/#28649" class="Bound">N</a> <a id="28651" class="Symbol">:</a> <a id="28653" href="/Substitution/#28627" class="Bound">Γ</a> <a id="28655" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="28657" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="28659" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="28661" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="28662" class="Symbol">}{</a><a id="28664" href="/Substitution/#28664" class="Bound">L</a> <a id="28666" class="Symbol">:</a> <a id="28668" href="/Substitution/#28627" class="Bound">Γ</a> <a id="28670" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="28672" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="28673" class="Symbol">}</a>
    <a id="28679" class="Symbol">→</a> <a id="28681" class="Symbol">(</a><a id="28682" href="/Substitution/#28630" class="Bound">M</a> <a id="28684" href="/Untyped/#7475" class="Function Operator">[</a> <a id="28686" href="/Substitution/#28649" class="Bound">N</a> <a id="28688" href="/Untyped/#7475" class="Function Operator">]</a><a id="28689" class="Symbol">)</a> <a id="28691" href="/Untyped/#7475" class="Function Operator">[</a> <a id="28693" href="/Substitution/#28664" class="Bound">L</a> <a id="28695" href="/Untyped/#7475" class="Function Operator">]</a> <a id="28697" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="28699" class="Symbol">(</a><a id="28700" href="/Substitution/#28630" class="Bound">M</a> <a id="28702" href="/Substitution/#28301" class="Function Operator">〔</a> <a id="28704" href="/Substitution/#28664" class="Bound">L</a> <a id="28706" href="/Substitution/#28301" class="Function Operator">〕</a><a id="28707" class="Symbol">)</a> <a id="28709" href="/Untyped/#7475" class="Function Operator">[</a> <a id="28711" class="Symbol">(</a><a id="28712" href="/Substitution/#28649" class="Bound">N</a> <a id="28714" href="/Untyped/#7475" class="Function Operator">[</a> <a id="28716" href="/Substitution/#28664" class="Bound">L</a> <a id="28718" href="/Untyped/#7475" class="Function Operator">]</a><a id="28719" class="Symbol">)</a> <a id="28721" href="/Untyped/#7475" class="Function Operator">]</a>
<a id="28723" href="/Substitution/#28610" class="Function">substitution</a><a id="28735" class="Symbol">{</a><a id="28736" class="Argument">M</a> <a id="28738" class="Symbol">=</a> <a id="28740" href="/Substitution/#28740" class="Bound">M</a><a id="28741" class="Symbol">}{</a><a id="28743" class="Argument">N</a> <a id="28745" class="Symbol">=</a> <a id="28747" href="/Substitution/#28747" class="Bound">N</a><a id="28748" class="Symbol">}{</a><a id="28750" class="Argument">L</a> <a id="28752" class="Symbol">=</a> <a id="28754" href="/Substitution/#28754" class="Bound">L</a><a id="28755" class="Symbol">}</a> <a id="28757" class="Symbol">=</a>
   <a id="28762" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="28766" class="Symbol">(</a><a id="28767" href="/Substitution/#25991" class="Function">subst-commute</a><a id="28780" class="Symbol">{</a><a id="28781" class="Argument">N</a> <a id="28783" class="Symbol">=</a> <a id="28785" href="/Substitution/#28740" class="Bound">M</a><a id="28786" class="Symbol">}{</a><a id="28788" class="Argument">M</a> <a id="28790" class="Symbol">=</a> <a id="28792" href="/Substitution/#28747" class="Bound">N</a><a id="28793" class="Symbol">}{</a><a id="28795" class="Argument">σ</a> <a id="28797" class="Symbol">=</a> <a id="28799" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="28810" href="/Substitution/#28754" class="Bound">L</a><a id="28811" class="Symbol">})</a></pre>

<h2 id="notes">Notes</h2>

<p>Most of the properties and proofs in this file are based on the paper
<em>Autosubst: Reasoning with de Bruijn Terms and Parallel Substitution</em>
by Schafer, Tebbi, and Smolka (ITP 2015). That paper, in turn, is
based on the paper of Abadi, Cardelli, Curien, and Levy (1991) that
defines the σ algebra.</p>

<h2 id="unicode">Unicode</h2>

<p>This chapter uses the following unicode:
    ⟪  U+27EA  MATHEMATICAL LEFT DOUBLE ANGLE BRACKET (&lt;&lt;)
    ⟫  U+27EA  MATHEMATICAL RIGHT DOUBLE ANGLE BRACKET (&gt;&gt;)
    ↑  U+2191  UPWARDS ARROW (\u)
    •  U+2022  BULLET (\bub)
    ⨟  U+2A1F  Z NOTATION SCHEMA COMPOSITION (C-x 8 RET Z NOTATION SCHEMA COMPOSITION)
    〔  U+3014  LEFT TORTOISE SHELL BRACKET (( option 9 on page 2)
    〕  U+3015  RIGHT TORTOISE SHELL BRACKET () option 9 on page 2)</p>

  </div>

  <p style="text-align:center;">
    
    <a alt="Previous chapter" href="/Untyped/">Prev</a>
    &bullet;
    
    
    <a alt="Source code" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/Substitution.lagda">Source</a>
    
    
    &bullet;
    <a alt="Next chapter" href="/LambdaReduction/">Next</a>
    
</p>


</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Programming Language Foundations in Agda
</h2><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Philip Wadler</li>
          <li><a class="u-email" href="mailto:wadler@inf.ed.ac.uk">wadler@inf.ed.ac.uk</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wadler"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wadler</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Wen Kokke</li>
          <li><a class="u-email" href="mailto:wen.kokke@ed.ac.uk">wen.kokke@ed.ac.uk</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wenkokke"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wenkokke</span></a></li><li><a href="https://www.twitter.com/wenkokke"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">wenkokke</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
  </div>
</footer>
<!-- Import jQuery -->
<script type="text/javascript" src="/assets/jquery.js"></script>

<!-- Script which allows for foldable code blocks -->
<script type="text/javascript">
 $('div.foldable pre').each(function(){
     var autoHeight = $(this).height();
     var lineHeight = parseFloat($(this).css('line-height'));

     var plus    = $("<div></div>");
     var horLine = $("<div></div>");
     var verLine = $("<div></div>");
     $(this).prepend(plus);
     plus.css({
         'position'         : 'relative',
         'float'            : 'right',
         'right'            : '-' + (0.5 * lineHeight - 1.5) + 'px',
         'width'            : lineHeight,
         'height'           : lineHeight});
     verLine.css({
         'position'         : 'relative',
         'height'           : lineHeight,
         'width'            : '3px',
         'background-color' : '#C1E0FF'});
     horLine.css({
         'position'         : 'relative',
         'top'              : '-' + (0.5 * lineHeight + 1.5) + 'px',
         'left'             : '-' + (0.5 * lineHeight - 1.5) + 'px',
         'height'           : '3px',
         'width'            : lineHeight,
         'background-color' : '#C1E0FF'});
     plus.append(verLine);
     plus.append(horLine);

     $(this).height(2.0 * lineHeight);
     $(this).css('overflow','hidden');

     $(this).click(function(){
         if ($(this).height() == autoHeight) {
             $(this).height(2.0 * lineHeight);
             plus.show();
         }
         else {
             $(this).height('auto');
             plus.hide();
         }
     });
 });
</script>

<!-- Import KaTeX -->
<script type="text/javascript" src="/assets/katex.js"></script>

<!-- Script which renders TeX using KaTeX -->
<script type="text/javascript">
 $("script[type='math/tex']").replaceWith(
     function(){
         var tex = $(this).text();
         return "<span class=\"inline-equation\">" +
                katex.renderToString(tex) +
                "</span>";
     });
 $("script[type='math/tex; mode=display']").replaceWith(
     function(){
         var tex = $(this).text().replace(/%.*?(\n|$)/g,"");
         return "<div class=\"equation\">" +
                katex.renderToString("\\displaystyle "+tex) +
                "</div>";
     });
</script>
</body>

</html>
